var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.owns=function(a,q){return Object.prototype.hasOwnProperty.call(a,q)};$jscomp.assign="function"==typeof Object.assign?Object.assign:function(a,q){for(var f=1;f<arguments.length;f++){var b=arguments[f];if(b)for(var r in b)$jscomp.owns(b,r)&&(a[r]=b[r])}return a};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,q,f){a!=Array.prototype&&a!=Object.prototype&&(a[q]=f.value)};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.polyfill=function(a,q,f,b){if(q){f=$jscomp.global;a=a.split(".");for(b=0;b<a.length-1;b++){var r=a[b];r in f||(f[r]={});f=f[r]}a=a[a.length-1];b=f[a];q=q(b);q!=b&&null!=q&&$jscomp.defineProperty(f,a,{configurable:!0,writable:!0,value:q})}};$jscomp.polyfill("Object.assign",function(a){return a||$jscomp.assign},"es6","es3");$jscomp.polyfill("Object.entries",function(a){return a?a:function(a){var f=[],b;for(b in a)$jscomp.owns(a,b)&&f.push([b,a[b]]);return f}},"es8","es3");
$jscomp.polyfill("Object.is",function(a){return a?a:function(a,f){return a===f?0!==a||1/a===1/f:a!==a&&f!==f}},"es6","es3");$jscomp.polyfill("Array.prototype.includes",function(a){return a?a:function(a,f){var b=this;b instanceof String&&(b=String(b));var r=b.length;f=f||0;for(0>f&&(f=Math.max(f+r,0));f<r;f++){var k=b[f];if(k===a||Object.is(k,a))return!0}return!1}},"es7","es3");
$jscomp.checkStringArgs=function(a,q,f){if(null==a)throw new TypeError("The 'this' value for String.prototype."+f+" must not be null or undefined");if(q instanceof RegExp)throw new TypeError("First argument to String.prototype."+f+" must not be a regular expression");return a+""};$jscomp.polyfill("String.prototype.includes",function(a){return a?a:function(a,f){return-1!==$jscomp.checkStringArgs(this,a,"includes").indexOf(a,f||0)}},"es6","es3");
$jscomp.polyfill("Math.sign",function(a){return a?a:function(a){a=Number(a);return 0===a||isNaN(a)?a:0<a?1:-1}},"es6","es3");$jscomp.checkEs6ConformanceViaProxy=function(){try{var a={},q=Object.create(new $jscomp.global.Proxy(a,{get:function(f,b,r){return f==a&&"q"==b&&r==q}}));return!0===q.q}catch(f){return!1}};$jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS=!1;$jscomp.ES6_CONFORMANCE=$jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS&&$jscomp.checkEs6ConformanceViaProxy();$jscomp.SYMBOL_PREFIX="jscomp_symbol_";
$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.Symbol=function(){var a=0;return function(q){return $jscomp.SYMBOL_PREFIX+(q||"")+a++}}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.iterator;a||(a=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[a]&&$jscomp.defineProperty(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};
$jscomp.initSymbolAsyncIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.asyncIterator;a||(a=$jscomp.global.Symbol.asyncIterator=$jscomp.global.Symbol("asyncIterator"));$jscomp.initSymbolAsyncIterator=function(){}};$jscomp.arrayIterator=function(a){var q=0;return $jscomp.iteratorPrototype(function(){return q<a.length?{done:!1,value:a[q++]}:{done:!0}})};
$jscomp.iteratorPrototype=function(a){$jscomp.initSymbolIterator();a={next:a};a[$jscomp.global.Symbol.iterator]=function(){return this};return a};$jscomp.makeIterator=function(a){$jscomp.initSymbolIterator();var q=a[Symbol.iterator];return q?q.call(a):$jscomp.arrayIterator(a)};
$jscomp.polyfill("WeakMap",function(a){function q(){if(!a||!Object.seal)return!1;try{var b=Object.seal({}),k=Object.seal({}),d=new a([[b,2],[k,3]]);if(2!=d.get(b)||3!=d.get(k))return!1;d.delete(b);d.set(k,4);return!d.has(b)&&4==d.get(k)}catch(l){return!1}}function f(a){$jscomp.owns(a,r)||$jscomp.defineProperty(a,r,{value:{}})}function b(a){var b=Object[a];b&&(Object[a]=function(d){f(d);return b(d)})}if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(a&&$jscomp.ES6_CONFORMANCE)return a}else if(q())return a;
var r="$jscomp_hidden_"+Math.random();b("freeze");b("preventExtensions");b("seal");var k=0,n=function(a){this.id_=(k+=Math.random()+1).toString();if(a){$jscomp.initSymbol();$jscomp.initSymbolIterator();a=$jscomp.makeIterator(a);for(var b;!(b=a.next()).done;)b=b.value,this.set(b[0],b[1])}};n.prototype.set=function(a,b){f(a);if(!$jscomp.owns(a,r))throw Error("WeakMap key fail: "+a);a[r][this.id_]=b;return this};n.prototype.get=function(a){return $jscomp.owns(a,r)?a[r][this.id_]:void 0};n.prototype.has=
function(a){return $jscomp.owns(a,r)&&$jscomp.owns(a[r],this.id_)};n.prototype.delete=function(a){return $jscomp.owns(a,r)&&$jscomp.owns(a[r],this.id_)?delete a[r][this.id_]:!1};return n},"es6","es3");$jscomp.MapEntry=function(){};
$jscomp.polyfill("Map",function(a){function q(){if($jscomp.ASSUME_NO_NATIVE_MAP||!a||"function"!=typeof a||!a.prototype.entries||"function"!=typeof Object.seal)return!1;try{var b=Object.seal({x:4}),d=new a($jscomp.makeIterator([[b,"s"]]));if("s"!=d.get(b)||1!=d.size||d.get({x:4})||d.set({x:4},"t")!=d||2!=d.size)return!1;var l=d.entries(),k=l.next();if(k.done||k.value[0]!=b||"s"!=k.value[1])return!1;k=l.next();return k.done||4!=k.value[0].x||"t"!=k.value[1]||!l.next().done?!1:!0}catch(g){return!1}}
if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(a&&$jscomp.ES6_CONFORMANCE)return a}else if(q())return a;$jscomp.initSymbol();$jscomp.initSymbolIterator();var f=new WeakMap,b=function(a){this.data_={};this.head_=n();this.size=0;if(a){a=$jscomp.makeIterator(a);for(var d;!(d=a.next()).done;)d=d.value,this.set(d[0],d[1])}};b.prototype.set=function(a,d){a=0===a?0:a;var l=r(this,a);l.list||(l.list=this.data_[l.id]=[]);l.entry?l.entry.value=d:(l.entry={next:this.head_,previous:this.head_.previous,head:this.head_,
key:a,value:d},l.list.push(l.entry),this.head_.previous.next=l.entry,this.head_.previous=l.entry,this.size++);return this};b.prototype.delete=function(a){a=r(this,a);return a.entry&&a.list?(a.list.splice(a.index,1),a.list.length||delete this.data_[a.id],a.entry.previous.next=a.entry.next,a.entry.next.previous=a.entry.previous,a.entry.head=null,this.size--,!0):!1};b.prototype.clear=function(){this.data_={};this.head_=this.head_.previous=n();this.size=0};b.prototype.has=function(a){return!!r(this,a).entry};
b.prototype.get=function(a){return(a=r(this,a).entry)&&a.value};b.prototype.entries=function(){return k(this,function(a){return[a.key,a.value]})};b.prototype.keys=function(){return k(this,function(a){return a.key})};b.prototype.values=function(){return k(this,function(a){return a.value})};b.prototype.forEach=function(a,d){for(var l=this.entries(),b;!(b=l.next()).done;)b=b.value,a.call(d,b[1],b[0],this)};b.prototype[Symbol.iterator]=b.prototype.entries;var r=function(a,d){var l=d&&typeof d;"object"==
l||"function"==l?f.has(d)?l=f.get(d):(l=""+ ++I,f.set(d,l)):l="p_"+d;var b=a.data_[l];if(b&&$jscomp.owns(a.data_,l))for(a=0;a<b.length;a++){var g=b[a];if(d!==d&&g.key!==g.key||d===g.key)return{id:l,list:b,index:a,entry:g}}return{id:l,list:b,index:-1,entry:void 0}},k=function(a,d){var l=a.head_;return $jscomp.iteratorPrototype(function(){if(l){for(;l.head!=a.head_;)l=l.previous;for(;l.next!=l.head;)return l=l.next,{done:!1,value:d(l)};l=null}return{done:!0,value:void 0}})},n=function(){var a={};return a.previous=
a.next=a.head=a},I=0;return b},"es6","es3");
$jscomp.polyfill("Set",function(a){function q(){if($jscomp.ASSUME_NO_NATIVE_SET||!a||"function"!=typeof a||!a.prototype.entries||"function"!=typeof Object.seal)return!1;try{var b=Object.seal({x:4}),r=new a($jscomp.makeIterator([b]));if(!r.has(b)||1!=r.size||r.add(b)!=r||1!=r.size||r.add({x:4})!=r||2!=r.size)return!1;var k=r.entries(),f=k.next();if(f.done||f.value[0]!=b||f.value[1]!=b)return!1;f=k.next();return f.done||f.value[0]==b||4!=f.value[0].x||f.value[1]!=f.value[0]?!1:k.next().done}catch(I){return!1}}
if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(a&&$jscomp.ES6_CONFORMANCE)return a}else if(q())return a;$jscomp.initSymbol();$jscomp.initSymbolIterator();var f=function(a){this.map_=new Map;if(a){a=$jscomp.makeIterator(a);for(var b;!(b=a.next()).done;)this.add(b.value)}this.size=this.map_.size};f.prototype.add=function(a){a=0===a?0:a;this.map_.set(a,a);this.size=this.map_.size;return this};f.prototype.delete=function(a){a=this.map_.delete(a);this.size=this.map_.size;return a};f.prototype.clear=
function(){this.map_.clear();this.size=0};f.prototype.has=function(a){return this.map_.has(a)};f.prototype.entries=function(){return this.map_.entries()};f.prototype.values=function(){return this.map_.values()};f.prototype.keys=f.prototype.values;f.prototype[Symbol.iterator]=f.prototype.values;f.prototype.forEach=function(a,f){var b=this;this.map_.forEach(function(k){return a.call(f,k,k,b)})};return f},"es6","es3");
(function(a){"object"===typeof exports&&"undefined"!==typeof module?module.exports=a():"function"===typeof define&&define.amd?define([],a):("undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:this).imsc=a()})(function(){return function(){function a(q,f,b){function r(n,D){if(!f[n]){if(!q[n]){var d="function"==typeof require&&require;if(!D&&d)return d(n,!0);if(k)return k(n,!0);D=Error("Cannot find module '"+n+"'");throw D.code="MODULE_NOT_FOUND",D;}D=
f[n]={exports:{}};q[n][0].call(D.exports,function(d){return r(q[n][1][d]||d)},D,D.exports,a,q,f,b)}return f[n].exports}for(var k="function"==typeof require&&require,n=0;n<b.length;n++)r(b[n]);return r}return a}()({1:[function(a,q,f){(function(a,f,k,n,q){function b(c,d){var e=c.styleAttrs&&c.styleAttrs["http://www.w3.org/ns/ttml#styling backgroundColor"];if("span"===c.kind)!e&&d&&(c.styleAttrs||(c.styleAttrs={}),c.styleAttrs["http://www.w3.org/ns/ttml#styling backgroundColor"]=d);else if(e&&delete c.styleAttrs["http://www.w3.org/ns/ttml#styling backgroundColor"],
c.contents)for(var a=0;a<c.contents.length;a++)b(c.contents[a],e||d)}function d(c){if("contents"in c){var e="styleAttrs"in c?c.styleAttrs[n.byName.ruby.qname]:null;e="span"===c.kind&&("container"===e||"textContainer"===e||"baseContainer"===e);for(var a=c.contents.length-1;0<=a;a--)!e||"styleAttrs"in c.contents[a]&&n.byName.ruby.qname in c.contents[a].styleAttrs?d(c.contents[a]):delete c.contents[a]}}function l(c,e,d,a){var m=a&&"seq"===a.timeContainer,h=0;a&&(h=m&&d?d.end:a.begin);e.begin=e.explicit_begin?
e.explicit_begin+h:h;d=e.begin;a=null;for(var u in e.sets)e.sets.hasOwnProperty(u)&&(l(c,e.sets[u],a,e),d="seq"===e.timeContainer?e.sets[u].end:Math.max(d,e.sets[u].end),a=e.sets[u]);if("contents"in e)for(var b in e.contents)e.contents.hasOwnProperty(b)&&(l(c,e.contents[b],a,e),d="seq"===e.timeContainer?e.contents[b].end:Math.max(d,e.contents[b].end),a=e.contents[b]);else d=m?e.begin:Number.POSITIVE_INFINITY;e.end=null!==e.explicit_end&&null!==e.explicit_dur?Math.min(e.begin+e.explicit_dur,h+e.explicit_end):
null===e.explicit_end&&null!==e.explicit_dur?e.begin+e.explicit_dur:null!==e.explicit_end&&null===e.explicit_dur?h+e.explicit_end:d;delete e.explicit_begin;delete e.explicit_dur;delete e.explicit_end;c._registerEvent(e)}function F(c){this.node=c}function g(){this.events=[];this.head=new r;this.body=null}function r(){this.styling=new p;this.layout=new C}function p(){this.styles={};this.initials={}}function w(){this.styleRefs=this.styleAttrs=this.id=null}function N(){this.styleAttrs=null}function C(){this.regions=
{}}function z(c,e){this.kind="image";this.src=c;this.type=e}function A(c){this.id=c}function x(c){this.regionID=c}function e(c){this.styleAttrs=c}function h(c){this.sets=c}function c(c){this.contents=c}function m(c,e,d){this.explicit_begin=c;this.explicit_end=e;this.explicit_dur=d}function S(){this.kind="body"}function Q(){this.kind="div"}function y(){this.kind="p"}function L(){this.kind="span"}function R(){this.kind="span"}function t(){this.kind="br"}function O(){}function B(){}function V(c){var e=
null;c&&(c=c.attributes["xml:id"]||c.attributes.id)&&(e=c.value||null);return e}function G(c){return c&&"style"in c.attributes?c.attributes.style.value.split(" "):[]}function I(c,e){var d={};if(null!==c)for(var a in c.attributes)if(c.attributes.hasOwnProperty(a)){var m=c.attributes[a].uri+" "+c.attributes[a].local,h=n.byQName[m];if(void 0!==h){var l=h.parse(c.attributes[a].value);null!==l?(d[m]=l,h===n.byName.zIndex&&K(e,"zIndex attribute present but not used by IMSC1 since regions do not overlap")):
H(e,"Cannot parse styling attribute "+m+" --\x3e "+c.attributes[a].value)}}return d}function P(c,e,d){for(var a in c.attributes)if(c.attributes.hasOwnProperty(a)&&c.attributes[a].uri===e&&c.attributes[a].local===d)return c.attributes[a].value;return null}function Z(c,e){c=P(c,k.ns_tts,"extent");if(null===c)return null;var d=c.split(" ");if(2!==d.length)return K(e,"Malformed extent (ignoring)"),null;c=q.parseLength(d[0]);d=q.parseLength(d[1]);return d&&c?{h:d,w:c}:(K(e,"Malformed extent values (ignoring)"),
null)}function T(c,e,d){var a=/^(\d{2,}):(\d\d):(\d\d(?:\.\d+)?)$/,m=/^(\d{2,}):(\d\d):(\d\d):(\d{2,})$/,h=/^(\d+(?:\.\d+)?)t$/,l=/^(\d+(?:\.\d+)?)ms$/,b=/^(\d+(?:\.\d+)?)s$/,g=/^(\d+(?:\.\d+)?)h$/,k=/^(\d+(?:\.\d+)?)m$/,u,p=null;null!==(u=/^(\d+(?:\.\d+)?)f$/.exec(d))?null!==e&&(p=parseFloat(u[1])/e):null!==(u=h.exec(d))?null!==c&&(p=parseFloat(u[1])/c):null!==(u=l.exec(d))?p=parseFloat(u[1])/1E3:null!==(u=b.exec(d))?p=parseFloat(u[1]):null!==(u=g.exec(d))?p=3600*parseFloat(u[1]):null!==(u=k.exec(d))?
p=60*parseFloat(u[1]):null!==(u=a.exec(d))?p=3600*parseInt(u[1])+60*parseInt(u[2])+parseFloat(u[3]):null!==(u=m.exec(d))&&null!==e&&(p=3600*parseInt(u[1])+60*parseInt(u[2])+parseInt(u[3])+(null===u[4]?0:parseInt(u[4])/e));return p}function W(c,e,d){for(;0<e.styleRefs.length;){var a=e.styleRefs.pop();a in c.styles?(W(c,c.styles[a],d),U(c.styles[a].styleAttrs,e.styleAttrs)):H(d,"Non-existant style id referenced")}}function X(c,e,d,a){for(var m=e.length-1;0<=m;m--){var h=e[m];h in c.styles?U(c.styles[h].styleAttrs,
d):H(a,"Non-existant style id referenced")}}function U(c,e){for(var d in c)!c.hasOwnProperty(d)||d in e||(e[d]=c[d])}function K(c,e){if(c&&c.warn&&c.warn(e))throw e;}function H(c,e){if(c&&c.error&&c.error(e))throw e;}function E(c,e){c&&c.fatal&&c.fatal(e);throw e;}function Y(c,e){for(var d=0,a=c.length-1,m;d<=a;){m=Math.floor((d+a)/2);var h=c[m];if(h<e)d=m+1;else if(h>e)a=m-1;else return{found:!0,index:m}}return{found:!1,index:d}}a.fromXML=function(c,e,a){var m=f.parser(!0,{xmlns:!0}),h=[],u=[],M=
[],J=0,v=null;m.onclosetag=function(c){if(h[0]instanceof O)null!==v.head&&null!==v.head.styling&&X(v.head.styling,h[0].styleRefs,h[0].styleAttrs,e),delete h[0].styleRefs;else if(h[0]instanceof p)for(var d in h[0].styles)h[0].styles.hasOwnProperty(d)&&W(h[0],h[0].styles[d],e);else if(h[0]instanceof y||h[0]instanceof L){if(1<h[0].contents.length){c=[h[0].contents[0]];for(d=1;d<h[0].contents.length;d++)h[0].contents[d]instanceof R&&c[c.length-1]instanceof R?c[c.length-1].text+=h[0].contents[d].text:
c.push(h[0].contents[d]);h[0].contents=c}h[0]instanceof L&&1===h[0].contents.length&&h[0].contents[0]instanceof R&&(h[0].text=h[0].contents[0].text,delete h[0].contents)}else if(h[0]instanceof F)if(h[0].node.uri===k.ns_tt&&"metadata"===h[0].node.local)J--;else if(0<J&&a&&"onCloseTag"in a)a.onCloseTag();M.shift();u.shift();h.shift()};m.ontext=function(c){if(void 0!==h[0])if(h[0]instanceof L||h[0]instanceof y){if(h[0]instanceof L){var d=h[0].styleAttrs[n.byName.ruby.qname];if("container"===d||"textContainer"===
d||"baseContainer"===d)return}d=new R;d.initFromText(v,h[0],c,u[0],M[0],e);h[0].contents.push(d)}else if(h[0]instanceof F&&0<J&&a&&"onText"in a)a.onText(c)};m.onopentag=function(c){function d(c){k.ttaf_map[c.uri]&&(c.uri=k.ttaf_map[c.uri])}var m=c.attributes["xml:space"];m?M.unshift(m.value):0===M.length?M.unshift("default"):M.unshift(M[0]);(m=c.attributes["xml:lang"])?u.unshift(m.value):0===u.length?u.unshift(""):u.unshift(u[0]);d(c);if(c.attributes)for(var l in c.attributes)c.attributes.hasOwnProperty(l)&&
d(c.attributes[l]);if(c.uri===k.ns_tt)if("tt"===c.local)null!==v&&E(e,"Two <tt> elements at ("+this.line+","+this.column+")"),v=new g,v.initFromNode(c,u[0],e),h.unshift(v);else if("head"===c.local)h[0]instanceof g||E(e,"Parent of <head> element is not <tt> at ("+this.line+","+this.column+")"),h.unshift(v.head);else if("styling"===c.local)h[0]instanceof r||E(e,"Parent of <styling> element is not <head> at ("+this.line+","+this.column+")"),h.unshift(v.head.styling);else if("style"===c.local)if(h[0]instanceof
p){var b=new w;b.initFromNode(c,e);b.id?v.head.styling.styles[b.id]=b:H(e,"<style> element missing @id attribute");h.unshift(b)}else h[0]instanceof O?(b=new w,b.initFromNode(c,e),U(b.styleAttrs,h[0].styleAttrs),h.unshift(b)):E(e,"Parent of <style> element is not <styling> or <region> at ("+this.line+","+this.column+")");else if("initial"===c.local)if(h[0]instanceof p){l=new N;l.initFromNode(c,e);for(b in l.styleAttrs)l.styleAttrs.hasOwnProperty(b)&&(v.head.styling.initials[b]=l.styleAttrs[b]);h.unshift(l)}else E(e,
"Parent of <initial> element is not <styling> at ("+this.line+","+this.column+")");else if("layout"===c.local)h[0]instanceof r||E(e,"Parent of <layout> element is not <head> at "+this.line+","+this.column+")"),h.unshift(v.head.layout);else if("region"===c.local)h[0]instanceof C||E(e,"Parent of <region> element is not <layout> at "+this.line+","+this.column+")"),b=new O,b.initFromNode(v,c,u[0],e),!b.id||b.id in v.head.layout.regions?H(e,"Ignoring <region> with duplicate or missing @id at "+this.line+
","+this.column+")"):v.head.layout.regions[b.id]=b,h.unshift(b);else if("body"===c.local)h[0]instanceof g||E(e,"Parent of <body> element is not <tt> at "+this.line+","+this.column+")"),null!==v.body&&E(e,"Second <body> element at "+this.line+","+this.column+")"),b=new S,b.initFromNode(v,c,u[0],e),v.body=b,h.unshift(b);else if("div"===c.local){h[0]instanceof Q||h[0]instanceof S||E(e,"Parent of <div> element is not <body> or <div> at "+this.line+","+this.column+")");b=new Q;b.initFromNode(v,h[0],c,
u[0],e);if(l=b.styleAttrs[n.byName.backgroundImage.qname])b.contents.push(new z(l)),delete b.styleAttrs[n.byName.backgroundImage.qname];h[0].contents.push(b);h.unshift(b)}else"image"===c.local?(h[0]instanceof Q||E(e,"Parent of <image> element is not <div> at "+this.line+","+this.column+")"),b=new z,b.initFromNode(v,h[0],c,u[0],e),h[0].contents.push(b),h.unshift(b)):"p"===c.local?(h[0]instanceof Q||E(e,"Parent of <p> element is not <div> at "+this.line+","+this.column+")"),b=new y,b.initFromNode(v,
h[0],c,u[0],e),h[0].contents.push(b),h.unshift(b)):"span"===c.local?(h[0]instanceof L||h[0]instanceof y||E(e,"Parent of <span> element is not <span> or <p> at "+this.line+","+this.column+")"),b=new L,b.initFromNode(v,h[0],c,u[0],M[0],e),h[0].contents.push(b),h.unshift(b)):"br"===c.local?(h[0]instanceof L||h[0]instanceof y||E(e,"Parent of <br> element is not <span> or <p> at "+this.line+","+this.column+")"),b=new t,b.initFromNode(v,h[0],c,u[0],e),h[0].contents.push(b),h.unshift(b)):"set"===c.local?
(h[0]instanceof L||h[0]instanceof y||h[0]instanceof Q||h[0]instanceof S||h[0]instanceof O||h[0]instanceof t||E(e,"Parent of <set> element is not a content element or a region at "+this.line+","+this.column+")"),b=new B,b.initFromNode(v,h[0],c,e),h[0].sets.push(b),h.unshift(b)):h.unshift(new F(c));else h.unshift(new F(c));if(h[0]instanceof F)if(c.uri===k.ns_tt&&"metadata"===c.local)J++;else if(0<J&&a&&"onOpenTag"in a){b=[];for(var f in c.attributes)c.attributes.hasOwnProperty(f)&&(b[c.attributes[f].uri+
" "+c.attributes[f].local]={uri:c.attributes[f].uri,local:c.attributes[f].local,value:c.attributes[f].value});a.onOpenTag(c.uri,c.local,b)}};m.write(c).close();delete v.head.styling.styles;c=!1;for(var q in v.head.layout.regions)if(v.head.layout.regions.hasOwnProperty(q)){c=!0;break}c||(q=O.prototype.createDefaultRegion(v,e),v.head.layout.regions[q.id]=q);for(var x in v.head.layout.regions)v.head.layout.regions.hasOwnProperty(x)&&l(v,v.head.layout.regions[x],null,null);v.body&&l(v,v.body,null,null);
v.body&&d(v.body);v.body&&b(v.body);return v};g.prototype.initFromNode=function(c,e,d){var h=P(c,k.ns_ttp,"cellResolution"),a=15;var m=32;null!==h&&(h=/(\d+) (\d+)/.exec(h),null!==h?(m=parseInt(h[1]),a=parseInt(h[2])):K(d,"Malformed cellResolution value (using initial value instead)"));this.cellLength={h:new q.ComputedLength(0,1/a),w:new q.ComputedLength(1/m,0)};a=P(c,k.ns_ttp,"frameRate");h=30;null!==a&&(m=/(\d+)/.exec(a),null!==m?h=parseInt(m[1]):K(d,"Malformed frame rate attribute (using initial value instead)"));
m=P(c,k.ns_ttp,"frameRateMultiplier");var l=1;null!==m&&(m=/(\d+) (\d+)/.exec(m),null!==m?l=parseInt(m[1])/parseInt(m[2]):K(d,"Malformed frame rate multiplier attribute (using initial value instead)"));h*=l;l=1;m=P(c,k.ns_ttp,"tickRate");null===m?null!==a&&(l=h):(m=/(\d+)/.exec(m),null!==m?l=parseInt(m[1]):K(d,"Malformed tick rate attribute (using initial value instead)"));this.effectiveFrameRate=h;this.tickRate=l;m=P(c,k.ns_ittp,"aspectRatio");null===m&&(m=P(c,k.ns_ttp,"displayAspectRatio"));a=null;
null!==m&&(h=/(\d+)\s+(\d+)/.exec(m),null!==h?(m=parseInt(h[1]),h=parseInt(h[2]),0!==m&&0!==h?a=m/h:H(d,"Illegal aspectRatio values (ignoring)")):H(d,"Malformed aspectRatio attribute (ignoring)"));this.aspectRatio=a;a=P(c,k.ns_ttp,"timeBase");null!==a&&"media"!==a&&E(d,"Unsupported time base");c=Z(c,d);null===c?this.pxLength={h:null,w:null}:("px"===c.h.unit&&"px"===c.w.unit||E(d,"Extent on TT must be in px or absent"),this.pxLength={h:new q.ComputedLength(0,1/c.h.value),w:new q.ComputedLength(1/c.w.value,
0)});this.dimensions={h:new q.ComputedLength(0,1),w:new q.ComputedLength(1,0)};this.lang=e};g.prototype._registerEvent=function(c){if(!(c.end<=c.begin)){var e=Y(this.events,c.begin);e.found||this.events.splice(e.index,0,c.begin);c.end!==Number.POSITIVE_INFINITY&&(e=Y(this.events,c.end),e.found||this.events.splice(e.index,0,c.end))}};g.prototype.getMediaTimeRange=function(){return[this.events[0],this.events[this.events.length-1]]};g.prototype.getMediaTimeEvents=function(){return this.events};w.prototype.initFromNode=
function(c,e){this.id=V(c);this.styleAttrs=I(c,e);this.styleRefs=G(c)};N.prototype.initFromNode=function(c,e){this.styleAttrs={};for(var d in c.attributes)!c.attributes.hasOwnProperty(d)||c.attributes[d].uri!==k.ns_itts&&c.attributes[d].uri!==k.ns_ebutts&&c.attributes[d].uri!==k.ns_tts||(this.styleAttrs[c.attributes[d].uri+" "+c.attributes[d].local]=c.attributes[d].value)};z.prototype.initFromNode=function(c,d,a,l,b){(this.src="src"in a.attributes?a.attributes.src.value:null)||H(b,"Invalid image@src attribute");
(this.type="type"in a.attributes?a.attributes.type.value:null)||H(b,"Invalid image@type attribute");e.prototype.initFromNode.call(this,c,d,a,b);m.prototype.initFromNode.call(this,c,d,a,b);h.prototype.initFromNode.call(this,c,d,a,b);x.prototype.initFromNode.call(this,c,d,a,b);this.lang=l};A.prototype.initFromNode=function(c,e,d,h){this.id=V(d)};x.prototype.initFromNode=function(c,e,d,h){this.regionID=d&&"region"in d.attributes?d.attributes.region.value:""};e.prototype.initFromNode=function(c,e,d,h){this.styleAttrs=
I(d,h);null!==c.head&&null!==c.head.styling&&X(c.head.styling,G(d),this.styleAttrs,h)};h.prototype.initFromNode=function(c,e,d,h){this.sets=[]};c.prototype.initFromNode=function(c,e,d,h){this.contents=[]};m.prototype.initFromNode=function(c,e,d,h){e=null;d&&"begin"in d.attributes&&(e=T(c.tickRate,c.effectiveFrameRate,d.attributes.begin.value),null===e&&K(h,"Malformed begin value "+d.attributes.begin.value+" (using 0)"));var a=null;d&&"dur"in d.attributes&&(a=T(c.tickRate,c.effectiveFrameRate,d.attributes.dur.value),
null===a&&K(h,"Malformed dur value "+d.attributes.dur.value+" (ignoring)"));var m=null;d&&"end"in d.attributes&&(m=T(c.tickRate,c.effectiveFrameRate,d.attributes.end.value),null===m&&K(h,"Malformed end value (ignoring)"));this.explicit_begin=e;this.explicit_end=m;this.explicit_dur=a;(c=d&&"timeContainer"in d.attributes?d.attributes.timeContainer.value:null)&&"par"!==c?"seq"===c?h="seq":(H(h,"Illegal value of timeContainer (assuming 'par')"),h="par"):h="par";this.timeContainer=h};S.prototype.initFromNode=
function(d,a,l,b){e.prototype.initFromNode.call(this,d,null,a,b);m.prototype.initFromNode.call(this,d,null,a,b);h.prototype.initFromNode.call(this,d,null,a,b);x.prototype.initFromNode.call(this,d,null,a,b);c.prototype.initFromNode.call(this,d,null,a,b);this.lang=l};Q.prototype.initFromNode=function(d,a,l,b,g){e.prototype.initFromNode.call(this,d,a,l,g);m.prototype.initFromNode.call(this,d,a,l,g);h.prototype.initFromNode.call(this,d,a,l,g);x.prototype.initFromNode.call(this,d,a,l,g);c.prototype.initFromNode.call(this,
d,a,l,g);this.lang=b};y.prototype.initFromNode=function(d,a,l,b,g){e.prototype.initFromNode.call(this,d,a,l,g);m.prototype.initFromNode.call(this,d,a,l,g);h.prototype.initFromNode.call(this,d,a,l,g);x.prototype.initFromNode.call(this,d,a,l,g);c.prototype.initFromNode.call(this,d,a,l,g);this.lang=b};L.prototype.initFromNode=function(d,a,l,b,g,k){e.prototype.initFromNode.call(this,d,a,l,k);m.prototype.initFromNode.call(this,d,a,l,k);h.prototype.initFromNode.call(this,d,a,l,k);x.prototype.initFromNode.call(this,
d,a,l,k);c.prototype.initFromNode.call(this,d,a,l,k);this.space=g;this.lang=b};R.prototype.initFromText=function(c,d,e,h,a,l){m.prototype.initFromNode.call(this,c,d,null,l);this.text=e;this.space=a;this.lang=h};t.prototype.initFromNode=function(c,d,e,h,a){x.prototype.initFromNode.call(this,c,d,e,a);m.prototype.initFromNode.call(this,c,d,e,a);this.lang=h};O.prototype.createDefaultRegion=function(c,d){var h=new O;h.id="";e.prototype.initFromNode.call(h,c,null,{name:"region",attributes:{"tts:displayAlign":{name:"tts:displayAlign",
value:"after",prefix:"tts",local:"displayAlign",uri:"http://www.w3.org/ns/ttml#styling"},"tts:extent":{name:"tts:extent",value:"80% 20%",prefix:"tts",local:"extent",uri:"http://www.w3.org/ns/ttml#styling"},"tts:origin":{name:"tts:origin",value:"10% 70%",prefix:"tts",local:"origin",uri:"http://www.w3.org/ns/ttml#styling"},"tts:overflow":{name:"tts:overflow",value:"visible",prefix:"tts",local:"overflow",uri:"http://www.w3.org/ns/ttml#styling"}},ns:{"":"http://www.w3.org/ns/ttml",ebuttm:"urn:ebu:tt:metadata",
ebutts:"urn:ebu:tt:style",ittp:"http://www.w3.org/ns/ttml/profile/imsc1#parameter",itts:"http://www.w3.org/ns/ttml/profile/imsc1#styling",ttm:"http://www.w3.org/ns/ttml#metadata",ttp:"http://www.w3.org/ns/ttml#parameter",tts:"http://www.w3.org/ns/ttml#styling",xml:"http://www.w3.org/XML/1998/namespace"},prefix:"",local:"region",uri:"http://www.w3.org/ns/ttml",isSelfClosing:!0},d);h.sets=[];m.call(h,0,Number.POSITIVE_INFINITY,null);this.lang=c.xmllang;return h};O.prototype.initFromNode=function(c,
d,e,a){A.prototype.initFromNode.call(this,c,null,d,a);m.prototype.initFromNode.call(this,c,null,d,a);h.prototype.initFromNode.call(this,c,null,d,a);this.styleAttrs=I(d,a);this.styleRefs=G(d);this.lang=e};B.prototype.initFromNode=function(c,d,e,h){m.prototype.initFromNode.call(this,c,d,e,h);c=I(e,h);this.value=this.qname=null;for(var a in c)if(c.hasOwnProperty(a)){if(this.qname){H(h,"More than one style specified on set");break}this.qname=a;this.value=c[a]}}})("undefined"===typeof f?this.imscDoc={}:
f,"undefined"===typeof sax?a("sax"):sax,"undefined"===typeof imscNames?a("./names"):imscNames,"undefined"===typeof imscStyles?a("./styles"):imscStyles,"undefined"===typeof imscUtils?a("./utils"):imscUtils)},{"./names":5,"./styles":6,"./utils":7,sax:void 0}],2:[function(a,q,f){(function(a,f,k,n){function b(d){var e={};d=Object.entries(d);for(var c in d)if(d.hasOwnProperty(c)){var a=n.parseColor(d[c][0]),l=n.parseColor(d[c][1]);a&&l&&(e[a.toString()]=l)}return e}function r(e,a,c,m){if("region"===c.kind){var h=
document.createElement("div");h.style.position="absolute"}else if("body"===c.kind)h=document.createElement("div");else if("div"===c.kind)h=document.createElement("div");else if("image"===c.kind){if(h=document.createElement("img"),null!==e.imgResolver&&null!==c.src){var b=e.imgResolver(c.src,h);b&&(h.src=b);h.height=e.regionH;h.width=e.regionW}}else if("p"===c.kind)h=document.createElement("p");else if("span"===c.kind)if("container"===c.styleAttrs[k.byName.ruby.qname])h=document.createElement("ruby"),
e.ruby=!0;else if("base"===c.styleAttrs[k.byName.ruby.qname])h=document.createElement("rb");else if("text"===c.styleAttrs[k.byName.ruby.qname])h=document.createElement("rt");else if("baseContainer"===c.styleAttrs[k.byName.ruby.qname])h=document.createElement("rbc");else if("textContainer"===c.styleAttrs[k.byName.ruby.qname])h=document.createElement("rtc");else{if("delimiter"===c.styleAttrs[k.byName.ruby.qname])return;h=document.createElement("span")}else"br"===c.kind&&(h=document.createElement("br"));
if(h){!c.lang||"region"!==c.kind&&c.lang===m.lang||(h.lang=c.lang);a.appendChild(h);h.style.margin="0";if("region"===c.kind)if(a=c.styleAttrs[k.byName.writingMode.qname],"lrtb"===a||"lr"===a)e.ipd="lr",e.bpd="tb";else if("rltb"===a||"rl"===a)e.ipd="rl",e.bpd="tb";else if("tblr"===a)e.ipd="tb",e.bpd="lr";else{if("tbrl"===a||"tb"===a)e.ipd="tb",e.bpd="rl"}else"p"===c.kind&&"tb"===e.bpd&&(e.ipd="ltr"===c.styleAttrs[k.byName.direction.qname]?"lr":"rl");for(var p in q)q.hasOwnProperty(p)&&(a=q[p],m=c.styleAttrs[a.qname],
void 0!==m&&null!==a.map&&a.map(e,h,c,m));p=h;(a=c.styleAttrs[k.byName.linePadding.qname])&&!a.isZero()&&(m=a.multiply(a.toUsedLength(e.w,e.h),e.options.sizeAdjust),0<m&&(m=Math.ceil(m)+"px","tb"===e.bpd?(p.style.paddingLeft=m,p.style.paddingRight=m):(p.style.paddingTop=m,p.style.paddingBottom=m),e.removePaddingElement=p,e.lp=a));(a=c.styleAttrs[k.byName.multiRowAlign.qname])&&"auto"!==a&&(p=document.createElement("span"),p.style.display="inline-block",p.style.textAlign=a,h.appendChild(p),e.mra=a);
(a=c.styleAttrs[k.byName.rubyReserve.qname])&&"none"!==a[0]&&(e.rubyReserve=a);c.styleAttrs[k.byName.fillLineGap.qname]&&(e.flg=!0);if("span"===c.kind&&c.text)if((a=c.styleAttrs[k.byName.textEmphasis.qname])&&"none"!==a.style&&(e.textEmphasis=!0),k.byName.textCombine.qname in c.styleAttrs&&"all"===c.styleAttrs[k.byName.textCombine.qname])h.textContent=c.text,a&&J(e,h,c,a);else for(m="",b=0;b<c.text.length;b++){m+=c.text.charAt(b);var f=c.text.charCodeAt(b);if(55296>f||56319<f||b===c.text.length-1)f=
document.createElement("span"),f.textContent=m,a&&J(e,f,c,a),h.appendChild(f),m="",f._isd_element=c}for(var n in c.contents)c.contents.hasOwnProperty(n)&&r(e,p,c.contents[n],c);n=[];if("p"===c.kind){g(e,p,n,null);if(e.rubyReserve){for(a=0;a<n.length;a++){m=document.createElement("ruby");b=document.createElement("rb");b.textContent="\u200b";m.appendChild(b);var t=e.rubyReserve[1].toUsedLength(e.w,e.h)+"px";"both"===e.rubyReserve[0]||"outside"===e.rubyReserve[0]&&1==n.length?(b=document.createElement("rtc"),
b.style[z]=C?"after":"under",b.textContent="\u200b",b.style.fontSize=t,f=document.createElement("rtc"),f.style[z]=C?"before":"over",f.textContent="\u200b",f.style.fontSize=t,m.appendChild(b),m.appendChild(f)):(b=document.createElement("rtc"),b.textContent="\u200b",b.style.fontSize=t,b.style[z]="after"===e.rubyReserve[0]||"outside"===e.rubyReserve[0]&&0<a?C?"after":"tb"===e.bpd||"rl"===e.bpd?"under":"over":C?"before":"tb"===e.bpd||"rl"===e.bpd?"over":"under",m.appendChild(b));b=null;for(f=0;f<n[a].rbc.length;f++)if("ruby"===
n[a].rbc[f].localName){b=n[a].rbc[f];for(f=0;f<b.style.length;f++)m.style.setProperty(b.style.item(f),b.style.getPropertyValue(b.style.item(f)));break}b=b||n[a].elements[0].node;b.parentElement.insertBefore(m,b)}e.rubyReserve=null}if(e.ruby||e.rubyReserve){for(a=0;a<n.length;a++)for(m=0;m<n[a].rbc.length;m++)n[a].rbc[m].style[z]||(n[a].rbc[m].style[z]=C?0===a?"before":"after":"tb"===e.bpd?0===a?"over":"under":"rl"===e.bpd?0===a?"over":"under":0===a?"under":"over");e.ruby=null}if(e.textEmphasis){for(a=
0;a<n.length;a++)for(m=0;m<n[a].te.length;m++)n[a].te[m].style[x]&&"none"!==n[a].te[m].style[x]||(n[a].te[m].style[x]="tb"===e.bpd?0===a?"left over":"left under":"rl"===e.bpd?0===a?"right under":"left under":0===a?"left under":"right under");e.textEmphasis=null}if(e.mra){for(a=0;a<n.length-1;a++)b=n[a].elements.length,0!==b&&!1===n[a].br&&(m=document.createElement("br"),b=n[a].elements[b-1].node,b.parentElement.insertBefore(m,b.nextSibling));e.mra=null}if(e.lp){a=e.lp.multiply(e.lp.toUsedLength(e.w,
e.h),e.options.sizeAdjust);for(m=0;m<n.length;m++){b=n[m].elements[n[m].start_elem];f=n[m].elements[n[m].end_elem];t=Math.ceil(a)+"px";var w="-"+Math.ceil(a)+"px";0!==n[m].elements.length&&("lr"===e.ipd?(b.node.marginLeft=w,b.node.style.paddingLeft=t):"rl"===e.ipd?(b.node.style.paddingRight=t,b.node.style.marginRight=w):"tb"===e.ipd&&(b.node.style.paddingTop=t,b.node.style.marginTop=w),"lr"===e.ipd?(f.node.style.paddingRight=t,f.node.style.marginRight=w):"rl"===e.ipd?(f.node.style.paddingLeft=t,f.node.style.marginLeft=
w):"tb"===e.ipd&&(f.node.style.paddingBottom=t,f.node.style.marginBottom=w))}"tb"===e.bpd?(e.removePaddingElement.style.paddingLeft=0,e.removePaddingElement.style.paddingRight=0):(e.removePaddingElement.style.paddingTop=0,e.removePaddingElement.style.paddingBottom=0);e.lp=null}for(a=0;a<n.length;a++)for(m=n[a],b=1;b<m.elements.length;){f=m.elements[b-1].node;t=m.elements[b].node;if("SPAN"===f.tagName&&"SPAN"===t.tagName&&f._isd_element===t._isd_element){f.textContent+=t.textContent;for(w=0;w<t.style.length;w++){var B=
t.style[w];if(0<=B.indexOf("border")||0<=B.indexOf("padding"))f.style[B]=t.style[B]}t.parentElement.removeChild(t);f=!0}else f=!1;f?m.elements.splice(b,1):b++}a=[];for(f=0;f<n.length;f++)for(t=0;t<n[f].elements.length;t++)if(m=n[f].elements[t].node,b=d(m,a,!1))m.style.backgroundColor=b;for(m=0;m<a.length;m++)a[m].style.backgroundColor="";if(e.flg){m=F(p.getBoundingClientRect(),e);a=m.before;m=m.after;b=Math.sign(m-a);for(f=0;f<=n.length;f++){t=0===f?Math.round(a):f===n.length?Math.round(m):Math.round((n[f-
1].after+n[f].before)/2);if(0<f&&n[f-1])for(B=0;B<n[f-1].elements.length;B++){var A=n[f-1].elements[B];w=b*(t-A.after)+"px";"lr"===e.bpd?A.node.style.paddingRight=w:"rl"===e.bpd?A.node.style.paddingLeft=w:"tb"===e.bpd&&(A.node.style.paddingBottom=w)}if(f<n.length)for(B=0;B<n[f].elements.length;B++)A=n[f].elements[B],w=b*(A.before-t)+"px","lr"===e.bpd?A.node.style.paddingLeft=w:"rl"===e.bpd?A.node.style.paddingRight=w:"tb"===e.bpd&&(A.node.style.paddingTop=w)}e.flg=null}}"region"===c.kind&&"tb"===
e.bpd&&e.enableRollUp&&0<c.contents.length&&"after"===c.styleAttrs[k.byName.displayAlign.qname]&&(g(e,p,n,null),c=new l(""===c.id?"_":c.id,n),e.currentISDState[c.id]=c,e.previousISDState&&c.id in e.previousISDState&&0<e.previousISDState[c.id].plist.length&&1<c.plist.length&&c.plist[c.plist.length-2].text===e.previousISDState[c.id].plist[e.previousISDState[c.id].plist.length-1].text&&(e=h.firstElementChild,c=c.plist[c.plist.length-1].after-c.plist[c.plist.length-1].before,e.style.bottom="-"+c+"px",
e.style.transition="transform 0.4s",e.style.position="relative",e.style.transform="translateY(-"+c+"px)"))}else if(e=e.errorHandler,c="Error processing ISD element kind: "+c.kind,e&&e.error&&e.error(c))throw c;}function d(a,h,c){if(a.style.backgroundColor)return c&&!h.includes(a)&&h.push(a),a.style.backgroundColor;if("SPAN"===a.parentElement.nodeName)return d(a.parentElement,h,!0)}function l(a,d){this.id=a;this.plist=d}function F(a,d){var c={before:null,after:null,start:null,end:null};"tb"===d.bpd?
(c.before=a.top,c.after=a.bottom,"lr"===d.ipd?(c.start=a.left,c.end=a.right):(c.start=a.right,c.end=a.left)):"lr"===d.bpd?(c.before=a.left,c.after=a.right,c.start=a.top,c.end=a.bottom):"rl"===d.bpd&&(c.before=a.right,c.after=a.left,c.start=a.top,c.end=a.bottom);return c}function g(a,d,c,b){if("rt"!==d.localName&&"rtc"!==d.localName)if(b=d.style.backgroundColor||b,0===d.childElementCount)if("span"===d.localName||"rb"===d.localName){var e=d.getBoundingClientRect();a=F(e,a);if(!(e=0===c.length)){e=a.before;
var h=a.after,m=c[c.length-1].before,l=c[c.length-1].after;e=!(h<l&&e>m||l<=h&&m>=e)}e?c.push({before:a.before,after:a.after,start:a.start,end:a.end,start_elem:0,end_elem:0,elements:[],rbc:[],te:[],text:"",br:!1}):(e=Math.sign(a.after-a.before),h=Math.sign(a.end-a.start),0>e*(a.before-c[c.length-1].before)&&(c[c.length-1].before=a.before),0<e*(a.after-c[c.length-1].after)&&(c[c.length-1].after=a.after),0>h*(a.start-c[c.length-1].start)&&(c[c.length-1].start=a.start,c[c.length-1].start_elem=c[c.length-
1].elements.length),0<h*(a.end-c[c.length-1].end)&&(c[c.length-1].end=a.end,c[c.length-1].end_elem=c[c.length-1].elements.length));c[c.length-1].text+=d.textContent;c[c.length-1].elements.push({node:d,bgcolor:b,before:a.before,after:a.after})}else"br"===d.localName&&0!==c.length&&(c[c.length-1].br=!0);else for(d=d.firstChild;d;)d.nodeType===Node.ELEMENT_NODE&&(g(a,d,c,b),"ruby"===d.localName||"rtc"===d.localName?0<c.length&&c[c.length-1].rbc.push(d):"span"===d.localName&&d.style[A]&&"none"!==d.style[A]&&
0<c.length&&c[c.length-1].te.push(d)),d=d.nextSibling}function J(a,d,c,b){"none"!==b.style&&(d.style[A]="auto"===b.style?"filled":b.style+" "+b.symbol,"before"===b.position||"after"===b.position)&&(d.style[x]="tb"===a.bpd?"before"===b.position?"left over":"left under":"rl"===a.bpd?"before"===b.position?"right under":"left under":"before"===b.position?"left under":"right under")}function p(a,d){this.qname=a;this.map=d}a.render=function(a,d,c,m,l,g,f,k,p,n){m=m||d.clientHeight;var e=l||d.clientWidth;
null!==a.aspectRatio&&(l=m*a.aspectRatio,l>e?m=Math.round(e/a.aspectRatio):e=l);l=document.createElement("div");l.style.position="relative";l.style.width=e+"px";l.style.height=m+"px";l.style.margin="auto";l.style.top=0;l.style.bottom=0;l.style.left=0;l.style.right=0;l.style.zIndex=0;c={h:m,w:e,regionH:null,regionW:null,imgResolver:c,displayForcedOnlyMode:g||!1,isd:a,errorHandler:f,previousISDState:k,enableRollUp:p||!1,currentISDState:{},flg:null,lp:null,mra:null,ipd:null,bpd:null,ruby:null,textEmphasis:null,
rubyReserve:null,options:Object.assign({},n)||{}};c.options.colorAdjust&&(c.options.colorAdjust=b(c.options.colorAdjust));g=["region","body","div","p","span"];for(var h in g)g.hasOwnProperty(h)&&(f=g[h]+"BackgroundColorAdjust",c.options[f]&&(c.options[f]=b(c.options[f])));d.appendChild(l);for(var F in a.contents)a.contents.hasOwnProperty(F)&&r(c,l,a.contents[F],a);return c.currentISDState};var q=[new p("http://www.w3.org/ns/ttml#styling backgroundColor",function(a,d,c,b){(c=(c=a.options[c.kind+"BackgroundColorAdjust"])&&
c[b.toString()])&&(b=c);c=b[3];0!==c&&(void 0!=a.options.backgroundOpacityScale&&(c*=a.options.backgroundOpacityScale),d.style.backgroundColor="rgba("+b[0].toString()+","+b[1].toString()+","+b[2].toString()+","+(c/255).toString()+")")}),new p("http://www.w3.org/ns/ttml#styling color",function(a,d,c,b){c=a.options.colorOpacityScale||1;a=a.options.colorAdjust;void 0!=a&&(a=a[b.toString()])&&(b=a);d.style.color="rgba("+b[0].toString()+","+b[1].toString()+","+b[2].toString()+","+(c*b[3]/255).toString()+
")"}),new p("http://www.w3.org/ns/ttml#styling direction",function(a,d,c,b){d.style.direction=b}),new p("http://www.w3.org/ns/ttml#styling display",function(a,d,c,b){}),new p("http://www.w3.org/ns/ttml#styling displayAlign",function(a,d,c,b){d.style.display="flex";d.style.flexDirection="column";"before"===b?d.style.justifyContent="flex-start":"center"===b?d.style.justifyContent="center":"after"===b&&(d.style.justifyContent="flex-end")}),new p("http://www.w3.org/ns/ttml#styling extent",function(a,
d,c,b){a.regionH=b.h.toUsedLength(a.w,a.h);a.regionW=b.w.toUsedLength(a.w,a.h);var e=b=0;if(c=c.styleAttrs["http://www.w3.org/ns/ttml#styling padding"])b=c[0].toUsedLength(a.w,a.h)+c[2].toUsedLength(a.w,a.h),e=c[1].toUsedLength(a.w,a.h)+c[3].toUsedLength(a.w,a.h);d.style.height=a.regionH-b+"px";d.style.width=a.regionW-e+"px"}),new p("http://www.w3.org/ns/ttml#styling fontFamily",function(a,d,c,b){c=[];a.options.fontFamily&&(b=a.options.fontFamily.split(","));for(var e in b)b[e].hasOwnProperty(e)&&
(b[e]=b[e].trim(),"monospaceSerif"===b[e]?(c.push("Courier New"),c.push('"Liberation Mono"'),c.push("Courier"),c.push("monospace")):"proportionalSansSerif"===b[e]||"default"===b[e]?(c.push("Arial"),c.push("Helvetica"),c.push('"Liberation Sans"'),c.push("sans-serif")):"monospace"===b[e]?c.push("monospace"):"sansSerif"===b[e]?c.push("sans-serif"):"serif"===b[e]?c.push("serif"):"monospaceSansSerif"===b[e]?(c.push("Consolas"),c.push("monospace")):"proportionalSerif"===b[e]?c.push("serif"):c.push(b[e]));
if(0<c.length){a=[c[0]];for(b=1;b<c.length;b++)-1==a.indexOf(c[b])&&a.push(c[b]);c=a}d.style.fontFamily=c.join(",")}),new p("http://www.w3.org/ns/ttml#styling shear",function(a,d,c,b){0!==b&&(c=-.9*b,d.style.transform="tb"===a.bpd?"skewX("+c+"deg)":"skewY("+c+"deg)")}),new p("http://www.w3.org/ns/ttml#styling fontSize",function(a,d,c,b){d.style.fontSize=b.multiply(b.toUsedLength(a.w,a.h),a.options.sizeAdjust)+"px"}),new p("http://www.w3.org/ns/ttml#styling fontStyle",function(a,d,c,b){d.style.fontStyle=
b}),new p("http://www.w3.org/ns/ttml#styling fontWeight",function(a,d,c,b){d.style.fontWeight=b}),new p("http://www.w3.org/ns/ttml#styling lineHeight",function(a,d,c,b){d.style.lineHeight="normal"===b?"normal":b.multiply(b.multiply(b.toUsedLength(a.w,a.h),a.options.sizeAdjust),a.options.lineHeightAdjust)+"px"}),new p("http://www.w3.org/ns/ttml#styling opacity",function(a,d,c,b){c=b;void 0!=a.options.regionOpacityScale&&(c*=a.options.regionOpacityScale);d.style.opacity=c}),new p("http://www.w3.org/ns/ttml#styling origin",
function(a,d,c,b){d.style.top=b.h.toUsedLength(a.w,a.h)+"px";d.style.left=b.w.toUsedLength(a.w,a.h)+"px"}),new p("http://www.w3.org/ns/ttml#styling overflow",function(a,d,c,b){d.style.overflow=b}),new p("http://www.w3.org/ns/ttml#styling padding",function(a,d,c,b){c=[];c[0]=b[0].toUsedLength(a.w,a.h)+"px";c[1]=b[3].toUsedLength(a.w,a.h)+"px";c[2]=b[2].toUsedLength(a.w,a.h)+"px";c[3]=b[1].toUsedLength(a.w,a.h)+"px";d.style.padding=c.join(" ")}),new p("http://www.w3.org/ns/ttml#styling position",function(a,
d,c,b){d.style.top=b.h.toUsedLength(a.w,a.h)+"px";d.style.left=b.w.toUsedLength(a.w,a.h)+"px"}),new p("http://www.w3.org/ns/ttml#styling rubyAlign",function(a,d,c,b){d.style.rubyAlign="spaceAround"===b?"space-around":"center"}),new p("http://www.w3.org/ns/ttml#styling rubyPosition",function(a,d,c,b){if("before"===b||"after"===b)d.parentElement.style[z]=C?b:"tb"===a.bpd?"before"===b?"over":"under":"rl"===a.bpd?"before"===b?"over":"under":"before"===b?"under":"over"}),new p("http://www.w3.org/ns/ttml#styling showBackground",
null),new p("http://www.w3.org/ns/ttml#styling textAlign",function(a,d,c,b){d.style.textAlign="start"===b?"rl"===a.ipd?"right":"left":"end"===b?"rl"===a.ipd?"left":"right":b}),new p("http://www.w3.org/ns/ttml#styling textDecoration",function(a,d,c,b){d.style.textDecoration=b.join(" ").replace("lineThrough","line-through")}),new p("http://www.w3.org/ns/ttml#styling textOutline",function(a,d,c,b){}),new p("http://www.w3.org/ns/ttml#styling textShadow",function(a,d,c,b){c=c.styleAttrs[k.byName.textOutline.qname];
var e=a.options.textOutline;if(e)if("none"===e)c=e;else{var l={};e=e.split(" ");if(0!==e.length&&2>=e.length){var h=n.parseColor(e[0]);l.color=h;null!==h&&e.shift();1===e.length&&(e=n.parseLength(e[0]))&&(l.thickness=e,c=l)}}if("none"===b&&"none"===c)d.style.textShadow="";else{l=[];"none"!==c&&(c="rgba("+c.color[0].toString()+","+c.color[1].toString()+","+c.color[2].toString()+","+(c.color[3]/255).toString()+")",l.push("1px 1px 1px "+c),l.push("-1px 1px 1px "+c),l.push("1px -1px 1px "+c),l.push("-1px -1px 1px "+
c));if("none"!==b)for(var g in b)b.hasOwnProperty(g)&&l.push(b[g].x_off.toUsedLength(a.w,a.h)+"px "+b[g].y_off.toUsedLength(a.w,a.h)+"px "+b[g].b_radius.toUsedLength(a.w,a.h)+"px rgba("+b[g].color[0].toString()+","+b[g].color[1].toString()+","+b[g].color[2].toString()+","+(b[g].color[3]/255).toString()+")");d.style.textShadow=l.join(",")}}),new p("http://www.w3.org/ns/ttml#styling textCombine",function(a,d,c,b){d.style.textCombineUpright=b}),new p("http://www.w3.org/ns/ttml#styling textEmphasis",
function(a,d,c,b){}),new p("http://www.w3.org/ns/ttml#styling unicodeBidi",function(a,d,c,b){d.style.unicodeBidi="bidiOverride"===b?"bidi-override":b}),new p("http://www.w3.org/ns/ttml#styling visibility",function(a,d,c,b){d.style.visibility=b}),new p("http://www.w3.org/ns/ttml#styling wrapOption",function(a,d,c,b){d.style.whiteSpace="wrap"===b?"preserve"===c.space?"pre-wrap":"normal":"preserve"===c.space?"pre":"noWrap"}),new p("http://www.w3.org/ns/ttml#styling writingMode",function(a,d,c,b){if("lrtb"===
b||"lr"===b)d.style.writingMode="horizontal-tb";else if("rltb"===b||"rl"===b)d.style.writingMode="horizontal-tb";else if("tblr"===b)d.style.writingMode="vertical-lr";else if("tbrl"===b||"tb"===b)d.style.writingMode="vertical-rl"}),new p("http://www.w3.org/ns/ttml#styling zIndex",function(a,d,c,b){d.style.zIndex=b}),new p("http://www.w3.org/ns/ttml/profile/imsc1#styling forcedDisplay",function(a,d,c,b){a.displayForcedOnlyMode&&!1===b&&(d.style.visibility="hidden")})],N;for(N in q)q.hasOwnProperty(N);
var C="webkitRubyPosition"in window.getComputedStyle(document.documentElement),z=C?"webkitRubyPosition":"rubyPosition",A="webkitTextEmphasisStyle"in window.getComputedStyle(document.documentElement)?"webkitTextEmphasisStyle":"textEmphasisStyle",x="webkitTextEmphasisPosition"in window.getComputedStyle(document.documentElement)?"webkitTextEmphasisPosition":"textEmphasisPosition"})("undefined"===typeof f?this.imscHTML={}:f,"undefined"===typeof imscNames?a("./names"):imscNames,"undefined"===typeof imscStyles?
a("./styles"):imscStyles,"undefined"===typeof imscUtils?a("./utils"):imscUtils)},{"./names":5,"./styles":6,"./utils":7}],3:[function(a,q,f){(function(a,f,k,n){function b(a,f,F,q,z,A,x,e,h){if(f<x.begin||f>=x.end)return null;A="regionID"in x&&""!==x.regionID?x.regionID:A;if(null!==z&&A!==F.id&&(!("contents"in x)||"contents"in x&&0===x.contents.length||""!==A))return null;var c=new g(x);for(m in x.sets)!x.sets.hasOwnProperty(m)||f<x.sets[m].begin||f>=x.sets[m].end||(c.styleAttrs[x.sets[m].qname]=x.sets[m].value);
var m={};for(var p in c.styleAttrs)if(c.styleAttrs.hasOwnProperty(p)&&(m[p]=!0,"region"===c.kind&&p===k.byName.writingMode.qname&&!(k.byName.direction.qname in c.styleAttrs))){var w=c.styleAttrs[p];if("lrtb"===w||"lr"===w)c.styleAttrs[k.byName.direction.qname]="ltr";else if("rltb"===w||"rl"===w)c.styleAttrs[k.byName.direction.qname]="rtl"}if(null!==z)for(var y in k.all)if(k.all.hasOwnProperty(y))if(p=k.all[y],p.qname===k.byName.textDecoration.qname){w=z.styleAttrs[p.qname];var C=c.styleAttrs[p.qname],
D=[];void 0===C?D=w:-1===C.indexOf("none")?((-1===C.indexOf("noUnderline")&&-1!==w.indexOf("underline")||-1!==C.indexOf("underline"))&&D.push("underline"),(-1===C.indexOf("noLineThrough")&&-1!==w.indexOf("lineThrough")||-1!==C.indexOf("lineThrough"))&&D.push("lineThrough"),(-1===C.indexOf("noOverline")&&-1!==w.indexOf("overline")||-1!==C.indexOf("overline"))&&D.push("overline")):D.push("none");c.styleAttrs[p.qname]=D}else p.qname!==k.byName.fontSize.qname||p.qname in c.styleAttrs||"span"!==c.kind||
"textContainer"!==c.styleAttrs[k.byName.ruby.qname]?p.qname!==k.byName.fontSize.qname||p.qname in c.styleAttrs||"span"!==c.kind||"text"!==c.styleAttrs[k.byName.ruby.qname]?p.inherit&&p.qname in z.styleAttrs&&!(p.qname in c.styleAttrs)&&(c.styleAttrs[p.qname]=z.styleAttrs[p.qname]):(w=z.styleAttrs[k.byName.fontSize.qname],c.styleAttrs[p.qname]="textContainer"===z.styleAttrs[k.byName.ruby.qname]?w:new n.ComputedLength(.5*w.rw,.5*w.rh)):(w=z.styleAttrs[k.byName.fontSize.qname],c.styleAttrs[p.qname]=
new n.ComputedLength(.5*w.rw,.5*w.rh));for(var t in k.all)if(k.all.hasOwnProperty(t)&&(y=k.all[t],!(y.qname in c.styleAttrs||y.qname===k.byName.position.qname&&k.byName.origin.qname in c.styleAttrs||y.qname===k.byName.origin.qname&&k.byName.position.qname in c.styleAttrs)&&(p=a.head.styling.initials[y.qname]||y.initial,null!==p&&("region"===c.kind||!1===y.inherit&&null!==p))))if(p=y.parse(p),null!==p)c.styleAttrs[y.qname]=p,m[y.qname]=!0;else if(y="Invalid initial value for '"+y.qname+"' on element '"+
c.kind,e&&e.error&&e.error(y))throw y;for(var N in k.all)if(k.all.hasOwnProperty(N)&&(t=k.all[N],t.qname in m&&null!==t.compute))if(y=t.compute(a,z,c,c.styleAttrs[t.qname],h),null!==y)c.styleAttrs[t.qname]=y;else if(c.styleAttrs[t.qname]=t.compute(a,z,c,t.parse(t.initial),h),t="Style '"+t.qname+"' on element '"+c.kind+"' cannot be computed",e&&e.error&&e.error(t))throw t;if("none"===c.styleAttrs[k.byName.display.qname])return null;if(null===z)var B=null===q?[]:[q];else"contents"in x&&(B=x.contents);
for(var I in B)B.hasOwnProperty(I)&&(z=b(a,f,F,q,c,A,B[I],e,h),null!==z&&c.contents.push(z.element));for(var G in c.styleAttrs)c.styleAttrs.hasOwnProperty(G)&&(a=!1,"span"===c.kind&&(f=c.styleAttrs[k.byName.ruby.qname],(a=("container"===f||"textContainer"===f||"baseContainer"===f)&&-1!==J.indexOf(G))||(a="container"!==f&&G===k.byName.rubyAlign.qname),a||(a=!("textContainer"===f||"text"===f)&&G===k.byName.rubyPosition.qname)),a||(a=-1===k.byQName[G].applies.indexOf(c.kind)),a&&delete c.styleAttrs[G]);
G=c.styleAttrs[k.byName.ruby.qname];if("p"===c.kind||"span"===c.kind&&("textContainer"===G||"text"===G))G=[],d(c,G),r(G),l(c);return"div"===c.kind&&k.byName.backgroundImage.qname in c.styleAttrs||"br"===c.kind||"image"===c.kind||"contents"in c&&0<c.contents.length||"span"===c.kind&&null!==c.text||"region"===c.kind&&"always"===c.styleAttrs[k.byName.showBackground.qname]?{region_id:A,element:c}:null}function r(a){function d(a){return"br"===a.kind||/[\r\n\t ]$/.test(a.text)}function b(a){return"br"===
a.kind||"preserve"===a.space&&/^[\r\n]/.test(a.text)}for(var l,g=0;g<a.length;)if(l=a[g],"br"===l.kind||"preserve"===l.space)g++;else{var f=l.text.replace(/[\t\r\n ]+/g," ");/^[ ]/.test(f)&&(0===g||d(a[g-1]))&&(f=f.substring(1));l.text=f;0===f.length?a.splice(g,1):g++}for(g=0;g<a.length;g++)l=a[g],"br"===l.kind||"preserve"===l.space?g++:/[ ]$/.test(l.text)&&(g===a.length-1||b(a[g+1]))&&(l.text=l.text.slice(0,-1))}function d(a,b){for(var l in a.contents)if(a.contents.hasOwnProperty(l)){var g=a.contents[l],
f=g.styleAttrs[k.byName.ruby.qname];if("span"!==g.kind||"textContainer"!==f&&"text"!==f)"contents"in g?d(g,b):("span"===g.kind&&0!==g.text.length||"br"===g.kind)&&b.push(g)}}function l(a){if("br"===a.kind)return!1;if("text"in a)return 0===a.text.length;if("contents"in a){for(var d=a.contents.length;d--;)l(a.contents[d])&&a.contents.splice(d,1);return 0===a.contents.length}}function F(a){this.contents=[];this.aspectRatio=a.aspectRatio;this.lang=a.lang}function g(a){this.kind=a.kind||"region";this.lang=
a.lang;a.id&&(this.id=a.id);this.styleAttrs={};for(var d in a.styleAttrs)a.styleAttrs.hasOwnProperty(d)&&(this.styleAttrs[d]=a.styleAttrs[d]);"src"in a&&(this.src=a.src);"type"in a&&(this.type=a.type);if("text"in a)this.text=a.text;else if("region"===this.kind||"contents"in a)this.contents=[];"space"in a&&(this.space=a.space)}a.generateISD=function(a,d,l){function g(a,d){function c(d){return!(a<d.begin||a>=d.end)}if(d.contents){var b={},l;for(l in d)d.hasOwnProperty(l)&&(b[l]=d[l]);b.contents=[];
d.contents.filter(c).forEach(function(d){d=g(a,d);d.regionID&&e.add(d.regionID);null!==d&&b.contents.push(d)});return b}return d}var f=new F(a),k={},n={},e=new Set;n=g(d,a.body);0===e.size&&a.head.layout.regions.hasOwnProperty("")&&e.add("");e.forEach(function(e){e=b(a,d,a.head.layout.regions[e],n,null,"",a.head.layout.regions[e],l,k);null!==e&&f.contents.push(e.element)});return f};var J=[k.byName.color.qname,k.byName.textCombine.qname,k.byName.textDecoration.qname,k.byName.textEmphasis.qname,k.byName.textOutline.qname,
k.byName.textShadow.qname]})("undefined"===typeof f?this.imscISD={}:f,"undefined"===typeof imscNames?a("./names"):imscNames,"undefined"===typeof imscStyles?a("./styles"):imscStyles,"undefined"===typeof imscUtils?a("./utils"):imscUtils)},{"./names":5,"./styles":6,"./utils":7}],4:[function(a,q,f){f.generateISD=a("./isd").generateISD;f.fromXML=a("./doc").fromXML;f.renderHTML=a("./html").render},{"./doc":1,"./html":2,"./isd":3}],5:[function(a,q,f){a="undefined"===typeof f?this.imscNames={}:f;a.ns_tt=
"http://www.w3.org/ns/ttml";a.ns_tts="http://www.w3.org/ns/ttml#styling";a.ns_ttp="http://www.w3.org/ns/ttml#parameter";a.ns_xml="http://www.w3.org/XML/1998/namespace";a.ns_itts="http://www.w3.org/ns/ttml/profile/imsc1#styling";a.ns_ittp="http://www.w3.org/ns/ttml/profile/imsc1#parameter";a.ns_smpte="http://www.smpte-ra.org/schemas/2052-1/2010/smpte-tt";a.ns_ebutts="urn:ebu:tt:style";a.ttaf_map={"http://www.w3.org/2006/10/ttaf1":a.ns_tt,"http://www.w3.org/2006/10/ttaf1#style":a.ns_tts,"http://www.w3.org/2006/10/ttaf1#parameter":a.ns_ttp}},
{}],6:[function(a,q,f){(function(a,f,k){function b(a,b,f,g,k,p,n,q){this.name=b;this.ns=a;this.qname=a+" "+b;this.inherit=k;this.animatable=p;this.initial=f;this.applies=g;this.parse=n;this.compute=q}a.all=[new b(f.ns_tts,"backgroundColor","transparent",["body","div","p","region","span"],!1,!0,k.parseColor,null),new b(f.ns_tts,"color","white",["span"],!0,!0,k.parseColor,null),new b(f.ns_tts,"direction","ltr",["p","span"],!0,!0,function(a){return a},null),new b(f.ns_tts,"display","auto",["body","div",
"p","region","span"],!1,!0,function(a){return a},null),new b(f.ns_tts,"displayAlign","before",["region"],!1,!0,function(a){return a},null),new b(f.ns_tts,"extent","auto",["tt","region"],!1,!0,function(a){if("auto"===a)return a;var d=a.split(" ");if(2!==d.length)return null;a=k.parseLength(d[0]);return(d=k.parseLength(d[1]))&&a?{h:d,w:a}:null},function(a,b,f,g,n){if("auto"===g)b=new k.ComputedLength(0,1);else if(b=k.toComputedLength(g.h.value,g.h.unit,null,a.dimensions.h,null,a.pxLength.h),null===
b)return null;if("auto"===g)a=new k.ComputedLength(1,0);else if(a=k.toComputedLength(g.w.value,g.w.unit,null,a.dimensions.w,null,a.pxLength.w),null===a)return null;return{h:b,w:a}}),new b(f.ns_tts,"fontFamily","default",["span","p"],!0,!0,function(a){a=a.split(",");for(var d=[],b=0;b<a.length;b++)"'"!==a[b].charAt(0)&&'"'!==a[b].charAt(0)?"default"===a[b]?d.push("monospaceSerif"):d.push(a[b]):d.push(a[b]);return d},null),new b(f.ns_tts,"shear","0%",["p"],!0,!0,k.parseLength,function(a,b,f,g){if("%"===
g.unit)a=100<Math.abs(g.value)?100*Math.sign(g.value):g.value;else return null;return a}),new b(f.ns_tts,"fontSize","1c",["span","p"],!0,!0,k.parseLength,function(d,b,f,g,n){return k.toComputedLength(g.value,g.unit,null!==b?b.styleAttrs[a.byName.fontSize.qname]:d.cellLength.h,null!==b?b.styleAttrs[a.byName.fontSize.qname]:d.cellLength.h,d.cellLength.h,d.pxLength.h)}),new b(f.ns_tts,"fontStyle","normal",["span","p"],!0,!0,function(a){return a},null),new b(f.ns_tts,"fontWeight","normal",["span","p"],
!0,!0,function(a){return a},null),new b(f.ns_tts,"lineHeight","normal",["p"],!0,!0,function(a){return"normal"===a?a:k.parseLength(a)},function(d,b,f,g,n){if("normal"===g)d=g;else if(d=k.toComputedLength(g.value,g.unit,f.styleAttrs[a.byName.fontSize.qname],f.styleAttrs[a.byName.fontSize.qname],d.cellLength.h,d.pxLength.h),null===d)return null;return d}),new b(f.ns_tts,"opacity",1,["region"],!1,!0,parseFloat,null),new b(f.ns_tts,"origin","auto",["region"],!1,!0,function(a){if("auto"===a)return a;var d=
a.split(" ");if(2!==d.length)return null;a=k.parseLength(d[0]);return(d=k.parseLength(d[1]))&&a?{h:d,w:a}:null},function(a,b,f,g,n){if("auto"===g)b=new k.ComputedLength(0,0);else if(b=k.toComputedLength(g.h.value,g.h.unit,null,a.dimensions.h,null,a.pxLength.h),null===b)return null;if("auto"===g)a=new k.ComputedLength(0,0);else if(a=k.toComputedLength(g.w.value,g.w.unit,null,a.dimensions.w,null,a.pxLength.w),null===a)return null;return{h:b,w:a}}),new b(f.ns_tts,"overflow","hidden",["region"],!1,!0,
function(a){return a},null),new b(f.ns_tts,"padding","0px",["region"],!1,!0,function(a){a=a.split(" ");if(4<a.length)return null;for(var d=[],b=0;b<a.length;b++){var f=k.parseLength(a[b]);if(!f)return null;d.push(f)}return d},function(d,b,f,g,n){if(1===g.length)b=[g[0],g[0],g[0],g[0]];else if(2===g.length)b=[g[0],g[1],g[0],g[1]];else if(3===g.length)b=[g[0],g[1],g[2],g[1]];else if(4===g.length)b=[g[0],g[1],g[2],g[3]];else return null;g=f.styleAttrs[a.byName.writingMode.qname];if("lrtb"===g||"lr"===
g)b=[b[0],b[3],b[2],b[1]];else if("rltb"===g||"rl"===g)b=[b[0],b[1],b[2],b[3]];else if("tblr"===g)b=[b[3],b[0],b[1],b[2]];else if("tbrl"===g||"tb"===g)b=[b[3],b[2],b[1],b[0]];else return null;g=[];for(n=0;n<b.length;n++)if(0===b[n].value)g[n]=new k.ComputedLength(0,0);else if(g[n]=k.toComputedLength(b[n].value,b[n].unit,f.styleAttrs[a.byName.fontSize.qname],"0"===n||"2"===n?f.styleAttrs[a.byName.extent.qname].h:f.styleAttrs[a.byName.extent.qname].w,"0"===n||"2"===n?d.cellLength.h:d.cellLength.w,"0"===
n||"2"===n?d.pxLength.h:d.pxLength.w),null===g[n])return null;return g}),new b(f.ns_tts,"position","top left",["region"],!1,!0,function(a){return k.parsePosition(a)},function(d,b,f,g){b=k.toComputedLength(g.v.offset.value,g.v.offset.unit,null,new k.ComputedLength(-f.styleAttrs[a.byName.extent.qname].h.rw,d.dimensions.h.rh-f.styleAttrs[a.byName.extent.qname].h.rh),null,d.pxLength.h);if(null===b)return null;"bottom"===g.v.edge&&(b=new k.ComputedLength(-b.rw-f.styleAttrs[a.byName.extent.qname].h.rw,
d.dimensions.h.rh-b.rh-f.styleAttrs[a.byName.extent.qname].h.rh));var l=k.toComputedLength(g.h.offset.value,g.h.offset.unit,null,new k.ComputedLength(d.dimensions.w.rw-f.styleAttrs[a.byName.extent.qname].w.rw,-f.styleAttrs[a.byName.extent.qname].w.rh),null,d.pxLength.w);if(null===b)return null;"right"===g.h.edge&&(l=new k.ComputedLength(d.dimensions.w.rw-l.rw-f.styleAttrs[a.byName.extent.qname].w.rw,-l.rh-f.styleAttrs[a.byName.extent.qname].w.rh));return{h:b,w:l}}),new b(f.ns_tts,"ruby","none",["span"],
!1,!0,function(a){return a},null),new b(f.ns_tts,"rubyAlign","center",["span"],!0,!0,function(a){return"center"!==a&&"spaceAround"!==a?null:a},null),new b(f.ns_tts,"rubyPosition","outside",["span"],!0,!0,function(a){return a},null),new b(f.ns_tts,"rubyReserve","none",["p"],!0,!0,function(a){var d=a.split(" ");a=[null,null];if(0===d.length||2<d.length||"none"!==d[0]&&"both"!==d[0]&&"after"!==d[0]&&"before"!==d[0]&&"outside"!==d[0])return null;a[0]=d[0];if(2===d.length&&"none"!==d[0])if(d=k.parseLength(d[1]))a[1]=
d;else return null;return a},function(d,b,f,g,n){if("none"===g[0])return g;d=null===g[1]?new k.ComputedLength(.5*f.styleAttrs[a.byName.fontSize.qname].rw,.5*f.styleAttrs[a.byName.fontSize.qname].rh):k.toComputedLength(g[1].value,g[1].unit,f.styleAttrs[a.byName.fontSize.qname],f.styleAttrs[a.byName.fontSize.qname],d.cellLength.h,d.pxLength.h);return null===d?null:[g[0],d]}),new b(f.ns_tts,"showBackground","whenActive",["region"],!1,!0,function(a){return a},null),new b(f.ns_tts,"textAlign","start",
["p"],!0,!0,function(a){return a},function(a,b,f,g,k){return"left"===g?"start":"right"===g?"end":g}),new b(f.ns_tts,"textCombine","none",["span"],!0,!0,function(a){return"none"===a||"all"===a?a:null},null),new b(f.ns_tts,"textDecoration","none",["span"],!0,!0,function(a){return a.split(" ")},null),new b(f.ns_tts,"textEmphasis","none",["span"],!0,!0,function(a){a=a.split(" ");for(var b={style:null,symbol:null,color:null,position:null},d=0;d<a.length;d++)if("none"===a[d]||"auto"===a[d])b.style=a[d];
else if("filled"===a[d]||"open"===a[d])b.style=a[d];else if("circle"===a[d]||"dot"===a[d]||"sesame"===a[d])b.symbol=a[d];else if("current"===a[d])b.color=a[d];else if("outside"===a[d]||"before"===a[d]||"after"===a[d])b.position=a[d];else if(b.color=k.parseColor(a[d]),null===b.color)return null;null==b.style&&null==b.symbol?b.style="auto":(b.symbol=b.symbol||"circle",b.style=b.style||"filled");b.position=b.position||"outside";b.color=b.color||"current";return b},null),new b(f.ns_tts,"textOutline",
"none",["span"],!0,!0,function(a){if("none"===a)return a;var b={};a=a.split(" ");if(0===a.length||2<a.length)return null;var d=k.parseColor(a[0]);b.color=d;null!==d&&a.shift();if(1!==a.length)return null;a=k.parseLength(a[0]);if(!a)return null;b.thickness=a;return b},function(b,f,n,g,q){if("none"===g)return g;f={};f.color=null===g.color?n.styleAttrs[a.byName.color.qname]:g.color;f.thickness=k.toComputedLength(g.thickness.value,g.thickness.unit,n.styleAttrs[a.byName.fontSize.qname],n.styleAttrs[a.byName.fontSize.qname],
b.cellLength.h,b.pxLength.h);return null===f.thickness?null:f}),new b(f.ns_tts,"textShadow","none",["span"],!0,!0,k.parseTextShadow,function(b,f,n,g){if("none"===g)return g;f=[];for(var d in g)if(d.hasOwnProperty(g)){var l={};l.x_off=k.toComputedLength(g[d][0].value,g[d][0].unit,null,n.styleAttrs[a.byName.fontSize.qname],null,b.pxLength.w);if(null===l.x_off)return null;l.y_off=k.toComputedLength(g[d][1].value,g[d][1].unit,null,n.styleAttrs[a.byName.fontSize.qname],null,b.pxLength.h);if(null===l.y_off)return null;
if(null===g[d][2])l.b_radius=0;else if(l.b_radius=k.toComputedLength(g[d][2].value,g[d][2].unit,null,n.styleAttrs[a.byName.fontSize.qname],null,b.pxLength.h),null===l.b_radius)return null;l.color=null===g[d][3]?n.styleAttrs[a.byName.color.qname]:g[d][3];f.push(l)}return f}),new b(f.ns_tts,"unicodeBidi","normal",["span","p"],!1,!0,function(a){return a},null),new b(f.ns_tts,"visibility","visible",["body","div","p","region","span"],!0,!0,function(a){return a},null),new b(f.ns_tts,"wrapOption","wrap",
["span"],!0,!0,function(a){return a},null),new b(f.ns_tts,"writingMode","lrtb",["region"],!1,!0,function(a){return a},null),new b(f.ns_tts,"zIndex","auto",["region"],!1,!0,function(a){"auto"!==a&&(a=parseInt(a),isNaN(a)&&(a=null));return a},null),new b(f.ns_ebutts,"linePadding","0c",["p"],!0,!1,k.parseLength,function(a,b,f,g,n){return k.toComputedLength(g.value,g.unit,null,null,a.cellLength.w,null)}),new b(f.ns_ebutts,"multiRowAlign","auto",["p"],!0,!1,function(a){return a},null),new b(f.ns_smpte,
"backgroundImage",null,["div"],!1,!1,function(a){return a},null),new b(f.ns_itts,"forcedDisplay","false",["body","div","p","region","span"],!0,!0,function(a){return"true"===a?!0:!1},null),new b(f.ns_itts,"fillLineGap","true",["p"],!0,!0,function(a){return"true"===a?!0:!1},null)];a.byQName={};for(var q in a.all)a.all.hasOwnProperty(q)&&(a.byQName[a.all[q].qname]=a.all[q]);a.byName={};for(var r in a.all)a.all.hasOwnProperty(r)&&(a.byName[a.all[r].name]=a.all[r])})("undefined"===typeof f?this.imscStyles=
{}:f,"undefined"===typeof imscNames?a("./names"):imscNames,"undefined"===typeof imscUtils?a("./utils"):imscUtils)},{"./names":5,"./utils":7}],7:[function(a,q,f){(function(a){var b=/#([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})?/,f=/rgb\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/,n=/rgba\(\s*(\d+),\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/,q={transparent:[0,0,0,0],black:[0,0,0,255],silver:[192,192,192,255],gray:[128,128,128,255],white:[255,255,255,255],maroon:[128,0,0,255],red:[255,0,0,
255],purple:[128,0,128,255],fuchsia:[255,0,255,255],magenta:[255,0,255,255],green:[0,128,0,255],lime:[0,255,0,255],olive:[128,128,0,255],yellow:[255,255,0,255],navy:[0,0,128,255],blue:[0,0,255,255],teal:[0,128,128,255],aqua:[0,255,255,255],cyan:[0,255,255,255]};a.parseColor=function(a){var d,k=null,g=q[a.toLowerCase()];void 0!==g?k=g:null!==(d=b.exec(a))?k=[parseInt(d[1],16),parseInt(d[2],16),parseInt(d[3],16),void 0!==d[4]?parseInt(d[4],16):255]:null!==(d=f.exec(a))?k=[parseInt(d[1]),parseInt(d[2]),
parseInt(d[3]),255]:null!==(d=n.exec(a))&&(k=[parseInt(d[1]),parseInt(d[2]),parseInt(d[3]),parseInt(d[4])]);return k};var D=/^((?:\+|\-)?\d*(?:\.\d+)?)(px|em|c|%|rh|rw)$/;a.parseLength=function(a){var b,d=null;null!==(b=D.exec(a))&&(d={value:parseFloat(b[1]),unit:b[2]});return d};a.parseTextShadow=function(b){b=b.split(",");for(var d=[],f=0;f<b.length;f++){var g=b[f].split(" ");if(1===g.length&&"none"===g[0])return"none";if(1<g.length&&5>g.length){var k=[null,null,null,null],n=a.parseLength(g.shift());
if(null===n)return null;k[0]=n;n=a.parseLength(g.shift());if(null===n)return null;k[1]=n;if(0!==g.length&&(n=a.parseLength(g[0]),null!==n&&(k[2]=n,g.shift()),0!==g.length)){g=a.parseColor(g[0]);if(null===g)return null;k[3]=g}d.push(k)}}return d};a.parsePosition=function(b){b=b.split(" ");var d=function(a){return"center"===a||"left"===a||"top"===a||"bottom"===a||"right"===a};if(4<b.length)return null;for(var f in b)if(b.hasOwnProperty(f)&&!d(b[f])){var g=a.parseLength(b[f]);if(null===g)return null;
b[f]=g}f={h:{edge:"left",offset:{value:50,unit:"%"}},v:{edge:"top",offset:{value:50,unit:"%"}}};for(g=0;g<b.length;){var k=b[g++];if(d(k)){var n={value:0,unit:"%"};2!==b.length&&g<b.length&&!d(b[g])&&(n=b[g++]);"right"===k?(f.h.edge=k,f.h.offset=n):"bottom"===k?(f.v.edge=k,f.v.offset=n):"left"===k?f.h.offset=n:"top"===k&&(f.v.offset=n)}else if(1===b.length||2===b.length)1===g?f.h.offset=k:f.v.offset=k;else return null}return f};a.ComputedLength=function(a,b){this.rw=a;this.rh=b};a.ComputedLength.prototype.toUsedLength=
function(a,b){return a*this.rw+b*this.rh};a.ComputedLength.prototype.multiply=function(a,b){return b?a*b:a};a.ComputedLength.prototype.isZero=function(){return 0===this.rw&&0===this.rh};a.toComputedLength=function(b,f,k,g,n,p){return"%"===f&&g?new a.ComputedLength(g.rw*b/100,g.rh*b/100):"em"===f&&k?new a.ComputedLength(k.rw*b,k.rh*b):"c"===f&&n?new a.ComputedLength(b*n.rw,b*n.rh):"px"===f&&p?new a.ComputedLength(b*p.rw,b*p.rh):"rh"===f?new a.ComputedLength(0,b/100):"rw"===f?new a.ComputedLength(b/
100,0):null}})("undefined"===typeof f?this.imscUtils={}:f)},{}]},{},[4])(4)});
