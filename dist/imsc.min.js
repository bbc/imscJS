var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.owns=function(c,q){return Object.prototype.hasOwnProperty.call(c,q)};$jscomp.assign="function"==typeof Object.assign?Object.assign:function(c,q){for(var g=1;g<arguments.length;g++){var b=arguments[g];if(b)for(var m in b)$jscomp.owns(b,m)&&(c[m]=b[m])}return c};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(c,q,g){c!=Array.prototype&&c!=Object.prototype&&(c[q]=g.value)};$jscomp.getGlobal=function(c){return"undefined"!=typeof window&&window===c?c:"undefined"!=typeof global&&null!=global?global:c};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.polyfill=function(c,q,g,b){if(q){g=$jscomp.global;c=c.split(".");for(b=0;b<c.length-1;b++){var m=c[b];m in g||(g[m]={});g=g[m]}c=c[c.length-1];b=g[c];q=q(b);q!=b&&null!=q&&$jscomp.defineProperty(g,c,{configurable:!0,writable:!0,value:q})}};$jscomp.polyfill("Object.assign",function(c){return c||$jscomp.assign},"es6","es3");$jscomp.polyfill("Object.entries",function(c){return c?c:function(c){var g=[],b;for(b in c)$jscomp.owns(c,b)&&g.push([b,c[b]]);return g}},"es8","es3");
$jscomp.polyfill("Math.sign",function(c){return c?c:function(c){c=Number(c);return 0===c||isNaN(c)?c:0<c?1:-1}},"es6","es3");$jscomp.checkEs6ConformanceViaProxy=function(){try{var c={},q=Object.create(new $jscomp.global.Proxy(c,{get:function(g,b,m){return g==c&&"q"==b&&m==q}}));return!0===q.q}catch(g){return!1}};$jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS=!1;$jscomp.ES6_CONFORMANCE=$jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS&&$jscomp.checkEs6ConformanceViaProxy();$jscomp.SYMBOL_PREFIX="jscomp_symbol_";
$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.Symbol=function(){var c=0;return function(q){return $jscomp.SYMBOL_PREFIX+(q||"")+c++}}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var c=$jscomp.global.Symbol.iterator;c||(c=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[c]&&$jscomp.defineProperty(Array.prototype,c,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};
$jscomp.initSymbolAsyncIterator=function(){$jscomp.initSymbol();var c=$jscomp.global.Symbol.asyncIterator;c||(c=$jscomp.global.Symbol.asyncIterator=$jscomp.global.Symbol("asyncIterator"));$jscomp.initSymbolAsyncIterator=function(){}};$jscomp.arrayIterator=function(c){var q=0;return $jscomp.iteratorPrototype(function(){return q<c.length?{done:!1,value:c[q++]}:{done:!0}})};
$jscomp.iteratorPrototype=function(c){$jscomp.initSymbolIterator();c={next:c};c[$jscomp.global.Symbol.iterator]=function(){return this};return c};$jscomp.makeIterator=function(c){$jscomp.initSymbolIterator();var q=c[Symbol.iterator];return q?q.call(c):$jscomp.arrayIterator(c)};
$jscomp.polyfill("WeakMap",function(c){function q(){if(!c||!Object.seal)return!1;try{var h=Object.seal({}),b=Object.seal({}),a=new c([[h,2],[b,3]]);if(2!=a.get(h)||3!=a.get(b))return!1;a.delete(h);a.set(b,4);return!a.has(h)&&4==a.get(b)}catch(l){return!1}}function g(h){$jscomp.owns(h,m)||$jscomp.defineProperty(h,m,{value:{}})}function b(h){var b=Object[h];b&&(Object[h]=function(a){g(a);return b(a)})}if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(c&&$jscomp.ES6_CONFORMANCE)return c}else if(q())return c;
var m="$jscomp_hidden_"+Math.random();b("freeze");b("preventExtensions");b("seal");var h=0,u=function(b){this.id_=(h+=Math.random()+1).toString();if(b){$jscomp.initSymbol();$jscomp.initSymbolIterator();b=$jscomp.makeIterator(b);for(var c;!(c=b.next()).done;)c=c.value,this.set(c[0],c[1])}};u.prototype.set=function(b,h){g(b);if(!$jscomp.owns(b,m))throw Error("WeakMap key fail: "+b);b[m][this.id_]=h;return this};u.prototype.get=function(b){return $jscomp.owns(b,m)?b[m][this.id_]:void 0};u.prototype.has=
function(b){return $jscomp.owns(b,m)&&$jscomp.owns(b[m],this.id_)};u.prototype.delete=function(b){return $jscomp.owns(b,m)&&$jscomp.owns(b[m],this.id_)?delete b[m][this.id_]:!1};return u},"es6","es3");$jscomp.MapEntry=function(){};
$jscomp.polyfill("Map",function(c){function q(){if($jscomp.ASSUME_NO_NATIVE_MAP||!c||"function"!=typeof c||!c.prototype.entries||"function"!=typeof Object.seal)return!1;try{var b=Object.seal({x:4}),a=new c($jscomp.makeIterator([[b,"s"]]));if("s"!=a.get(b)||1!=a.size||a.get({x:4})||a.set({x:4},"t")!=a||2!=a.size)return!1;var l=a.entries(),h=l.next();if(h.done||h.value[0]!=b||"s"!=h.value[1])return!1;h=l.next();return h.done||4!=h.value[0].x||"t"!=h.value[1]||!l.next().done?!1:!0}catch(n){return!1}}
if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(c&&$jscomp.ES6_CONFORMANCE)return c}else if(q())return c;$jscomp.initSymbol();$jscomp.initSymbolIterator();var g=new WeakMap,b=function(b){this.data_={};this.head_=u();this.size=0;if(b){b=$jscomp.makeIterator(b);for(var a;!(a=b.next()).done;)a=a.value,this.set(a[0],a[1])}};b.prototype.set=function(b,a){b=0===b?0:b;var l=m(this,b);l.list||(l.list=this.data_[l.id]=[]);l.entry?l.entry.value=a:(l.entry={next:this.head_,previous:this.head_.previous,head:this.head_,
key:b,value:a},l.list.push(l.entry),this.head_.previous.next=l.entry,this.head_.previous=l.entry,this.size++);return this};b.prototype.delete=function(b){b=m(this,b);return b.entry&&b.list?(b.list.splice(b.index,1),b.list.length||delete this.data_[b.id],b.entry.previous.next=b.entry.next,b.entry.next.previous=b.entry.previous,b.entry.head=null,this.size--,!0):!1};b.prototype.clear=function(){this.data_={};this.head_=this.head_.previous=u();this.size=0};b.prototype.has=function(b){return!!m(this,b).entry};
b.prototype.get=function(b){return(b=m(this,b).entry)&&b.value};b.prototype.entries=function(){return h(this,function(b){return[b.key,b.value]})};b.prototype.keys=function(){return h(this,function(b){return b.key})};b.prototype.values=function(){return h(this,function(b){return b.value})};b.prototype.forEach=function(b,a){for(var l=this.entries(),h;!(h=l.next()).done;)h=h.value,b.call(a,h[1],h[0],this)};b.prototype[Symbol.iterator]=b.prototype.entries;var m=function(b,a){var l=a&&typeof a;"object"==
l||"function"==l?g.has(a)?l=g.get(a):(l=""+ ++M,g.set(a,l)):l="p_"+a;var h=b.data_[l];if(h&&$jscomp.owns(b.data_,l))for(b=0;b<h.length;b++){var n=h[b];if(a!==a&&n.key!==n.key||a===n.key)return{id:l,list:h,index:b,entry:n}}return{id:l,list:h,index:-1,entry:void 0}},h=function(b,a){var l=b.head_;return $jscomp.iteratorPrototype(function(){if(l){for(;l.head!=b.head_;)l=l.previous;for(;l.next!=l.head;)return l=l.next,{done:!1,value:a(l)};l=null}return{done:!0,value:void 0}})},u=function(){var b={};return b.previous=
b.next=b.head=b},M=0;return b},"es6","es3");
$jscomp.polyfill("Set",function(c){function q(){if($jscomp.ASSUME_NO_NATIVE_SET||!c||"function"!=typeof c||!c.prototype.entries||"function"!=typeof Object.seal)return!1;try{var b=Object.seal({x:4}),m=new c($jscomp.makeIterator([b]));if(!m.has(b)||1!=m.size||m.add(b)!=m||1!=m.size||m.add({x:4})!=m||2!=m.size)return!1;var h=m.entries(),u=h.next();if(u.done||u.value[0]!=b||u.value[1]!=b)return!1;u=h.next();return u.done||u.value[0]==b||4!=u.value[0].x||u.value[1]!=u.value[0]?!1:h.next().done}catch(M){return!1}}
if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(c&&$jscomp.ES6_CONFORMANCE)return c}else if(q())return c;$jscomp.initSymbol();$jscomp.initSymbolIterator();var g=function(b){this.map_=new Map;if(b){b=$jscomp.makeIterator(b);for(var c;!(c=b.next()).done;)this.add(c.value)}this.size=this.map_.size};g.prototype.add=function(b){b=0===b?0:b;this.map_.set(b,b);this.size=this.map_.size;return this};g.prototype.delete=function(b){b=this.map_.delete(b);this.size=this.map_.size;return b};g.prototype.clear=
function(){this.map_.clear();this.size=0};g.prototype.has=function(b){return this.map_.has(b)};g.prototype.entries=function(){return this.map_.entries()};g.prototype.values=function(){return this.map_.values()};g.prototype.keys=g.prototype.values;g.prototype[Symbol.iterator]=g.prototype.values;g.prototype.forEach=function(b,c){var h=this;this.map_.forEach(function(m){return b.call(c,m,m,h)})};return g},"es6","es3");
(function(c){"object"===typeof exports&&"undefined"!==typeof module?module.exports=c():"function"===typeof define&&define.amd?define([],c):("undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:this).imsc=c()})(function(){return function(){function c(q,g,b){function m(u,H){if(!g[u]){if(!q[u]){var a="function"==typeof require&&require;if(!H&&a)return a(u,!0);if(h)return h(u,!0);H=Error("Cannot find module '"+u+"'");throw H.code="MODULE_NOT_FOUND",H;}H=
g[u]={exports:{}};q[u][0].call(H.exports,function(a){return m(q[u][1][a]||a)},H,H.exports,c,q,g,b)}return g[u].exports}for(var h="function"==typeof require&&require,u=0;u<b.length;u++)m(b[u]);return m}return c}()({1:[function(c,q,g){(function(b,c,h,u,g){function m(f,a){var d=f.styleAttrs&&f.styleAttrs["http://www.w3.org/ns/ttml#styling backgroundColor"];if("span"===f.kind)!d&&a&&(f.styleAttrs||(f.styleAttrs={}),f.styleAttrs["http://www.w3.org/ns/ttml#styling backgroundColor"]=a);else if(d&&delete f.styleAttrs["http://www.w3.org/ns/ttml#styling backgroundColor"],
f.contents)for(var e=0;e<f.contents.length;e++)m(f.contents[e],d||a)}function a(f){if("contents"in f){var d="styleAttrs"in f?f.styleAttrs[u.byName.ruby.qname]:null;d="span"===f.kind&&("container"===d||"textContainer"===d||"baseContainer"===d);for(var e=f.contents.length-1;0<=e;e--)!d||"styleAttrs"in f.contents[e]&&u.byName.ruby.qname in f.contents[e].styleAttrs?a(f.contents[e]):delete f.contents[e]}}function l(f,a,d,e){var b=e&&"seq"===e.timeContainer,k=0;e&&(k=b&&d?d.end:e.begin);a.begin=a.explicit_begin?
a.explicit_begin+k:k;d=a.begin;e=null;for(var B in a.sets)a.sets.hasOwnProperty(B)&&(l(f,a.sets[B],e,a),d="seq"===a.timeContainer?a.sets[B].end:Math.max(d,a.sets[B].end),e=a.sets[B]);if("contents"in a)for(var h in a.contents)a.contents.hasOwnProperty(h)&&(l(f,a.contents[h],e,a),d="seq"===a.timeContainer?a.contents[h].end:Math.max(d,a.contents[h].end),e=a.contents[h]);else d=b?a.begin:Number.POSITIVE_INFINITY;a.end=null!==a.explicit_end&&null!==a.explicit_dur?Math.min(a.begin+a.explicit_dur,k+a.explicit_end):
null===a.explicit_end&&null!==a.explicit_dur?a.begin+a.explicit_dur:null!==a.explicit_end&&null===a.explicit_dur?k+a.explicit_end:d;delete a.explicit_begin;delete a.explicit_dur;delete a.explicit_end;f._registerEvent(a)}function F(a){this.node=a}function n(){this.events=[];this.head=new p;this.body=null}function p(){this.styling=new C;this.layout=new z}function C(){this.styles={};this.initials={}}function t(){this.styleRefs=this.styleAttrs=this.id=null}function q(){this.styleAttrs=null}function z(){this.regions=
{}}function x(a,f){this.kind="image";this.src=a;this.type=f}function I(a){this.id=a}function f(a){this.regionID=a}function k(a){this.styleAttrs=a}function d(a){this.sets=a}function e(a){this.contents=a}function v(a,f,d){this.explicit_begin=a;this.explicit_end=f;this.explicit_dur=d}function S(){this.kind="body"}function P(){this.kind="div"}function y(){this.kind="p"}function E(){this.kind="span"}function r(){this.kind="span"}function D(){this.kind="br"}function N(){}function V(){}function A(a){var f=
null;a&&(a=a.attributes["xml:id"]||a.attributes.id)&&(f=a.value||null);return f}function w(a){return a&&"style"in a.attributes?a.attributes.style.value.split(" "):[]}function M(a,f){var d={};if(null!==a)for(var e in a.attributes)if(a.attributes.hasOwnProperty(e)){var b=a.attributes[e].uri+" "+a.attributes[e].local,l=u.byQName[b];if(void 0!==l){var k=l.parse(a.attributes[e].value);null!==k?(d[b]=k,l===u.byName.zIndex&&L(f,"zIndex attribute present but not used by IMSC1 since regions do not overlap")):
J(f,"Cannot parse styling attribute "+b+" --\x3e "+a.attributes[e].value)}}return d}function O(a,f,d){for(var e in a.attributes)if(a.attributes.hasOwnProperty(e)&&a.attributes[e].uri===f&&a.attributes[e].local===d)return a.attributes[e].value;return null}function Z(a,f){a=O(a,h.ns_tts,"extent");if(null===a)return null;var d=a.split(" ");if(2!==d.length)return L(f,"Malformed extent (ignoring)"),null;a=g.parseLength(d[0]);d=g.parseLength(d[1]);return d&&a?{h:d,w:a}:(L(f,"Malformed extent values (ignoring)"),
null)}function T(a,f,d){var e=/^(\d{2,}):(\d\d):(\d\d(?:\.\d+)?)$/,b=/^(\d{2,}):(\d\d):(\d\d):(\d{2,})$/,l=/^(\d+(?:\.\d+)?)t$/,k=/^(\d+(?:\.\d+)?)ms$/,h=/^(\d+(?:\.\d+)?)s$/,n=/^(\d+(?:\.\d+)?)h$/,c=/^(\d+(?:\.\d+)?)m$/,v,B=null;null!==(v=/^(\d+(?:\.\d+)?)f$/.exec(d))?null!==f&&(B=parseFloat(v[1])/f):null!==(v=l.exec(d))?null!==a&&(B=parseFloat(v[1])/a):null!==(v=k.exec(d))?B=parseFloat(v[1])/1E3:null!==(v=h.exec(d))?B=parseFloat(v[1]):null!==(v=n.exec(d))?B=3600*parseFloat(v[1]):null!==(v=c.exec(d))?
B=60*parseFloat(v[1]):null!==(v=e.exec(d))?B=3600*parseInt(v[1])+60*parseInt(v[2])+parseFloat(v[3]):null!==(v=b.exec(d))&&null!==f&&(B=3600*parseInt(v[1])+60*parseInt(v[2])+parseInt(v[3])+(null===v[4]?0:parseInt(v[4])/f));return B}function W(a,f,d){for(;0<f.styleRefs.length;){var e=f.styleRefs.pop();e in a.styles?(W(a,a.styles[e],d),U(a.styles[e].styleAttrs,f.styleAttrs)):J(d,"Non-existant style id referenced")}}function X(a,f,d,e){for(var b=f.length-1;0<=b;b--){var l=f[b];l in a.styles?U(a.styles[l].styleAttrs,
d):J(e,"Non-existant style id referenced")}}function U(a,f){for(var d in a)!a.hasOwnProperty(d)||d in f||(f[d]=a[d])}function L(a,f){if(a&&a.warn&&a.warn(f))throw f;}function J(a,f){if(a&&a.error&&a.error(f))throw f;}function G(a,f){a&&a.fatal&&a.fatal(f);throw f;}function Y(a,f){for(var d=0,e=a.length-1,b;d<=e;){b=Math.floor((d+e)/2);var l=a[b];if(l<f)d=b+1;else if(l>f)e=b-1;else return{found:!0,index:b}}return{found:!1,index:d}}b.fromXML=function(f,d,e){var b=c.parser(!0,{xmlns:!0}),k=[],v=[],B=
[],Q=0,g=null;b.onclosetag=function(a){if(k[0]instanceof N)null!==g.head&&null!==g.head.styling&&X(g.head.styling,k[0].styleRefs,k[0].styleAttrs,d),delete k[0].styleRefs;else if(k[0]instanceof C)for(var f in k[0].styles)k[0].styles.hasOwnProperty(f)&&W(k[0],k[0].styles[f],d);else if(k[0]instanceof y||k[0]instanceof E){if(1<k[0].contents.length){a=[k[0].contents[0]];for(f=1;f<k[0].contents.length;f++)k[0].contents[f]instanceof r&&a[a.length-1]instanceof r?a[a.length-1].text+=k[0].contents[f].text:
a.push(k[0].contents[f]);k[0].contents=a}k[0]instanceof E&&1===k[0].contents.length&&k[0].contents[0]instanceof r&&(k[0].text=k[0].contents[0].text,delete k[0].contents)}else if(k[0]instanceof F)if(k[0].node.uri===h.ns_tt&&"metadata"===k[0].node.local)Q--;else if(0<Q&&e&&"onCloseTag"in e)e.onCloseTag();B.shift();v.shift();k.shift()};b.ontext=function(a){if(void 0!==k[0])if(k[0]instanceof E||k[0]instanceof y){if(k[0]instanceof E){var f=k[0].styleAttrs[u.byName.ruby.qname];if("container"===f||"textContainer"===
f||"baseContainer"===f)return}f=new r;f.initFromText(g,k[0],a,B[0],d);k[0].contents.push(f)}else if(k[0]instanceof F&&0<Q&&e&&"onText"in e)e.onText(a)};b.onopentag=function(a){function f(a){h.ttaf_map[a.uri]&&(a.uri=h.ttaf_map[a.uri])}var b=a.attributes["xml:space"];b?B.unshift(b.value):0===B.length?B.unshift("default"):B.unshift(B[0]);(b=a.attributes["xml:lang"])?v.unshift(b.value):0===v.length?v.unshift(""):v.unshift(v[0]);f(a);if(a.attributes)for(var l in a.attributes)a.attributes.hasOwnProperty(l)&&
f(a.attributes[l]);if(a.uri===h.ns_tt)if("tt"===a.local)null!==g&&G(d,"Two <tt> elements at ("+this.line+","+this.column+")"),g=new n,g.initFromNode(a,d),k.unshift(g);else if("head"===a.local)k[0]instanceof n||G(d,"Parent of <head> element is not <tt> at ("+this.line+","+this.column+")"),k.unshift(g.head);else if("styling"===a.local)k[0]instanceof p||G(d,"Parent of <styling> element is not <head> at ("+this.line+","+this.column+")"),k.unshift(g.head.styling);else if("style"===a.local)if(k[0]instanceof
C){var c=new t;c.initFromNode(a,d);c.id?g.head.styling.styles[c.id]=c:J(d,"<style> element missing @id attribute");k.unshift(c)}else k[0]instanceof N?(c=new t,c.initFromNode(a,d),U(c.styleAttrs,k[0].styleAttrs),k.unshift(c)):G(d,"Parent of <style> element is not <styling> or <region> at ("+this.line+","+this.column+")");else if("initial"===a.local)if(k[0]instanceof C){l=new q;l.initFromNode(a,d);for(c in l.styleAttrs)l.styleAttrs.hasOwnProperty(c)&&(g.head.styling.initials[c]=l.styleAttrs[c]);k.unshift(l)}else G(d,
"Parent of <initial> element is not <styling> at ("+this.line+","+this.column+")");else if("layout"===a.local)k[0]instanceof p||G(d,"Parent of <layout> element is not <head> at "+this.line+","+this.column+")"),k.unshift(g.head.layout);else if("region"===a.local)k[0]instanceof z||G(d,"Parent of <region> element is not <layout> at "+this.line+","+this.column+")"),c=new N,c.initFromNode(g,a,d),!c.id||c.id in g.head.layout.regions?J(d,"Ignoring <region> with duplicate or missing @id at "+this.line+","+
this.column+")"):g.head.layout.regions[c.id]=c,k.unshift(c);else if("body"===a.local)k[0]instanceof n||G(d,"Parent of <body> element is not <tt> at "+this.line+","+this.column+")"),null!==g.body&&G(d,"Second <body> element at "+this.line+","+this.column+")"),c=new S,c.initFromNode(g,a,d),g.body=c,k.unshift(c);else if("div"===a.local){k[0]instanceof P||k[0]instanceof S||G(d,"Parent of <div> element is not <body> or <div> at "+this.line+","+this.column+")");c=new P;c.initFromNode(g,k[0],a,d);if(l=c.styleAttrs[u.byName.backgroundImage.qname])c.contents.push(new x(l)),
delete c.styleAttrs[u.byName.backgroundImage.qname];k[0].contents.push(c);k.unshift(c)}else"image"===a.local?(k[0]instanceof P||G(d,"Parent of <image> element is not <div> at "+this.line+","+this.column+")"),c=new x,c.initFromNode(g,k[0],a,d),k[0].contents.push(c),k.unshift(c)):"p"===a.local?(k[0]instanceof P||G(d,"Parent of <p> element is not <div> at "+this.line+","+this.column+")"),c=new y,c.initFromNode(g,k[0],a,d),k[0].contents.push(c),k.unshift(c)):"span"===a.local?(k[0]instanceof E||k[0]instanceof
y||G(d,"Parent of <span> element is not <span> or <p> at "+this.line+","+this.column+")"),c=new E,c.initFromNode(g,k[0],a,B[0],d),k[0].contents.push(c),k.unshift(c)):"br"===a.local?(k[0]instanceof E||k[0]instanceof y||G(d,"Parent of <br> element is not <span> or <p> at "+this.line+","+this.column+")"),c=new D,c.initFromNode(g,k[0],a,d),k[0].contents.push(c),k.unshift(c)):"set"===a.local?(k[0]instanceof E||k[0]instanceof y||k[0]instanceof P||k[0]instanceof S||k[0]instanceof N||k[0]instanceof D||G(d,
"Parent of <set> element is not a content element or a region at "+this.line+","+this.column+")"),c=new V,c.initFromNode(g,k[0],a,d),k[0].sets.push(c),k.unshift(c)):k.unshift(new F(a));else k.unshift(new F(a));if(k[0]instanceof F)if(a.uri===h.ns_tt&&"metadata"===a.local)Q++;else if(0<Q&&e&&"onOpenTag"in e){c=[];for(var m in a.attributes)a.attributes.hasOwnProperty(m)&&(c[a.attributes[m].uri+" "+a.attributes[m].local]={uri:a.attributes[m].uri,local:a.attributes[m].local,value:a.attributes[m].value});
e.onOpenTag(a.uri,a.local,c)}};b.write(f).close();delete g.head.styling.styles;f=!1;for(var R in g.head.layout.regions)if(g.head.layout.regions.hasOwnProperty(R)){f=!0;break}f||(R=N.prototype.createDefaultRegion(g,d),g.head.layout.regions[R.id]=R);for(var w in g.head.layout.regions)g.head.layout.regions.hasOwnProperty(w)&&l(g,g.head.layout.regions[w],null,null);g.body&&l(g,g.body,null,null);g.body&&a(g.body);g.body&&m(g.body);return g};n.prototype.initFromNode=function(a,f){var d=O(a,h.ns_ttp,"cellResolution"),
k=15;var e=32;null!==d&&(d=/(\d+) (\d+)/.exec(d),null!==d?(e=parseInt(d[1]),k=parseInt(d[2])):L(f,"Malformed cellResolution value (using initial value instead)"));this.cellLength={h:new g.ComputedLength(0,1/k),w:new g.ComputedLength(1/e,0)};k=O(a,h.ns_ttp,"frameRate");d=30;null!==k&&(e=/(\d+)/.exec(k),null!==e?d=parseInt(e[1]):L(f,"Malformed frame rate attribute (using initial value instead)"));e=O(a,h.ns_ttp,"frameRateMultiplier");var b=1;null!==e&&(e=/(\d+) (\d+)/.exec(e),null!==e?b=parseInt(e[1])/
parseInt(e[2]):L(f,"Malformed frame rate multiplier attribute (using initial value instead)"));d*=b;b=1;e=O(a,h.ns_ttp,"tickRate");null===e?null!==k&&(b=d):(e=/(\d+)/.exec(e),null!==e?b=parseInt(e[1]):L(f,"Malformed tick rate attribute (using initial value instead)"));this.effectiveFrameRate=d;this.tickRate=b;e=O(a,h.ns_ittp,"aspectRatio");null===e&&(e=O(a,h.ns_ttp,"displayAspectRatio"));k=null;null!==e&&(d=/(\d+)\s+(\d+)/.exec(e),null!==d?(e=parseInt(d[1]),d=parseInt(d[2]),0!==e&&0!==d?k=e/d:J(f,
"Illegal aspectRatio values (ignoring)")):J(f,"Malformed aspectRatio attribute (ignoring)"));this.aspectRatio=k;k=O(a,h.ns_ttp,"timeBase");null!==k&&"media"!==k&&G(f,"Unsupported time base");a=Z(a,f);null===a?this.pxLength={h:null,w:null}:("px"===a.h.unit&&"px"===a.w.unit||G(f,"Extent on TT must be in px or absent"),this.pxLength={h:new g.ComputedLength(0,1/a.h.value),w:new g.ComputedLength(1/a.w.value,0)});this.dimensions={h:new g.ComputedLength(0,1),w:new g.ComputedLength(1,0)}};n.prototype._registerEvent=
function(a){if(!(a.end<=a.begin)){var f=Y(this.events,a.begin);f.found||this.events.splice(f.index,0,a.begin);a.end!==Number.POSITIVE_INFINITY&&(f=Y(this.events,a.end),f.found||this.events.splice(f.index,0,a.end))}};n.prototype.getMediaTimeRange=function(){return[this.events[0],this.events[this.events.length-1]]};n.prototype.getMediaTimeEvents=function(){return this.events};t.prototype.initFromNode=function(a,f){this.id=A(a);this.styleAttrs=M(a,f);this.styleRefs=w(a)};q.prototype.initFromNode=function(a,
f){this.styleAttrs={};for(var d in a.attributes)!a.attributes.hasOwnProperty(d)||a.attributes[d].uri!==h.ns_itts&&a.attributes[d].uri!==h.ns_ebutts&&a.attributes[d].uri!==h.ns_tts||(this.styleAttrs[a.attributes[d].uri+" "+a.attributes[d].local]=a.attributes[d].value)};x.prototype.initFromNode=function(a,e,b,l){(this.src="src"in b.attributes?b.attributes.src.value:null)||J(l,"Invalid image@src attribute");(this.type="type"in b.attributes?b.attributes.type.value:null)||J(l,"Invalid image@type attribute");
k.prototype.initFromNode.call(this,a,e,b,l);v.prototype.initFromNode.call(this,a,e,b,l);d.prototype.initFromNode.call(this,a,e,b,l);f.prototype.initFromNode.call(this,a,e,b,l)};I.prototype.initFromNode=function(a,f,d,e){this.id=A(d)};f.prototype.initFromNode=function(a,f,d,e){this.regionID=d&&"region"in d.attributes?d.attributes.region.value:""};k.prototype.initFromNode=function(a,f,d,e){this.styleAttrs=M(d,e);null!==a.head&&null!==a.head.styling&&X(a.head.styling,w(d),this.styleAttrs,e)};d.prototype.initFromNode=
function(a,f,d,e){this.sets=[]};e.prototype.initFromNode=function(a,f,d,e){this.contents=[]};v.prototype.initFromNode=function(a,f,d,e){f=null;d&&"begin"in d.attributes&&(f=T(a.tickRate,a.effectiveFrameRate,d.attributes.begin.value),null===f&&L(e,"Malformed begin value "+d.attributes.begin.value+" (using 0)"));var k=null;d&&"dur"in d.attributes&&(k=T(a.tickRate,a.effectiveFrameRate,d.attributes.dur.value),null===k&&L(e,"Malformed dur value "+d.attributes.dur.value+" (ignoring)"));var b=null;d&&"end"in
d.attributes&&(b=T(a.tickRate,a.effectiveFrameRate,d.attributes.end.value),null===b&&L(e,"Malformed end value (ignoring)"));this.explicit_begin=f;this.explicit_end=b;this.explicit_dur=k;(a=d&&"timeContainer"in d.attributes?d.attributes.timeContainer.value:null)&&"par"!==a?"seq"===a?e="seq":(J(e,"Illegal value of timeContainer (assuming 'par')"),e="par"):e="par";this.timeContainer=e};S.prototype.initFromNode=function(a,b,l){k.prototype.initFromNode.call(this,a,null,b,l);v.prototype.initFromNode.call(this,
a,null,b,l);d.prototype.initFromNode.call(this,a,null,b,l);f.prototype.initFromNode.call(this,a,null,b,l);e.prototype.initFromNode.call(this,a,null,b,l)};P.prototype.initFromNode=function(a,b,l,c){k.prototype.initFromNode.call(this,a,b,l,c);v.prototype.initFromNode.call(this,a,b,l,c);d.prototype.initFromNode.call(this,a,b,l,c);f.prototype.initFromNode.call(this,a,b,l,c);e.prototype.initFromNode.call(this,a,b,l,c)};y.prototype.initFromNode=function(a,b,l,c){k.prototype.initFromNode.call(this,a,b,l,
c);v.prototype.initFromNode.call(this,a,b,l,c);d.prototype.initFromNode.call(this,a,b,l,c);f.prototype.initFromNode.call(this,a,b,l,c);e.prototype.initFromNode.call(this,a,b,l,c)};E.prototype.initFromNode=function(a,b,l,c,h){k.prototype.initFromNode.call(this,a,b,l,h);v.prototype.initFromNode.call(this,a,b,l,h);d.prototype.initFromNode.call(this,a,b,l,h);f.prototype.initFromNode.call(this,a,b,l,h);e.prototype.initFromNode.call(this,a,b,l,h);this.space=c};r.prototype.initFromText=function(a,f,d,e,
k){v.prototype.initFromNode.call(this,a,f,null,k);this.text=d;this.space=e};D.prototype.initFromNode=function(a,d,e,k){f.prototype.initFromNode.call(this,a,d,e,k);v.prototype.initFromNode.call(this,a,d,e,k)};N.prototype.createDefaultRegion=function(a,f){var d=new N;d.id="";k.prototype.initFromNode.call(d,a,null,{name:"region",attributes:{"tts:displayAlign":{name:"tts:displayAlign",value:"after",prefix:"tts",local:"displayAlign",uri:"http://www.w3.org/ns/ttml#styling"},"tts:extent":{name:"tts:extent",
value:"80% 20%",prefix:"tts",local:"extent",uri:"http://www.w3.org/ns/ttml#styling"},"tts:origin":{name:"tts:origin",value:"10% 70%",prefix:"tts",local:"origin",uri:"http://www.w3.org/ns/ttml#styling"},"tts:overflow":{name:"tts:overflow",value:"visible",prefix:"tts",local:"overflow",uri:"http://www.w3.org/ns/ttml#styling"}},ns:{"":"http://www.w3.org/ns/ttml",ebuttm:"urn:ebu:tt:metadata",ebutts:"urn:ebu:tt:style",ittp:"http://www.w3.org/ns/ttml/profile/imsc1#parameter",itts:"http://www.w3.org/ns/ttml/profile/imsc1#styling",
ttm:"http://www.w3.org/ns/ttml#metadata",ttp:"http://www.w3.org/ns/ttml#parameter",tts:"http://www.w3.org/ns/ttml#styling",xml:"http://www.w3.org/XML/1998/namespace"},prefix:"",local:"region",uri:"http://www.w3.org/ns/ttml",isSelfClosing:!0},f);d.sets=[];v.call(d,0,Number.POSITIVE_INFINITY,null);return d};N.prototype.initFromNode=function(a,f,e){I.prototype.initFromNode.call(this,a,null,f,e);v.prototype.initFromNode.call(this,a,null,f,e);d.prototype.initFromNode.call(this,a,null,f,e);this.styleAttrs=
M(f,e);this.styleRefs=w(f)};V.prototype.initFromNode=function(a,f,d,e){v.prototype.initFromNode.call(this,a,f,d,e);a=M(d,e);this.value=this.qname=null;for(var k in a)if(a.hasOwnProperty(k)){if(this.qname){J(e,"More than one style specified on set");break}this.qname=k;this.value=a[k]}}})("undefined"===typeof g?this.imscDoc={}:g,"undefined"===typeof sax?c("sax"):sax,"undefined"===typeof imscNames?c("./names"):imscNames,"undefined"===typeof imscStyles?c("./styles"):imscStyles,"undefined"===typeof imscUtils?
c("./utils"):imscUtils)},{"./names":5,"./styles":6,"./utils":7,sax:void 0}],2:[function(c,q,g){(function(b,c,h,g){function m(a){var f={};a=Object.entries(a);for(var d in a)if(a.hasOwnProperty(d)){var e=g.parseColor(a[d][0]),b=g.parseColor(a[d][1]);e&&b&&(f[e.toString()]=b)}return f}function u(f,k,d){if("region"===d.kind){var e=document.createElement("div");e.style.position="absolute"}else if("body"===d.kind)e=document.createElement("div");else if("div"===d.kind)e=document.createElement("div");else if("image"===
d.kind){if(e=document.createElement("img"),null!==f.imgResolver&&null!==d.src){var b=f.imgResolver(d.src,e);b&&(e.src=b);e.height=f.regionH;e.width=f.regionW}}else if("p"===d.kind)e=document.createElement("p");else if("span"===d.kind)if("container"===d.styleAttrs[h.byName.ruby.qname])e=document.createElement("ruby"),f.ruby=!0;else if("base"===d.styleAttrs[h.byName.ruby.qname])e=document.createElement("rb");else if("text"===d.styleAttrs[h.byName.ruby.qname])e=document.createElement("rt");else if("baseContainer"===
d.styleAttrs[h.byName.ruby.qname])e=document.createElement("rbc");else if("textContainer"===d.styleAttrs[h.byName.ruby.qname])e=document.createElement("rtc");else{if("delimiter"===d.styleAttrs[h.byName.ruby.qname])return;e=document.createElement("span")}else"br"===d.kind&&(e=document.createElement("br"));if(e){k.appendChild(e);e.style.margin="0";if("region"===d.kind)if(k=d.styleAttrs[h.byName.writingMode.qname],"lrtb"===k||"lr"===k)f.ipd="lr",f.bpd="tb";else if("rltb"===k||"rl"===k)f.ipd="rl",f.bpd=
"tb";else if("tblr"===k)f.ipd="tb",f.bpd="lr";else{if("tbrl"===k||"tb"===k)f.ipd="tb",f.bpd="rl"}else"p"===d.kind&&"tb"===f.bpd&&(f.ipd="ltr"===d.styleAttrs[h.byName.direction.qname]?"lr":"rl");for(var c in C)C.hasOwnProperty(c)&&(k=C[c],b=d.styleAttrs[k.qname],void 0!==b&&null!==k.map&&k.map(f,e,d,b));c=e;(k=d.styleAttrs[h.byName.linePadding.qname])&&!k.isZero()&&(b=k.multiply(k.toUsedLength(f.w,f.h),f.options.sizeAdjust),0<b&&(b=Math.ceil(b)+"px","tb"===f.bpd?(c.style.paddingLeft=b,c.style.paddingRight=
b):(c.style.paddingTop=b,c.style.paddingBottom=b),f.removePaddingElement=c,f.lp=k));(k=d.styleAttrs[h.byName.multiRowAlign.qname])&&"auto"!==k&&(c=document.createElement("span"),c.style.display="inline-block",c.style.textAlign=k,e.appendChild(c),f.mra=k);(k=d.styleAttrs[h.byName.rubyReserve.qname])&&"none"!==k[0]&&(f.rubyReserve=k);d.styleAttrs[h.byName.fillLineGap.qname]&&(f.flg=!0);if("span"===d.kind&&d.text)if((k=d.styleAttrs[h.byName.textEmphasis.qname])&&"none"!==k.style&&(f.textEmphasis=!0),
h.byName.textCombine.qname in d.styleAttrs&&"all"===d.styleAttrs[h.byName.textCombine.qname][0])e.textContent=d.text,k&&n(f,e,d,k);else{b="";for(var g=0;g<d.text.length;g++){b+=d.text.charAt(g);var p=d.text.charCodeAt(g);if(55296>p||56319<p||g===d.text.length-1)p=document.createElement("span"),p.textContent=b,k&&n(f,p,d,k),e.appendChild(p),b=""}}for(var m in d.contents)d.contents.hasOwnProperty(m)&&u(f,c,d.contents[m]);m=[];if((f.lp||f.mra||f.flg||f.ruby||f.textEmphasis||f.rubyReserve)&&"p"===d.kind){F(f,
c,m,null);if(f.rubyReserve){for(k=0;k<m.length;k++){b=document.createElement("ruby");g=document.createElement("rb");g.textContent="\u200b";b.appendChild(g);var r=f.rubyReserve[1].toUsedLength(f.w,f.h)+"px";"both"===f.rubyReserve[0]||"outside"===f.rubyReserve[0]&&1==m.length?(g=document.createElement("rtc"),g.style[z]=K?"after":"under",g.textContent="\u200b",g.style.fontSize=r,p=document.createElement("rtc"),p.style[z]=K?"before":"over",p.textContent="\u200b",p.style.fontSize=r,b.appendChild(g),b.appendChild(p)):
(g=document.createElement("rtc"),g.textContent="\u200b",g.style.fontSize=r,g.style[z]="after"===f.rubyReserve[0]||"outside"===f.rubyReserve[0]&&0<k?K?"after":"tb"===f.bpd||"rl"===f.bpd?"under":"over":K?"before":"tb"===f.bpd||"rl"===f.bpd?"over":"under",b.appendChild(g));g=null;for(p=0;p<m[k].rbc.length;p++)if("ruby"===m[k].rbc[p].localName){g=m[k].rbc[p];for(p=0;p<g.style.length;p++)b.style.setProperty(g.style.item(p),g.style.getPropertyValue(g.style.item(p)));break}g=g||m[k].elements[0].node;g.parentElement.insertBefore(b,
g)}f.rubyReserve=null}if(f.ruby||f.rubyReserve){for(k=0;k<m.length;k++)for(b=0;b<m[k].rbc.length;b++)m[k].rbc[b].style[z]||(m[k].rbc[b].style[z]=K?0===k?"before":"after":"tb"===f.bpd?0===k?"over":"under":"rl"===f.bpd?0===k?"over":"under":0===k?"under":"over");f.ruby=null}if(f.textEmphasis){for(k=0;k<m.length;k++)for(b=0;b<m[k].te.length;b++)m[k].te[b].style[I]&&"none"!==m[k].te[b].style[I]||(m[k].te[b].style[I]="tb"===f.bpd?0===k?"left over":"left under":"rl"===f.bpd?0===k?"right under":"left under":
0===k?"left under":"right under");f.textEmphasis=null}if(f.mra){for(k=0;k<m.length-1;k++)g=m[k].elements.length,0!==g&&!1===m[k].br&&(b=document.createElement("br"),g=m[k].elements[g-1].node,g.parentElement.insertBefore(b,g.nextSibling));f.mra=null}if(f.lp){k=f.lp.multiply(f.lp.toUsedLength(f.w,f.h),f.options.sizeAdjust);for(b=0;b<m.length;b++){g=m[b].elements[m[b].start_elem];p=m[b].elements[m[b].end_elem];r=Math.ceil(k)+"px";var q="-"+Math.ceil(k)+"px";0!==m[b].elements.length&&("lr"===f.ipd?g.node.style.paddingLeft=
r:"rl"===f.ipd?(g.node.style.borderRightColor=g.bgcolor||"#00000000",g.node.style.borderRightStyle="solid",g.node.style.borderRightWidth=r,g.node.style.marginRight=q):"tb"===f.ipd&&(g.node.style.borderTopColor=g.bgcolor||"#00000000",g.node.style.borderTopStyle="solid",g.node.style.borderTopWidth=r,g.node.style.marginTop=q),"lr"===f.ipd?p.node.style.paddingRight=r:"rl"===f.ipd?(p.node.style.borderLeftColor=p.bgcolor||"#00000000",p.node.style.borderLeftStyle="solid",p.node.style.borderLeftWidth=r,p.node.style.marginLeft=
q):"tb"===f.ipd&&(p.node.style.borderBottomColor=p.bgcolor||"#00000000",p.node.style.borderBottomStyle="solid",p.node.style.borderBottomWidth=r,p.node.style.marginBottom=q))}"tb"===f.bpd?(f.removePaddingElement.style.paddingLeft=0,f.removePaddingElement.style.paddingRight=0):(f.removePaddingElement.style.paddingTop=0,f.removePaddingElement.style.paddingBottom=0);f.lp=null}if(f.flg){b=l(c.getBoundingClientRect(),f);k=b.before;b=b.after;g=c;p=Math.sign(b-k);for(r=0;r<=m.length;r++){q=0;var x=0===r?
k:r===m.length?b:Math.abs(m[r].end-m[r].start)>Math.abs(m[r-1].end-m[r-1].start)?m[r].before:m[r-1].after+q;var t;if(0<r){for(t=0;t<m[r-1].elements.length;t++)if(null!==m[r-1].elements[t].bgcolor){var A=m[r-1].elements[t];0>p*(A.after-x)&&(A=Math.abs(x-A.after),A>q&&(q=A))}var w=g.getElementsByTagName("span")[r];if(m[r]&&w.childElementCount!=m[r].elements.length)for(t=0;t<m[r-1].elements.length;t++)w=m[r-1].elements[t],A=q+"px solid "+w.bgcolor,"lr"===f.bpd?w.node.style.borderRight=A:"rl"===f.bpd?
w.node.style.borderLeft=A:"tb"===f.bpd&&(w.node.style.borderBottom=A);else""==w.style.borderBottom&&("lr"===f.bpd?w.style.paddingRight=q+"px":"rl"===f.bpd?w.style.paddingLeft=q+"px":"tb"===f.bpd&&(w.style.paddingBottom=q+"px"))}if(r<m.length){for(t=q=0;t<m[r].elements.length;t++)A=m[r].elements[t],null!==A.bgcolor&&0<p*(A.before-x)&&(A=Math.abs(A.before-x),A>q&&(q=A));w=g.getElementsByTagName("span")[r];if(w.childElementCount==m[r].elements.length)"lr"===f.bpd?w.style.paddingLeft=q+"px":"rl"===f.bpd?
w.style.paddingRight=q+"px":"tb"===f.bpd&&(w.style.paddingTop=q+"px");else for(t=0;t<m[r].elements.length;t++)w=m[r].elements[t],A=q+"px solid "+w.bgcolor,"lr"===f.bpd?w.node.style.borderLeft=A:"rl"===f.bpd?w.node.style.borderRight=A:"tb"===f.bpd&&(w.node.style.borderTop=A)}}f.flg=null}}"region"===d.kind&&"tb"===f.bpd&&f.enableRollUp&&0<d.contents.length&&"after"===d.styleAttrs[h.byName.displayAlign.qname]&&(F(f,c,m,null),d=new a(""===d.id?"_":d.id,m),f.currentISDState[d.id]=d,f.previousISDState&&
d.id in f.previousISDState&&0<f.previousISDState[d.id].plist.length&&1<d.plist.length&&d.plist[d.plist.length-2].text===f.previousISDState[d.id].plist[f.previousISDState[d.id].plist.length-1].text&&(f=e.firstElementChild,d=d.plist[d.plist.length-1].after-d.plist[d.plist.length-1].before,f.style.bottom="-"+d+"px",f.style.transition="transform 0.4s",f.style.position="relative",f.style.transform="translateY(-"+d+"px)"))}else if(f=f.errorHandler,d="Error processing ISD element kind: "+d.kind,f&&f.error&&
f.error(d))throw d;}function a(a,b){this.id=a;this.plist=b}function l(a,b){var d={before:null,after:null,start:null,end:null};"tb"===b.bpd?(d.before=a.top,d.after=a.bottom,"lr"===b.ipd?(d.start=a.left,d.end=a.right):(d.start=a.right,d.end=a.left)):"lr"===b.bpd?(d.before=a.left,d.after=a.right,d.start=a.top,d.end=a.bottom):"rl"===b.bpd&&(d.before=a.right,d.after=a.left,d.start=a.top,d.end=a.bottom);return d}function F(a,b,d,e){if("rt"!==b.localName&&"rtc"!==b.localName)if(e=b.style.backgroundColor||
e,0===b.childElementCount)if("span"===b.localName||"rb"===b.localName){var f=b.getBoundingClientRect();if(0!==f.height&&0!==f.width){a=l(f,a);if(!(f=0===d.length)){f=a.before;var k=a.after,c=d[d.length-1].before,h=d[d.length-1].after;f=!(k<h&&f>c||h<=k&&c>=f)}f?d.push({before:a.before,after:a.after,start:a.start,end:a.end,start_elem:0,end_elem:0,elements:[],rbc:[],te:[],text:"",br:!1}):(f=Math.sign(a.after-a.before),k=Math.sign(a.end-a.start),0>f*(a.before-d[d.length-1].before)&&(d[d.length-1].before=
a.before),0<f*(a.after-d[d.length-1].after)&&(d[d.length-1].after=a.after),0>k*(a.start-d[d.length-1].start)&&(d[d.length-1].start=a.start,d[d.length-1].start_elem=d[d.length-1].elements.length),0<k*(a.end-d[d.length-1].end)&&(d[d.length-1].end=a.end,d[d.length-1].end_elem=d[d.length-1].elements.length));d[d.length-1].text+=b.textContent;d[d.length-1].elements.push({node:b,bgcolor:e,before:a.before,after:a.after})}}else"br"===b.localName&&0!==d.length&&(d[d.length-1].br=!0);else for(b=b.firstChild;b;)b.nodeType===
Node.ELEMENT_NODE&&(F(a,b,d,e),"ruby"===b.localName||"rtc"===b.localName?0<d.length&&d[d.length-1].rbc.push(b):"span"===b.localName&&b.style[x]&&"none"!==b.style[x]&&0<d.length&&d[d.length-1].te.push(b)),b=b.nextSibling}function n(a,b,d,e){if("none"===e.style)b.style[x]="none";else if(b.style[x]="auto"===e.style?"filled":e.style+" "+e.symbol,"before"===e.position||"after"===e.position)b.style[I]="tb"===a.bpd?"before"===e.position?"left over":"left under":"rl"===a.bpd?"before"===e.position?"right under":
"left under":"before"===e.position?"left under":"right under"}function p(a,b){this.qname=a;this.map=b}b.render=function(a,b,d,e,l,c,h,g,n,p){e=e||b.clientHeight;var f=l||b.clientWidth;null!==a.aspectRatio&&(l=e*a.aspectRatio,l>f?e=Math.round(f/a.aspectRatio):f=l);l=document.createElement("div");l.style.position="relative";l.style.width=f+"px";l.style.height=e+"px";l.style.margin="auto";l.style.top=0;l.style.bottom=0;l.style.left=0;l.style.right=0;l.style.zIndex=0;d={h:e,w:f,regionH:null,regionW:null,
imgResolver:d,displayForcedOnlyMode:c||!1,isd:a,errorHandler:h,previousISDState:g,enableRollUp:n||!1,currentISDState:{},flg:null,lp:null,mra:null,ipd:null,bpd:null,ruby:null,textEmphasis:null,rubyReserve:null,options:Object.assign({},p)||{}};d.options.colorAdjust&&(d.options.colorAdjust=m(d.options.colorAdjust));c=["region","body","div","p","span"];for(var k in c)c.hasOwnProperty(k)&&(h=c[k]+"BackgroundColorAdjust",d.options[h]&&(d.options[h]=m(d.options[h])));b.appendChild(l);for(var F in a.contents)a.contents.hasOwnProperty(F)&&
u(d,l,a.contents[F]);return d.currentISDState};var C=[new p("http://www.w3.org/ns/ttml#styling backgroundColor",function(a,b,d,e){(d=(d=a.options[d.kind+"BackgroundColorAdjust"])&&d[e.toString()])&&(e=d);d=e[3];0!==d&&(void 0!=a.options.backgroundOpacityScale&&(d*=a.options.backgroundOpacityScale),b.style.backgroundColor="rgba("+e[0].toString()+","+e[1].toString()+","+e[2].toString()+","+(d/255).toString()+")")}),new p("http://www.w3.org/ns/ttml#styling color",function(a,b,d,e){d=a.options.colorOpacityScale||
1;a=a.options.colorAdjust;void 0!=a&&(a=a[e.toString()])&&(e=a);b.style.color="rgba("+e[0].toString()+","+e[1].toString()+","+e[2].toString()+","+(d*e[3]/255).toString()+")"}),new p("http://www.w3.org/ns/ttml#styling direction",function(a,b,d,e){b.style.direction=e}),new p("http://www.w3.org/ns/ttml#styling display",function(a,b,d,e){}),new p("http://www.w3.org/ns/ttml#styling displayAlign",function(a,b,d,e){b.style.display="flex";b.style.flexDirection="column";"before"===e?b.style.justifyContent=
"flex-start":"center"===e?b.style.justifyContent="center":"after"===e&&(b.style.justifyContent="flex-end")}),new p("http://www.w3.org/ns/ttml#styling extent",function(a,b,d,e){a.regionH=e.h.toUsedLength(a.w,a.h);a.regionW=e.w.toUsedLength(a.w,a.h);var f=e=0;if(d=d.styleAttrs["http://www.w3.org/ns/ttml#styling padding"])e=d[0].toUsedLength(a.w,a.h)+d[2].toUsedLength(a.w,a.h),f=d[1].toUsedLength(a.w,a.h)+d[3].toUsedLength(a.w,a.h);b.style.height=a.regionH-e+"px";b.style.width=a.regionW-f+"px"}),new p("http://www.w3.org/ns/ttml#styling fontFamily",
function(a,b,d,e){d=[];a.options.fontFamily&&(e=a.options.fontFamily.split(","));for(var f in e)e[f].hasOwnProperty(f)&&(e[f]=e[f].trim(),"monospaceSerif"===e[f]?(d.push("Courier New"),d.push('"Liberation Mono"'),d.push("Courier"),d.push("monospace")):"proportionalSansSerif"===e[f]||"default"===e[f]?(d.push("Arial"),d.push("Helvetica"),d.push('"Liberation Sans"'),d.push("sans-serif")):"monospace"===e[f]?d.push("monospace"):"sansSerif"===e[f]?d.push("sans-serif"):"serif"===e[f]?d.push("serif"):"monospaceSansSerif"===
e[f]?(d.push("Consolas"),d.push("monospace")):"proportionalSerif"===e[f]?d.push("serif"):d.push(e[f]));if(0<d.length){a=[d[0]];for(e=1;e<d.length;e++)-1==a.indexOf(d[e])&&a.push(d[e]);d=a}b.style.fontFamily=d.join(",")}),new p("http://www.w3.org/ns/ttml#styling shear",function(a,b,d,e){0!==e&&(d=-.9*e,b.style.transform="tb"===a.bpd?"skewX("+d+"deg)":"skewY("+d+"deg)")}),new p("http://www.w3.org/ns/ttml#styling fontSize",function(a,b,d,e){b.style.fontSize=e.multiply(e.toUsedLength(a.w,a.h),a.options.sizeAdjust)+
"px"}),new p("http://www.w3.org/ns/ttml#styling fontStyle",function(a,b,d,e){b.style.fontStyle=e}),new p("http://www.w3.org/ns/ttml#styling fontWeight",function(a,b,d,e){b.style.fontWeight=e}),new p("http://www.w3.org/ns/ttml#styling lineHeight",function(a,b,d,e){b.style.lineHeight="normal"===e?"normal":e.multiply(e.multiply(e.toUsedLength(a.w,a.h),a.options.sizeAdjust),a.options.lineHeightAdjust)+"px"}),new p("http://www.w3.org/ns/ttml#styling opacity",function(a,b,d,e){d=e;void 0!=a.options.regionOpacityScale&&
(d*=a.options.regionOpacityScale);b.style.opacity=d}),new p("http://www.w3.org/ns/ttml#styling origin",function(a,b,d,e){b.style.top=e.h.toUsedLength(a.w,a.h)+"px";b.style.left=e.w.toUsedLength(a.w,a.h)+"px"}),new p("http://www.w3.org/ns/ttml#styling overflow",function(a,b,d,e){b.style.overflow=e}),new p("http://www.w3.org/ns/ttml#styling padding",function(a,b,d,e){d=[];d[0]=e[0].toUsedLength(a.w,a.h)+"px";d[1]=e[3].toUsedLength(a.w,a.h)+"px";d[2]=e[2].toUsedLength(a.w,a.h)+"px";d[3]=e[1].toUsedLength(a.w,
a.h)+"px";b.style.padding=d.join(" ")}),new p("http://www.w3.org/ns/ttml#styling position",function(a,b,d,e){b.style.top=e.h.toUsedLength(a.w,a.h)+"px";b.style.left=e.w.toUsedLength(a.w,a.h)+"px"}),new p("http://www.w3.org/ns/ttml#styling rubyAlign",function(a,b,d,e){b.style.rubyAlign="spaceAround"===e?"space-around":"center"}),new p("http://www.w3.org/ns/ttml#styling rubyPosition",function(a,b,d,e){if("before"===e||"after"===e)b.parentElement.style[z]=K?e:"tb"===a.bpd?"before"===e?"over":"under":
"rl"===a.bpd?"before"===e?"over":"under":"before"===e?"under":"over"}),new p("http://www.w3.org/ns/ttml#styling showBackground",null),new p("http://www.w3.org/ns/ttml#styling textAlign",function(a,b,d,e){b.style.textAlign="start"===e?"rl"===a.ipd?"right":"left":"end"===e?"rl"===a.ipd?"left":"right":e}),new p("http://www.w3.org/ns/ttml#styling textDecoration",function(a,b,d,e){b.style.textDecoration=e.join(" ").replace("lineThrough","line-through")}),new p("http://www.w3.org/ns/ttml#styling textOutline",
function(a,b,d,e){}),new p("http://www.w3.org/ns/ttml#styling textShadow",function(a,b,d,e){d=d.styleAttrs[h.byName.textOutline.qname];var f=a.options.textOutline;if(f)if("none"===f)d=f;else{var l={};f=f.split(" ");if(0!==f.length&&2>=f.length){var k=g.parseColor(f[0]);l.color=k;null!==k&&f.shift();1===f.length&&(f=g.parseLength(f[0]))&&(l.thickness=f,d=l)}}if("none"===e&&"none"===d)b.style.textShadow="";else{l=[];"none"!==d&&(d="rgba("+d.color[0].toString()+","+d.color[1].toString()+","+d.color[2].toString()+
","+(d.color[3]/255).toString()+")",l.push("1px 1px 1px "+d),l.push("-1px 1px 1px "+d),l.push("1px -1px 1px "+d),l.push("-1px -1px 1px "+d));if("none"!==e)for(var c in e)e.hasOwnProperty(c)&&l.push(e[c].x_off.toUsedLength(a.w,a.h)+"px "+e[c].y_off.toUsedLength(a.w,a.h)+"px "+e[c].b_radius.toUsedLength(a.w,a.h)+"px rgba("+e[c].color[0].toString()+","+e[c].color[1].toString()+","+e[c].color[2].toString()+","+(e[c].color[3]/255).toString()+")");b.style.textShadow=l.join(",")}}),new p("http://www.w3.org/ns/ttml#styling textCombine",
function(a,b,d,e){b.style.textCombineUpright=e.join(" ")}),new p("http://www.w3.org/ns/ttml#styling textEmphasis",function(a,b,d,e){}),new p("http://www.w3.org/ns/ttml#styling unicodeBidi",function(a,b,d,e){b.style.unicodeBidi="bidiOverride"===e?"bidi-override":e}),new p("http://www.w3.org/ns/ttml#styling visibility",function(a,b,d,e){b.style.visibility=e}),new p("http://www.w3.org/ns/ttml#styling wrapOption",function(a,b,d,e){b.style.whiteSpace="wrap"===e?"preserve"===d.space?"pre-wrap":"normal":
"preserve"===d.space?"pre":"noWrap"}),new p("http://www.w3.org/ns/ttml#styling writingMode",function(a,b,d,e){if("lrtb"===e||"lr"===e)b.style.writingMode="horizontal-tb";else if("rltb"===e||"rl"===e)b.style.writingMode="horizontal-tb";else if("tblr"===e)b.style.writingMode="vertical-lr";else if("tbrl"===e||"tb"===e)b.style.writingMode="vertical-rl"}),new p("http://www.w3.org/ns/ttml#styling zIndex",function(a,b,d,e){b.style.zIndex=e}),new p("http://www.w3.org/ns/ttml/profile/imsc1#styling forcedDisplay",
function(a,b,d,e){a.displayForcedOnlyMode&&!1===e&&(b.style.visibility="hidden")})],q;for(q in C)C.hasOwnProperty(q);var K="webkitRubyPosition"in window.getComputedStyle(document.documentElement),z=K?"webkitRubyPosition":"rubyPosition",x="webkitTextEmphasisStyle"in window.getComputedStyle(document.documentElement)?"webkitTextEmphasisStyle":"textEmphasisStyle",I="webkitTextEmphasisPosition"in window.getComputedStyle(document.documentElement)?"webkitTextEmphasisPosition":"textEmphasisPosition"})("undefined"===
typeof g?this.imscHTML={}:g,"undefined"===typeof imscNames?c("./names"):imscNames,"undefined"===typeof imscStyles?c("./styles"):imscStyles,"undefined"===typeof imscUtils?c("./utils"):imscUtils)},{"./names":5,"./styles":6,"./utils":7}],3:[function(c,q,g){(function(b,c,h,g){function m(b,c,F,q,x,I,f,k,d){if(c<f.begin||c>=f.end)return null;I="regionID"in f&&""!==f.regionID?f.regionID:I;if(null!==x&&I!==F.id&&(!("contents"in f)||"contents"in f&&0===f.contents.length||""!==I))return null;var e=new n(f);
for(C in f.sets)!f.sets.hasOwnProperty(C)||c<f.sets[C].begin||c>=f.sets[C].end||(e.styleAttrs[f.sets[C].qname]=f.sets[C].value);var C={};for(var t in e.styleAttrs)if(e.styleAttrs.hasOwnProperty(t)&&(C[t]=!0,"region"===e.kind&&t===h.byName.writingMode.qname&&!(h.byName.direction.qname in e.styleAttrs))){var z=e.styleAttrs[t];if("lrtb"===z||"lr"===z)e.styleAttrs[h.byName.direction.qname]="ltr";else if("rltb"===z||"rl"===z)e.styleAttrs[h.byName.direction.qname]="rtl"}if(null!==x)for(var y in h.all)if(h.all.hasOwnProperty(y))if(t=
h.all[y],t.qname===h.byName.textDecoration.qname){z=x.styleAttrs[t.qname];var E=e.styleAttrs[t.qname],r=[];void 0===E?r=z:-1===E.indexOf("none")?((-1===E.indexOf("noUnderline")&&-1!==z.indexOf("underline")||-1!==E.indexOf("underline"))&&r.push("underline"),(-1===E.indexOf("noLineThrough")&&-1!==z.indexOf("lineThrough")||-1!==E.indexOf("lineThrough"))&&r.push("lineThrough"),(-1===E.indexOf("noOverline")&&-1!==z.indexOf("overline")||-1!==E.indexOf("overline"))&&r.push("overline")):r.push("none");e.styleAttrs[t.qname]=
r}else t.qname!==h.byName.fontSize.qname||t.qname in e.styleAttrs||"span"!==e.kind||"textContainer"!==e.styleAttrs[h.byName.ruby.qname]?t.qname!==h.byName.fontSize.qname||t.qname in e.styleAttrs||"span"!==e.kind||"text"!==e.styleAttrs[h.byName.ruby.qname]?t.inherit&&t.qname in x.styleAttrs&&!(t.qname in e.styleAttrs)&&(e.styleAttrs[t.qname]=x.styleAttrs[t.qname]):(z=x.styleAttrs[h.byName.fontSize.qname],e.styleAttrs[t.qname]="textContainer"===x.styleAttrs[h.byName.ruby.qname]?z:new g.ComputedLength(.5*
z.rw,.5*z.rh)):(z=x.styleAttrs[h.byName.fontSize.qname],e.styleAttrs[t.qname]=new g.ComputedLength(.5*z.rw,.5*z.rh));for(var D in h.all)if(h.all.hasOwnProperty(D)&&(y=h.all[D],!(y.qname in e.styleAttrs||y.qname===h.byName.position.qname&&h.byName.origin.qname in e.styleAttrs||y.qname===h.byName.origin.qname&&h.byName.position.qname in e.styleAttrs)&&(t=b.head.styling.initials[y.qname]||y.initial,null!==t&&("region"===e.kind||!1===y.inherit&&null!==t))))if(t=y.parse(t),null!==t)e.styleAttrs[y.qname]=
t,C[y.qname]=!0;else if(y="Invalid initial value for '"+y.qname+"' on element '"+e.kind,k&&k.error&&k.error(y))throw y;for(var K in h.all)if(h.all.hasOwnProperty(K)&&(D=h.all[K],D.qname in C&&null!==D.compute))if(y=D.compute(b,x,e,e.styleAttrs[D.qname],d),null!==y)e.styleAttrs[D.qname]=y;else if(e.styleAttrs[D.qname]=D.compute(b,x,e,D.parse(D.initial),d),D="Style '"+D.qname+"' on element '"+e.kind+"' cannot be computed",k&&k.error&&k.error(D))throw D;if("none"===e.styleAttrs[h.byName.display.qname])return null;
if(null===x)var H=null===q?[]:[q];else"contents"in f&&(H=f.contents);for(var A in H)H.hasOwnProperty(A)&&(x=m(b,c,F,q,e,I,H[A],k,d),null!==x&&e.contents.push(x.element));for(var w in e.styleAttrs)e.styleAttrs.hasOwnProperty(w)&&(b=!1,"span"===e.kind&&(c=e.styleAttrs[h.byName.ruby.qname],(b=("container"===c||"textContainer"===c||"baseContainer"===c)&&-1!==p.indexOf(w))||(b="container"!==c&&w===h.byName.rubyAlign.qname),b||(b=!("textContainer"===c||"text"===c)&&w===h.byName.rubyPosition.qname)),b||
(b=-1===h.byQName[w].applies.indexOf(e.kind)),b&&delete e.styleAttrs[w]);w=e.styleAttrs[h.byName.ruby.qname];if("p"===e.kind||"span"===e.kind&&("textContainer"===w||"text"===w))w=[],a(e,w),u(w),l(e);return"div"===e.kind&&h.byName.backgroundImage.qname in e.styleAttrs||"br"===e.kind||"image"===e.kind||"contents"in e&&0<e.contents.length||"span"===e.kind&&null!==e.text||"region"===e.kind&&"always"===e.styleAttrs[h.byName.showBackground.qname]?{region_id:I,element:e}:null}function u(a){function b(a){return"br"===
a.kind||/[\r\n\t ]$/.test(a.text)}function l(a){return"br"===a.kind||"preserve"===a.space&&/^[\r\n]/.test(a.text)}for(var c,h=0;h<a.length;)if(c=a[h],"br"===c.kind||"preserve"===c.space)h++;else{var g=c.text.replace(/[\t\r\n ]+/g," ");/^[ ]/.test(g)&&(0===h||b(a[h-1]))&&(g=g.substring(1));c.text=g;0===g.length?a.splice(h,1):h++}for(h=0;h<a.length;h++)c=a[h],"br"===c.kind||"preserve"===c.space?h++:/[ ]$/.test(c.text)&&(h===a.length-1||l(a[h+1]))&&(c.text=c.text.slice(0,-1))}function a(b,l){for(var c in b.contents)if(b.contents.hasOwnProperty(c)){var g=
b.contents[c],n=g.styleAttrs[h.byName.ruby.qname];if("span"!==g.kind||"textContainer"!==n&&"text"!==n)"contents"in g?a(g,l):("span"===g.kind&&0!==g.text.length||"br"===g.kind)&&l.push(g)}}function l(a){if("br"===a.kind)return!1;if("text"in a)return 0===a.text.length;if("contents"in a){for(var b=a.contents.length;b--;)l(a.contents[b])&&a.contents.splice(b,1);return 0===a.contents.length}}function F(a){this.contents=[];this.aspectRatio=a.aspectRatio}function n(a){this.kind=a.kind||"region";a.id&&(this.id=
a.id);this.styleAttrs={};for(var b in a.styleAttrs)a.styleAttrs.hasOwnProperty(b)&&(this.styleAttrs[b]=a.styleAttrs[b]);"src"in a&&(this.src=a.src);"type"in a&&(this.type=a.type);if("text"in a)this.text=a.text;else if("region"===this.kind||"contents"in a)this.contents=[];"space"in a&&(this.space=a.space)}b.generateISD=function(a,b,l){function c(a,b){function d(b){return!(a<b.begin||a>=b.end)}if(b.contents){var e={},f;for(f in b)b.hasOwnProperty(f)&&(e[f]=b[f]);e.contents=[];b.contents.filter(d).forEach(function(b){b=
c(a,b);b.regionID&&k.add(b.regionID);null!==b&&e.contents.push(b)});return e}return b}var h=new F(a),g={},f={},k=new Set;f=c(b,a.body);0===k.size&&a.head.layout.regions.hasOwnProperty("")&&k.add("");k.forEach(function(d){d=m(a,b,a.head.layout.regions[d],f,null,"",a.head.layout.regions[d],l,g);null!==d&&h.contents.push(d.element)});return h};var p=[h.byName.color.qname,h.byName.textCombine.qname,h.byName.textDecoration.qname,h.byName.textEmphasis.qname,h.byName.textOutline.qname,h.byName.textShadow.qname]})("undefined"===
typeof g?this.imscISD={}:g,"undefined"===typeof imscNames?c("./names"):imscNames,"undefined"===typeof imscStyles?c("./styles"):imscStyles,"undefined"===typeof imscUtils?c("./utils"):imscUtils)},{"./names":5,"./styles":6,"./utils":7}],4:[function(c,q,g){g.generateISD=c("./isd").generateISD;g.fromXML=c("./doc").fromXML;g.renderHTML=c("./html").render},{"./doc":1,"./html":2,"./isd":3}],5:[function(c,q,g){c="undefined"===typeof g?this.imscNames={}:g;c.ns_tt="http://www.w3.org/ns/ttml";c.ns_tts="http://www.w3.org/ns/ttml#styling";
c.ns_ttp="http://www.w3.org/ns/ttml#parameter";c.ns_xml="http://www.w3.org/XML/1998/namespace";c.ns_itts="http://www.w3.org/ns/ttml/profile/imsc1#styling";c.ns_ittp="http://www.w3.org/ns/ttml/profile/imsc1#parameter";c.ns_smpte="http://www.smpte-ra.org/schemas/2052-1/2010/smpte-tt";c.ns_ebutts="urn:ebu:tt:style";c.ttaf_map={"http://www.w3.org/2006/10/ttaf1":c.ns_tt,"http://www.w3.org/2006/10/ttaf1#style":c.ns_tts,"http://www.w3.org/2006/10/ttaf1#parameter":c.ns_ttp}},{}],6:[function(c,q,g){(function(b,
c,h){function g(a,b,c,g,h,m,q,u){this.name=b;this.ns=a;this.qname=a+" "+b;this.inherit=h;this.animatable=m;this.initial=c;this.applies=g;this.parse=q;this.compute=u}b.all=[new g(c.ns_tts,"backgroundColor","transparent",["body","div","p","region","span"],!1,!0,h.parseColor,null),new g(c.ns_tts,"color","white",["span"],!0,!0,h.parseColor,null),new g(c.ns_tts,"direction","ltr",["p","span"],!0,!0,function(a){return a},null),new g(c.ns_tts,"display","auto",["body","div","p","region","span"],!1,!0,function(a){return a},
null),new g(c.ns_tts,"displayAlign","before",["region"],!1,!0,function(a){return a},null),new g(c.ns_tts,"extent","auto",["tt","region"],!1,!0,function(a){if("auto"===a)return a;var b=a.split(" ");if(2!==b.length)return null;a=h.parseLength(b[0]);return(b=h.parseLength(b[1]))&&a?{h:b,w:a}:null},function(a,b,c,g,p){if("auto"===g)b=new h.ComputedLength(0,1);else if(b=h.toComputedLength(g.h.value,g.h.unit,null,a.dimensions.h,null,a.pxLength.h),null===b)return null;if("auto"===g)a=new h.ComputedLength(1,
0);else if(a=h.toComputedLength(g.w.value,g.w.unit,null,a.dimensions.w,null,a.pxLength.w),null===a)return null;return{h:b,w:a}}),new g(c.ns_tts,"fontFamily","default",["p","span"],!0,!0,function(a){a=a.split(",");for(var b=[],c=0;c<a.length;c++)"'"!==a[c].charAt(0)&&'"'!==a[c].charAt(0)?"default"===a[c]?b.push("monospaceSerif"):b.push(a[c]):b.push(a[c]);return b},null),new g(c.ns_tts,"shear","0%",["p"],!0,!0,h.parseLength,function(a,b,c,g){if("%"===g.unit)a=100<Math.abs(g.value)?100*Math.sign(g.value):
g.value;else return null;return a}),new g(c.ns_tts,"fontSize","1c",["p","span"],!0,!0,h.parseLength,function(a,c,g,n,p){return h.toComputedLength(n.value,n.unit,null!==c?c.styleAttrs[b.byName.fontSize.qname]:a.cellLength.h,null!==c?c.styleAttrs[b.byName.fontSize.qname]:a.cellLength.h,a.cellLength.h,a.pxLength.h)}),new g(c.ns_tts,"fontStyle","normal",["span"],!0,!0,function(a){return a},null),new g(c.ns_tts,"fontWeight","normal",["span"],!0,!0,function(a){return a},null),new g(c.ns_tts,"lineHeight",
"normal",["p"],!0,!0,function(a){return"normal"===a?a:h.parseLength(a)},function(a,c,g,n,p){if("normal"===n)a=n;else if(a=h.toComputedLength(n.value,n.unit,g.styleAttrs[b.byName.fontSize.qname],g.styleAttrs[b.byName.fontSize.qname],a.cellLength.h,a.pxLength.h),null===a)return null;return a}),new g(c.ns_tts,"opacity",1,["region"],!1,!0,parseFloat,null),new g(c.ns_tts,"origin","auto",["region"],!1,!0,function(a){if("auto"===a)return a;var b=a.split(" ");if(2!==b.length)return null;a=h.parseLength(b[0]);
return(b=h.parseLength(b[1]))&&a?{h:b,w:a}:null},function(a,b,c,g,p){if("auto"===g)b=new h.ComputedLength(0,0);else if(b=h.toComputedLength(g.h.value,g.h.unit,null,a.dimensions.h,null,a.pxLength.h),null===b)return null;if("auto"===g)a=new h.ComputedLength(0,0);else if(a=h.toComputedLength(g.w.value,g.w.unit,null,a.dimensions.w,null,a.pxLength.w),null===a)return null;return{h:b,w:a}}),new g(c.ns_tts,"overflow","hidden",["region"],!1,!0,function(a){return a},null),new g(c.ns_tts,"padding","0px",["region"],
!1,!0,function(a){a=a.split(" ");if(4<a.length)return null;for(var b=[],c=0;c<a.length;c++){var g=h.parseLength(a[c]);if(!g)return null;b.push(g)}return b},function(a,c,g,n,p){if(1===n.length)c=[n[0],n[0],n[0],n[0]];else if(2===n.length)c=[n[0],n[1],n[0],n[1]];else if(3===n.length)c=[n[0],n[1],n[2],n[1]];else if(4===n.length)c=[n[0],n[1],n[2],n[3]];else return null;n=g.styleAttrs[b.byName.writingMode.qname];if("lrtb"===n||"lr"===n)c=[c[0],c[3],c[2],c[1]];else if("rltb"===n||"rl"===n)c=[c[0],c[1],
c[2],c[3]];else if("tblr"===n)c=[c[3],c[0],c[1],c[2]];else if("tbrl"===n||"tb"===n)c=[c[3],c[2],c[1],c[0]];else return null;n=[];for(p=0;p<c.length;p++)if(0===c[p].value)n[p]=new h.ComputedLength(0,0);else if(n[p]=h.toComputedLength(c[p].value,c[p].unit,g.styleAttrs[b.byName.fontSize.qname],"0"===p||"2"===p?g.styleAttrs[b.byName.extent.qname].h:g.styleAttrs[b.byName.extent.qname].w,"0"===p||"2"===p?a.cellLength.h:a.cellLength.w,"0"===p||"2"===p?a.pxLength.h:a.pxLength.w),null===n[p])return null;return n}),
new g(c.ns_tts,"position","top left",["region"],!1,!0,function(a){return h.parsePosition(a)},function(a,c,g,n){c=h.toComputedLength(n.v.offset.value,n.v.offset.unit,null,new h.ComputedLength(-g.styleAttrs[b.byName.extent.qname].h.rw,a.dimensions.h.rh-g.styleAttrs[b.byName.extent.qname].h.rh),null,a.pxLength.h);if(null===c)return null;"bottom"===n.v.edge&&(c=new h.ComputedLength(-c.rw-g.styleAttrs[b.byName.extent.qname].h.rw,a.dimensions.h.rh-c.rh-g.styleAttrs[b.byName.extent.qname].h.rh));var l=h.toComputedLength(n.h.offset.value,
n.h.offset.unit,null,new h.ComputedLength(a.dimensions.w.rw-g.styleAttrs[b.byName.extent.qname].w.rw,-g.styleAttrs[b.byName.extent.qname].w.rh),null,a.pxLength.w);if(null===c)return null;"right"===n.h.edge&&(l=new h.ComputedLength(a.dimensions.w.rw-l.rw-g.styleAttrs[b.byName.extent.qname].w.rw,-l.rh-g.styleAttrs[b.byName.extent.qname].w.rh));return{h:c,w:l}}),new g(c.ns_tts,"ruby","none",["span"],!1,!0,function(a){return a},null),new g(c.ns_tts,"rubyAlign","center",["span"],!0,!0,function(a){return"center"!==
a&&"spaceAround"!==a?null:a},null),new g(c.ns_tts,"rubyPosition","outside",["span"],!0,!0,function(a){return a},null),new g(c.ns_tts,"rubyReserve","none",["p"],!0,!0,function(a){var b=a.split(" ");a=[null,null];if(0===b.length||2<b.length||"none"!==b[0]&&"both"!==b[0]&&"after"!==b[0]&&"before"!==b[0]&&"outside"!==b[0])return null;a[0]=b[0];if(2===b.length&&"none"!==b[0])if(b=h.parseLength(b[1]))a[1]=b;else return null;return a},function(a,c,g,n,p){if("none"===n[0])return n;a=null===n[1]?new h.ComputedLength(.5*
g.styleAttrs[b.byName.fontSize.qname].rw,.5*g.styleAttrs[b.byName.fontSize.qname].rh):h.toComputedLength(n[1].value,n[1].unit,g.styleAttrs[b.byName.fontSize.qname],g.styleAttrs[b.byName.fontSize.qname],a.cellLength.h,a.pxLength.h);return null===a?null:[n[0],a]}),new g(c.ns_tts,"showBackground","whenActive",["region"],!1,!0,function(a){return a},null),new g(c.ns_tts,"textAlign","start",["p"],!0,!0,function(a){return a},function(a,b,c,g,h){return"left"===g?"start":"right"===g?"end":g}),new g(c.ns_tts,
"textCombine","none",["span"],!0,!0,function(a){a=a.split(" ");return 1!==a.length||"none"!==a[0]&&"all"!==a[0]?null:[a[0]]},null),new g(c.ns_tts,"textDecoration","none",["span"],!0,!0,function(a){return a.split(" ")},null),new g(c.ns_tts,"textEmphasis","none",["span"],!0,!0,function(a){a=a.split(" ");for(var b={style:null,symbol:null,color:null,position:null},c=0;c<a.length;c++)if("none"===a[c]||"auto"===a[c])b.style=a[c];else if("filled"===a[c]||"open"===a[c])b.style=a[c];else if("circle"===a[c]||
"dot"===a[c]||"sesame"===a[c])b.symbol=a[c];else if("current"===a[c])b.color=a[c];else if("outside"===a[c]||"before"===a[c]||"after"===a[c])b.position=a[c];else if(b.color=h.parseColor(a[c]),null===b.color)return null;null==b.style&&null==b.symbol?b.style="auto":(b.symbol=b.symbol||"circle",b.style=b.style||"filled");b.position=b.position||"outside";b.color=b.color||"current";return b},null),new g(c.ns_tts,"textOutline","none",["span"],!0,!0,function(a){if("none"===a)return a;var b={};a=a.split(" ");
if(0===a.length||2<a.length)return null;var c=h.parseColor(a[0]);b.color=c;null!==c&&a.shift();if(1!==a.length)return null;a=h.parseLength(a[0]);if(!a)return null;b.thickness=a;return b},function(a,c,g,n,p){if("none"===n)return n;c={};c.color=null===n.color?g.styleAttrs[b.byName.color.qname]:n.color;c.thickness=h.toComputedLength(n.thickness.value,n.thickness.unit,g.styleAttrs[b.byName.fontSize.qname],g.styleAttrs[b.byName.fontSize.qname],a.cellLength.h,a.pxLength.h);return null===c.thickness?null:
c}),new g(c.ns_tts,"textShadow","none",["span"],!0,!0,h.parseTextShadow,function(a,c,g,n){if("none"===n)return n;c=[];for(var l in n)if(l.hasOwnProperty(n)){var m={};m.x_off=h.toComputedLength(n[l][0].value,n[l][0].unit,null,g.styleAttrs[b.byName.fontSize.qname],null,a.pxLength.w);if(null===m.x_off)return null;m.y_off=h.toComputedLength(n[l][1].value,n[l][1].unit,null,g.styleAttrs[b.byName.fontSize.qname],null,a.pxLength.h);if(null===m.y_off)return null;if(null===n[l][2])m.b_radius=0;else if(m.b_radius=
h.toComputedLength(n[l][2].value,n[l][2].unit,null,g.styleAttrs[b.byName.fontSize.qname],null,a.pxLength.h),null===m.b_radius)return null;m.color=null===n[l][3]?g.styleAttrs[b.byName.color.qname]:n[l][3];c.push(m)}return c}),new g(c.ns_tts,"unicodeBidi","normal",["span","p"],!1,!0,function(a){return a},null),new g(c.ns_tts,"visibility","visible",["body","div","p","region","span"],!0,!0,function(a){return a},null),new g(c.ns_tts,"wrapOption","wrap",["span"],!0,!0,function(a){return a},null),new g(c.ns_tts,
"writingMode","lrtb",["region"],!1,!0,function(a){return a},null),new g(c.ns_tts,"zIndex","auto",["region"],!1,!0,function(a){"auto"!==a&&(a=parseInt(a),isNaN(a)&&(a=null));return a},null),new g(c.ns_ebutts,"linePadding","0c",["p"],!0,!1,h.parseLength,function(a,b,c,g,m){return h.toComputedLength(g.value,g.unit,null,null,a.cellLength.w,null)}),new g(c.ns_ebutts,"multiRowAlign","auto",["p"],!0,!1,function(a){return a},null),new g(c.ns_smpte,"backgroundImage",null,["div"],!1,!1,function(a){return a},
null),new g(c.ns_itts,"forcedDisplay","false",["body","div","p","region","span"],!0,!0,function(a){return"true"===a?!0:!1},null),new g(c.ns_itts,"fillLineGap","true",["p"],!0,!0,function(a){return"true"===a?!0:!1},null)];b.byQName={};for(var m in b.all)b.all.hasOwnProperty(m)&&(b.byQName[b.all[m].qname]=b.all[m]);b.byName={};for(var q in b.all)b.all.hasOwnProperty(q)&&(b.byName[b.all[q].name]=b.all[q])})("undefined"===typeof g?this.imscStyles={}:g,"undefined"===typeof imscNames?c("./names"):imscNames,
"undefined"===typeof imscUtils?c("./utils"):imscUtils)},{"./names":5,"./utils":7}],7:[function(c,q,g){(function(b){var c=/#([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})?/,g=/rgb\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/,q=/rgba\(\s*(\d+),\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/,M={transparent:[0,0,0,0],black:[0,0,0,255],silver:[192,192,192,255],gray:[128,128,128,255],white:[255,255,255,255],maroon:[128,0,0,255],red:[255,0,0,255],purple:[128,0,128,255],fuchsia:[255,0,255,255],magenta:[255,
0,255,255],green:[0,128,0,255],lime:[0,255,0,255],olive:[128,128,0,255],yellow:[255,255,0,255],navy:[0,0,128,255],blue:[0,0,255,255],teal:[0,128,128,255],aqua:[0,255,255,255],cyan:[0,255,255,255]};b.parseColor=function(a){var b,h=null,n=M[a.toLowerCase()];void 0!==n?h=n:null!==(b=c.exec(a))?h=[parseInt(b[1],16),parseInt(b[2],16),parseInt(b[3],16),void 0!==b[4]?parseInt(b[4],16):255]:null!==(b=g.exec(a))?h=[parseInt(b[1]),parseInt(b[2]),parseInt(b[3]),255]:null!==(b=q.exec(a))&&(h=[parseInt(b[1]),
parseInt(b[2]),parseInt(b[3]),parseInt(b[4])]);return h};var H=/^((?:\+|\-)?\d*(?:\.\d+)?)(px|em|c|%|rh|rw)$/;b.parseLength=function(a){var b,c=null;null!==(b=H.exec(a))&&(c={value:parseFloat(b[1]),unit:b[2]});return c};b.parseTextShadow=function(a){a=a.split(",");for(var c=[],g=0;g<a.length;g++){var h=a[g].split(" ");if(1===h.length&&"none"===h[0])return"none";if(1<h.length&&5>h.length){var m=[null,null,null,null],q=b.parseLength(h.shift());if(null===q)return null;m[0]=q;q=b.parseLength(h.shift());
if(null===q)return null;m[1]=q;if(0!==h.length&&(q=b.parseLength(h[0]),null!==q&&(m[2]=q,h.shift()),0!==h.length)){h=b.parseColor(h[0]);if(null===h)return null;m[3]=h}c.push(m)}}return c};b.parsePosition=function(a){a=a.split(" ");var c=function(a){return"center"===a||"left"===a||"top"===a||"bottom"===a||"right"===a};if(4<a.length)return null;for(var g in a)if(a.hasOwnProperty(g)&&!c(a[g])){var h=b.parseLength(a[g]);if(null===h)return null;a[g]=h}g={h:{edge:"left",offset:{value:50,unit:"%"}},v:{edge:"top",
offset:{value:50,unit:"%"}}};for(h=0;h<a.length;){var m=a[h++];if(c(m)){var q={value:0,unit:"%"};2!==a.length&&h<a.length&&!c(a[h])&&(q=a[h++]);"right"===m?(g.h.edge=m,g.h.offset=q):"bottom"===m?(g.v.edge=m,g.v.offset=q):"left"===m?g.h.offset=q:"top"===m&&(g.v.offset=q)}else if(1===a.length||2===a.length)1===h?g.h.offset=m:g.v.offset=m;else return null}return g};b.ComputedLength=function(a,b){this.rw=a;this.rh=b};b.ComputedLength.prototype.toUsedLength=function(a,b){return a*this.rw+b*this.rh};b.ComputedLength.prototype.multiply=
function(a,b){return b?a*b:a};b.ComputedLength.prototype.isZero=function(){return 0===this.rw&&0===this.rh};b.toComputedLength=function(a,c,g,h,m,q){return"%"===c&&h?new b.ComputedLength(h.rw*a/100,h.rh*a/100):"em"===c&&g?new b.ComputedLength(g.rw*a,g.rh*a):"c"===c&&m?new b.ComputedLength(a*m.rw,a*m.rh):"px"===c&&q?new b.ComputedLength(a*q.rw,a*q.rh):"rh"===c?new b.ComputedLength(0,a/100):"rw"===c?new b.ComputedLength(a/100,0):null}})("undefined"===typeof g?this.imscUtils={}:g)},{}]},{},[4])(4)});
