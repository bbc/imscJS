var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.owns=function(c,q){return Object.prototype.hasOwnProperty.call(c,q)};$jscomp.assign="function"==typeof Object.assign?Object.assign:function(c,q){for(var g=1;g<arguments.length;g++){var b=arguments[g];if(b)for(var l in b)$jscomp.owns(b,l)&&(c[l]=b[l])}return c};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(c,q,g){c!=Array.prototype&&c!=Object.prototype&&(c[q]=g.value)};$jscomp.getGlobal=function(c){return"undefined"!=typeof window&&window===c?c:"undefined"!=typeof global&&null!=global?global:c};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.polyfill=function(c,q,g,b){if(q){g=$jscomp.global;c=c.split(".");for(b=0;b<c.length-1;b++){var l=c[b];l in g||(g[l]={});g=g[l]}c=c[c.length-1];b=g[c];q=q(b);q!=b&&null!=q&&$jscomp.defineProperty(g,c,{configurable:!0,writable:!0,value:q})}};$jscomp.polyfill("Object.assign",function(c){return c||$jscomp.assign},"es6","es3");$jscomp.polyfill("Object.entries",function(c){return c?c:function(c){var g=[],b;for(b in c)$jscomp.owns(c,b)&&g.push([b,c[b]]);return g}},"es8","es3");
$jscomp.polyfill("Math.sign",function(c){return c?c:function(c){c=Number(c);return 0===c||isNaN(c)?c:0<c?1:-1}},"es6","es3");$jscomp.checkEs6ConformanceViaProxy=function(){try{var c={},q=Object.create(new $jscomp.global.Proxy(c,{get:function(g,b,l){return g==c&&"q"==b&&l==q}}));return!0===q.q}catch(g){return!1}};$jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS=!1;$jscomp.ES6_CONFORMANCE=$jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS&&$jscomp.checkEs6ConformanceViaProxy();$jscomp.SYMBOL_PREFIX="jscomp_symbol_";
$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.Symbol=function(){var c=0;return function(q){return $jscomp.SYMBOL_PREFIX+(q||"")+c++}}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var c=$jscomp.global.Symbol.iterator;c||(c=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[c]&&$jscomp.defineProperty(Array.prototype,c,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};
$jscomp.initSymbolAsyncIterator=function(){$jscomp.initSymbol();var c=$jscomp.global.Symbol.asyncIterator;c||(c=$jscomp.global.Symbol.asyncIterator=$jscomp.global.Symbol("asyncIterator"));$jscomp.initSymbolAsyncIterator=function(){}};$jscomp.arrayIterator=function(c){var q=0;return $jscomp.iteratorPrototype(function(){return q<c.length?{done:!1,value:c[q++]}:{done:!0}})};
$jscomp.iteratorPrototype=function(c){$jscomp.initSymbolIterator();c={next:c};c[$jscomp.global.Symbol.iterator]=function(){return this};return c};$jscomp.makeIterator=function(c){$jscomp.initSymbolIterator();var q=c[Symbol.iterator];return q?q.call(c):$jscomp.arrayIterator(c)};
$jscomp.polyfill("WeakMap",function(c){function q(){if(!c||!Object.seal)return!1;try{var h=Object.seal({}),b=Object.seal({}),a=new c([[h,2],[b,3]]);if(2!=a.get(h)||3!=a.get(b))return!1;a.delete(h);a.set(b,4);return!a.has(h)&&4==a.get(b)}catch(m){return!1}}function g(h){$jscomp.owns(h,l)||$jscomp.defineProperty(h,l,{value:{}})}function b(h){var b=Object[h];b&&(Object[h]=function(a){g(a);return b(a)})}if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(c&&$jscomp.ES6_CONFORMANCE)return c}else if(q())return c;
var l="$jscomp_hidden_"+Math.random();b("freeze");b("preventExtensions");b("seal");var h=0,u=function(b){this.id_=(h+=Math.random()+1).toString();if(b){$jscomp.initSymbol();$jscomp.initSymbolIterator();b=$jscomp.makeIterator(b);for(var c;!(c=b.next()).done;)c=c.value,this.set(c[0],c[1])}};u.prototype.set=function(b,h){g(b);if(!$jscomp.owns(b,l))throw Error("WeakMap key fail: "+b);b[l][this.id_]=h;return this};u.prototype.get=function(b){return $jscomp.owns(b,l)?b[l][this.id_]:void 0};u.prototype.has=
function(b){return $jscomp.owns(b,l)&&$jscomp.owns(b[l],this.id_)};u.prototype.delete=function(b){return $jscomp.owns(b,l)&&$jscomp.owns(b[l],this.id_)?delete b[l][this.id_]:!1};return u},"es6","es3");$jscomp.MapEntry=function(){};
$jscomp.polyfill("Map",function(c){function q(){if($jscomp.ASSUME_NO_NATIVE_MAP||!c||"function"!=typeof c||!c.prototype.entries||"function"!=typeof Object.seal)return!1;try{var b=Object.seal({x:4}),a=new c($jscomp.makeIterator([[b,"s"]]));if("s"!=a.get(b)||1!=a.size||a.get({x:4})||a.set({x:4},"t")!=a||2!=a.size)return!1;var m=a.entries(),h=m.next();if(h.done||h.value[0]!=b||"s"!=h.value[1])return!1;h=m.next();return h.done||4!=h.value[0].x||"t"!=h.value[1]||!m.next().done?!1:!0}catch(n){return!1}}
if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(c&&$jscomp.ES6_CONFORMANCE)return c}else if(q())return c;$jscomp.initSymbol();$jscomp.initSymbolIterator();var g=new WeakMap,b=function(b){this.data_={};this.head_=u();this.size=0;if(b){b=$jscomp.makeIterator(b);for(var a;!(a=b.next()).done;)a=a.value,this.set(a[0],a[1])}};b.prototype.set=function(b,a){b=0===b?0:b;var m=l(this,b);m.list||(m.list=this.data_[m.id]=[]);m.entry?m.entry.value=a:(m.entry={next:this.head_,previous:this.head_.previous,head:this.head_,
key:b,value:a},m.list.push(m.entry),this.head_.previous.next=m.entry,this.head_.previous=m.entry,this.size++);return this};b.prototype.delete=function(b){b=l(this,b);return b.entry&&b.list?(b.list.splice(b.index,1),b.list.length||delete this.data_[b.id],b.entry.previous.next=b.entry.next,b.entry.next.previous=b.entry.previous,b.entry.head=null,this.size--,!0):!1};b.prototype.clear=function(){this.data_={};this.head_=this.head_.previous=u();this.size=0};b.prototype.has=function(b){return!!l(this,b).entry};
b.prototype.get=function(b){return(b=l(this,b).entry)&&b.value};b.prototype.entries=function(){return h(this,function(b){return[b.key,b.value]})};b.prototype.keys=function(){return h(this,function(b){return b.key})};b.prototype.values=function(){return h(this,function(b){return b.value})};b.prototype.forEach=function(b,a){for(var m=this.entries(),h;!(h=m.next()).done;)h=h.value,b.call(a,h[1],h[0],this)};b.prototype[Symbol.iterator]=b.prototype.entries;var l=function(b,a){var m=a&&typeof a;"object"==
m||"function"==m?g.has(a)?m=g.get(a):(m=""+ ++J,g.set(a,m)):m="p_"+a;var h=b.data_[m];if(h&&$jscomp.owns(b.data_,m))for(b=0;b<h.length;b++){var n=h[b];if(a!==a&&n.key!==n.key||a===n.key)return{id:m,list:h,index:b,entry:n}}return{id:m,list:h,index:-1,entry:void 0}},h=function(b,a){var m=b.head_;return $jscomp.iteratorPrototype(function(){if(m){for(;m.head!=b.head_;)m=m.previous;for(;m.next!=m.head;)return m=m.next,{done:!1,value:a(m)};m=null}return{done:!0,value:void 0}})},u=function(){var b={};return b.previous=
b.next=b.head=b},J=0;return b},"es6","es3");
$jscomp.polyfill("Set",function(c){function q(){if($jscomp.ASSUME_NO_NATIVE_SET||!c||"function"!=typeof c||!c.prototype.entries||"function"!=typeof Object.seal)return!1;try{var b=Object.seal({x:4}),l=new c($jscomp.makeIterator([b]));if(!l.has(b)||1!=l.size||l.add(b)!=l||1!=l.size||l.add({x:4})!=l||2!=l.size)return!1;var h=l.entries(),u=h.next();if(u.done||u.value[0]!=b||u.value[1]!=b)return!1;u=h.next();return u.done||u.value[0]==b||4!=u.value[0].x||u.value[1]!=u.value[0]?!1:h.next().done}catch(J){return!1}}
if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(c&&$jscomp.ES6_CONFORMANCE)return c}else if(q())return c;$jscomp.initSymbol();$jscomp.initSymbolIterator();var g=function(b){this.map_=new Map;if(b){b=$jscomp.makeIterator(b);for(var c;!(c=b.next()).done;)this.add(c.value)}this.size=this.map_.size};g.prototype.add=function(b){b=0===b?0:b;this.map_.set(b,b);this.size=this.map_.size;return this};g.prototype.delete=function(b){b=this.map_.delete(b);this.size=this.map_.size;return b};g.prototype.clear=
function(){this.map_.clear();this.size=0};g.prototype.has=function(b){return this.map_.has(b)};g.prototype.entries=function(){return this.map_.entries()};g.prototype.values=function(){return this.map_.values()};g.prototype.keys=g.prototype.values;g.prototype[Symbol.iterator]=g.prototype.values;g.prototype.forEach=function(b,c){var h=this;this.map_.forEach(function(l){return b.call(c,l,l,h)})};return g},"es6","es3");
(function(c){"object"===typeof exports&&"undefined"!==typeof module?module.exports=c():"function"===typeof define&&define.amd?define([],c):("undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:this).imsc=c()})(function(){return function(){function c(q,g,b){function l(u,G){if(!g[u]){if(!q[u]){var a="function"==typeof require&&require;if(!G&&a)return a(u,!0);if(h)return h(u,!0);G=Error("Cannot find module '"+u+"'");throw G.code="MODULE_NOT_FOUND",G;}G=
g[u]={exports:{}};q[u][0].call(G.exports,function(a){return l(q[u][1][a]||a)},G,G.exports,c,q,g,b)}return g[u].exports}for(var h="function"==typeof require&&require,u=0;u<b.length;u++)l(b[u]);return l}return c}()({1:[function(c,q,g){(function(b,c,h,u,g){function l(f,a){var e=f.styleAttrs&&f.styleAttrs["http://www.w3.org/ns/ttml#styling backgroundColor"];if("span"===f.kind)!e&&a&&(f.styleAttrs||(f.styleAttrs={}),f.styleAttrs["http://www.w3.org/ns/ttml#styling backgroundColor"]=a);else if(e&&delete f.styleAttrs["http://www.w3.org/ns/ttml#styling backgroundColor"],
f.contents)for(var d=0;d<f.contents.length;d++)l(f.contents[d],e||a)}function a(f){if("contents"in f){var e="styleAttrs"in f?f.styleAttrs[u.byName.ruby.qname]:null;e="span"===f.kind&&("container"===e||"textContainer"===e||"baseContainer"===e);for(var d=f.contents.length-1;0<=d;d--)!e||"styleAttrs"in f.contents[d]&&u.byName.ruby.qname in f.contents[d].styleAttrs?a(f.contents[d]):delete f.contents[d]}}function m(f,a,e,d){var b=d&&"seq"===d.timeContainer,k=0;d&&(k=b&&e?e.end:d.begin);a.begin=a.explicit_begin?
a.explicit_begin+k:k;e=a.begin;d=null;for(var v in a.sets)a.sets.hasOwnProperty(v)&&(m(f,a.sets[v],d,a),e="seq"===a.timeContainer?a.sets[v].end:Math.max(e,a.sets[v].end),d=a.sets[v]);if("contents"in a)for(var h in a.contents)a.contents.hasOwnProperty(h)&&(m(f,a.contents[h],d,a),e="seq"===a.timeContainer?a.contents[h].end:Math.max(e,a.contents[h].end),d=a.contents[h]);else e=b?a.begin:Number.POSITIVE_INFINITY;a.end=null!==a.explicit_end&&null!==a.explicit_dur?Math.min(a.begin+a.explicit_dur,k+a.explicit_end):
null===a.explicit_end&&null!==a.explicit_dur?a.begin+a.explicit_dur:null!==a.explicit_end&&null===a.explicit_dur?k+a.explicit_end:e;delete a.explicit_begin;delete a.explicit_dur;delete a.explicit_end;f._registerEvent(a)}function E(a){this.node=a}function n(){this.events=[];this.head=new p;this.body=null}function p(){this.styling=new B;this.layout=new A}function B(){this.styles={};this.initials={}}function t(){this.styleRefs=this.styleAttrs=this.id=null}function q(){this.styleAttrs=null}function A(){this.regions=
{}}function x(a,f){this.kind="image";this.src=a;this.type=f}function I(a){this.id=a}function f(a){this.regionID=a}function k(a){this.styleAttrs=a}function d(a){this.sets=a}function e(a){this.contents=a}function C(a,f,e){this.explicit_begin=a;this.explicit_end=f;this.explicit_dur=e}function R(){this.kind="body"}function P(){this.kind="div"}function z(){this.kind="p"}function D(){this.kind="span"}function r(){this.kind="span"}function w(){this.kind="br"}function N(){}function U(){}function V(a){var f=
null;a&&(a=a.attributes["xml:id"]||a.attributes.id)&&(f=a.value||null);return f}function y(a){return a&&"style"in a.attributes?a.attributes.style.value.split(" "):[]}function J(a,f){var e={};if(null!==a)for(var d in a.attributes)if(a.attributes.hasOwnProperty(d)){var b=a.attributes[d].uri+" "+a.attributes[d].local,m=u.byQName[b];if(void 0!==m){var k=m.parse(a.attributes[d].value);null!==k?(e[b]=k,m===u.byName.zIndex&&M(f,"zIndex attribute present but not used by IMSC1 since regions do not overlap")):
K(f,"Cannot parse styling attribute "+b+" --\x3e "+a.attributes[d].value)}}return e}function O(a,f,e){for(var d in a.attributes)if(a.attributes.hasOwnProperty(d)&&a.attributes[d].uri===f&&a.attributes[d].local===e)return a.attributes[d].value;return null}function Z(a,f){a=O(a,h.ns_tts,"extent");if(null===a)return null;var d=a.split(" ");if(2!==d.length)return M(f,"Malformed extent (ignoring)"),null;a=g.parseLength(d[0]);d=g.parseLength(d[1]);return d&&a?{h:d,w:a}:(M(f,"Malformed extent values (ignoring)"),
null)}function S(a,f,d){var e=/^(\d{2,}):(\d\d):(\d\d(?:\.\d+)?)$/,b=/^(\d{2,}):(\d\d):(\d\d):(\d{2,})$/,m=/^(\d+(?:\.\d+)?)t$/,k=/^(\d+(?:\.\d+)?)ms$/,h=/^(\d+(?:\.\d+)?)s$/,n=/^(\d+(?:\.\d+)?)h$/,c=/^(\d+(?:\.\d+)?)m$/,v,H=null;null!==(v=/^(\d+(?:\.\d+)?)f$/.exec(d))?null!==f&&(H=parseFloat(v[1])/f):null!==(v=m.exec(d))?null!==a&&(H=parseFloat(v[1])/a):null!==(v=k.exec(d))?H=parseFloat(v[1])/1E3:null!==(v=h.exec(d))?H=parseFloat(v[1]):null!==(v=n.exec(d))?H=3600*parseFloat(v[1]):null!==(v=c.exec(d))?
H=60*parseFloat(v[1]):null!==(v=e.exec(d))?H=3600*parseInt(v[1])+60*parseInt(v[2])+parseFloat(v[3]):null!==(v=b.exec(d))&&null!==f&&(H=3600*parseInt(v[1])+60*parseInt(v[2])+parseInt(v[3])+(null===v[4]?0:parseInt(v[4])/f));return H}function W(a,f,d){for(;0<f.styleRefs.length;){var e=f.styleRefs.pop();e in a.styles?(W(a,a.styles[e],d),T(a.styles[e].styleAttrs,f.styleAttrs)):K(d,"Non-existant style id referenced")}}function X(a,f,d,e){for(var b=f.length-1;0<=b;b--){var m=f[b];m in a.styles?T(a.styles[m].styleAttrs,
d):K(e,"Non-existant style id referenced")}}function T(a,f){for(var d in a)!a.hasOwnProperty(d)||d in f||(f[d]=a[d])}function M(a,f){if(a&&a.warn&&a.warn(f))throw f;}function K(a,f){if(a&&a.error&&a.error(f))throw f;}function F(a,f){a&&a.fatal&&a.fatal(f);throw f;}function Y(a,f){for(var d=0,e=a.length-1,b;d<=e;){b=Math.floor((d+e)/2);var m=a[b];if(m<f)d=b+1;else if(m>f)e=b-1;else return{found:!0,index:b}}return{found:!1,index:d}}b.fromXML=function(f,d,e){var b=c.parser(!0,{xmlns:!0}),k=[],v=[],C=
[],Q=0,g=null;b.onclosetag=function(a){if(k[0]instanceof N)null!==g.head&&null!==g.head.styling&&X(g.head.styling,k[0].styleRefs,k[0].styleAttrs,d),delete k[0].styleRefs;else if(k[0]instanceof B)for(var f in k[0].styles)k[0].styles.hasOwnProperty(f)&&W(k[0],k[0].styles[f],d);else if(k[0]instanceof z||k[0]instanceof D){if(1<k[0].contents.length){a=[k[0].contents[0]];for(f=1;f<k[0].contents.length;f++)k[0].contents[f]instanceof r&&a[a.length-1]instanceof r?a[a.length-1].text+=k[0].contents[f].text:
a.push(k[0].contents[f]);k[0].contents=a}k[0]instanceof D&&1===k[0].contents.length&&k[0].contents[0]instanceof r&&(k[0].text=k[0].contents[0].text,delete k[0].contents)}else if(k[0]instanceof E)if(k[0].node.uri===h.ns_tt&&"metadata"===k[0].node.local)Q--;else if(0<Q&&e&&"onCloseTag"in e)e.onCloseTag();C.shift();v.shift();k.shift()};b.ontext=function(a){if(void 0!==k[0])if(k[0]instanceof D||k[0]instanceof z){if(k[0]instanceof D){var f=k[0].styleAttrs[u.byName.ruby.qname];if("container"===f||"textContainer"===
f||"baseContainer"===f)return}f=new r;f.initFromText(g,k[0],a,v[0],C[0],d);k[0].contents.push(f)}else if(k[0]instanceof E&&0<Q&&e&&"onText"in e)e.onText(a)};b.onopentag=function(a){function f(a){h.ttaf_map[a.uri]&&(a.uri=h.ttaf_map[a.uri])}var b=a.attributes["xml:space"];b?C.unshift(b.value):0===C.length?C.unshift("default"):C.unshift(C[0]);(b=a.attributes["xml:lang"])?v.unshift(b.value):0===v.length?v.unshift(""):v.unshift(v[0]);f(a);if(a.attributes)for(var m in a.attributes)a.attributes.hasOwnProperty(m)&&
f(a.attributes[m]);if(a.uri===h.ns_tt)if("tt"===a.local)null!==g&&F(d,"Two <tt> elements at ("+this.line+","+this.column+")"),g=new n,g.initFromNode(a,v[0],d),k.unshift(g);else if("head"===a.local)k[0]instanceof n||F(d,"Parent of <head> element is not <tt> at ("+this.line+","+this.column+")"),k.unshift(g.head);else if("styling"===a.local)k[0]instanceof p||F(d,"Parent of <styling> element is not <head> at ("+this.line+","+this.column+")"),k.unshift(g.head.styling);else if("style"===a.local)if(k[0]instanceof
B){var c=new t;c.initFromNode(a,d);c.id?g.head.styling.styles[c.id]=c:K(d,"<style> element missing @id attribute");k.unshift(c)}else k[0]instanceof N?(c=new t,c.initFromNode(a,d),T(c.styleAttrs,k[0].styleAttrs),k.unshift(c)):F(d,"Parent of <style> element is not <styling> or <region> at ("+this.line+","+this.column+")");else if("initial"===a.local)if(k[0]instanceof B){m=new q;m.initFromNode(a,d);for(c in m.styleAttrs)m.styleAttrs.hasOwnProperty(c)&&(g.head.styling.initials[c]=m.styleAttrs[c]);k.unshift(m)}else F(d,
"Parent of <initial> element is not <styling> at ("+this.line+","+this.column+")");else if("layout"===a.local)k[0]instanceof p||F(d,"Parent of <layout> element is not <head> at "+this.line+","+this.column+")"),k.unshift(g.head.layout);else if("region"===a.local)k[0]instanceof A||F(d,"Parent of <region> element is not <layout> at "+this.line+","+this.column+")"),c=new N,c.initFromNode(g,a,v[0],d),!c.id||c.id in g.head.layout.regions?K(d,"Ignoring <region> with duplicate or missing @id at "+this.line+
","+this.column+")"):g.head.layout.regions[c.id]=c,k.unshift(c);else if("body"===a.local)k[0]instanceof n||F(d,"Parent of <body> element is not <tt> at "+this.line+","+this.column+")"),null!==g.body&&F(d,"Second <body> element at "+this.line+","+this.column+")"),c=new R,c.initFromNode(g,a,v[0],d),g.body=c,k.unshift(c);else if("div"===a.local){k[0]instanceof P||k[0]instanceof R||F(d,"Parent of <div> element is not <body> or <div> at "+this.line+","+this.column+")");c=new P;c.initFromNode(g,k[0],a,
v[0],d);if(m=c.styleAttrs[u.byName.backgroundImage.qname])c.contents.push(new x(m)),delete c.styleAttrs[u.byName.backgroundImage.qname];k[0].contents.push(c);k.unshift(c)}else"image"===a.local?(k[0]instanceof P||F(d,"Parent of <image> element is not <div> at "+this.line+","+this.column+")"),c=new x,c.initFromNode(g,k[0],a,v[0],d),k[0].contents.push(c),k.unshift(c)):"p"===a.local?(k[0]instanceof P||F(d,"Parent of <p> element is not <div> at "+this.line+","+this.column+")"),c=new z,c.initFromNode(g,
k[0],a,v[0],d),k[0].contents.push(c),k.unshift(c)):"span"===a.local?(k[0]instanceof D||k[0]instanceof z||F(d,"Parent of <span> element is not <span> or <p> at "+this.line+","+this.column+")"),c=new D,c.initFromNode(g,k[0],a,v[0],C[0],d),k[0].contents.push(c),k.unshift(c)):"br"===a.local?(k[0]instanceof D||k[0]instanceof z||F(d,"Parent of <br> element is not <span> or <p> at "+this.line+","+this.column+")"),c=new w,c.initFromNode(g,k[0],a,v[0],d),k[0].contents.push(c),k.unshift(c)):"set"===a.local?
(k[0]instanceof D||k[0]instanceof z||k[0]instanceof P||k[0]instanceof R||k[0]instanceof N||k[0]instanceof w||F(d,"Parent of <set> element is not a content element or a region at "+this.line+","+this.column+")"),c=new U,c.initFromNode(g,k[0],a,d),k[0].sets.push(c),k.unshift(c)):k.unshift(new E(a));else k.unshift(new E(a));if(k[0]instanceof E)if(a.uri===h.ns_tt&&"metadata"===a.local)Q++;else if(0<Q&&e&&"onOpenTag"in e){c=[];for(var l in a.attributes)a.attributes.hasOwnProperty(l)&&(c[a.attributes[l].uri+
" "+a.attributes[l].local]={uri:a.attributes[l].uri,local:a.attributes[l].local,value:a.attributes[l].value});e.onOpenTag(a.uri,a.local,c)}};b.write(f).close();delete g.head.styling.styles;f=!1;for(var H in g.head.layout.regions)if(g.head.layout.regions.hasOwnProperty(H)){f=!0;break}f||(H=N.prototype.createDefaultRegion(g,d),g.head.layout.regions[H.id]=H);for(var y in g.head.layout.regions)g.head.layout.regions.hasOwnProperty(y)&&m(g,g.head.layout.regions[y],null,null);g.body&&m(g,g.body,null,null);
g.body&&a(g.body);g.body&&l(g.body);return g};n.prototype.initFromNode=function(a,f,d){var e=O(a,h.ns_ttp,"cellResolution"),k=15;var b=32;null!==e&&(e=/(\d+) (\d+)/.exec(e),null!==e?(b=parseInt(e[1]),k=parseInt(e[2])):M(d,"Malformed cellResolution value (using initial value instead)"));this.cellLength={h:new g.ComputedLength(0,1/k),w:new g.ComputedLength(1/b,0)};k=O(a,h.ns_ttp,"frameRate");e=30;null!==k&&(b=/(\d+)/.exec(k),null!==b?e=parseInt(b[1]):M(d,"Malformed frame rate attribute (using initial value instead)"));
b=O(a,h.ns_ttp,"frameRateMultiplier");var m=1;null!==b&&(b=/(\d+) (\d+)/.exec(b),null!==b?m=parseInt(b[1])/parseInt(b[2]):M(d,"Malformed frame rate multiplier attribute (using initial value instead)"));e*=m;m=1;b=O(a,h.ns_ttp,"tickRate");null===b?null!==k&&(m=e):(b=/(\d+)/.exec(b),null!==b?m=parseInt(b[1]):M(d,"Malformed tick rate attribute (using initial value instead)"));this.effectiveFrameRate=e;this.tickRate=m;b=O(a,h.ns_ittp,"aspectRatio");null===b&&(b=O(a,h.ns_ttp,"displayAspectRatio"));k=null;
null!==b&&(e=/(\d+)\s+(\d+)/.exec(b),null!==e?(b=parseInt(e[1]),e=parseInt(e[2]),0!==b&&0!==e?k=b/e:K(d,"Illegal aspectRatio values (ignoring)")):K(d,"Malformed aspectRatio attribute (ignoring)"));this.aspectRatio=k;k=O(a,h.ns_ttp,"timeBase");null!==k&&"media"!==k&&F(d,"Unsupported time base");a=Z(a,d);null===a?this.pxLength={h:null,w:null}:("px"===a.h.unit&&"px"===a.w.unit||F(d,"Extent on TT must be in px or absent"),this.pxLength={h:new g.ComputedLength(0,1/a.h.value),w:new g.ComputedLength(1/a.w.value,
0)});this.dimensions={h:new g.ComputedLength(0,1),w:new g.ComputedLength(1,0)};this.lang=f};n.prototype._registerEvent=function(a){if(!(a.end<=a.begin)){var f=Y(this.events,a.begin);f.found||this.events.splice(f.index,0,a.begin);a.end!==Number.POSITIVE_INFINITY&&(f=Y(this.events,a.end),f.found||this.events.splice(f.index,0,a.end))}};n.prototype.getMediaTimeRange=function(){return[this.events[0],this.events[this.events.length-1]]};n.prototype.getMediaTimeEvents=function(){return this.events};t.prototype.initFromNode=
function(a,f){this.id=V(a);this.styleAttrs=J(a,f);this.styleRefs=y(a)};q.prototype.initFromNode=function(a,f){this.styleAttrs={};for(var d in a.attributes)!a.attributes.hasOwnProperty(d)||a.attributes[d].uri!==h.ns_itts&&a.attributes[d].uri!==h.ns_ebutts&&a.attributes[d].uri!==h.ns_tts||(this.styleAttrs[a.attributes[d].uri+" "+a.attributes[d].local]=a.attributes[d].value)};x.prototype.initFromNode=function(a,e,b,m,c){(this.src="src"in b.attributes?b.attributes.src.value:null)||K(c,"Invalid image@src attribute");
(this.type="type"in b.attributes?b.attributes.type.value:null)||K(c,"Invalid image@type attribute");k.prototype.initFromNode.call(this,a,e,b,c);C.prototype.initFromNode.call(this,a,e,b,c);d.prototype.initFromNode.call(this,a,e,b,c);f.prototype.initFromNode.call(this,a,e,b,c);this.lang=m};I.prototype.initFromNode=function(a,f,d,e){this.id=V(d)};f.prototype.initFromNode=function(a,f,d,e){this.regionID=d&&"region"in d.attributes?d.attributes.region.value:""};k.prototype.initFromNode=function(a,f,d,e){this.styleAttrs=
J(d,e);null!==a.head&&null!==a.head.styling&&X(a.head.styling,y(d),this.styleAttrs,e)};d.prototype.initFromNode=function(a,f,d,e){this.sets=[]};e.prototype.initFromNode=function(a,f,d,e){this.contents=[]};C.prototype.initFromNode=function(a,f,d,e){f=null;d&&"begin"in d.attributes&&(f=S(a.tickRate,a.effectiveFrameRate,d.attributes.begin.value),null===f&&M(e,"Malformed begin value "+d.attributes.begin.value+" (using 0)"));var k=null;d&&"dur"in d.attributes&&(k=S(a.tickRate,a.effectiveFrameRate,d.attributes.dur.value),
null===k&&M(e,"Malformed dur value "+d.attributes.dur.value+" (ignoring)"));var b=null;d&&"end"in d.attributes&&(b=S(a.tickRate,a.effectiveFrameRate,d.attributes.end.value),null===b&&M(e,"Malformed end value (ignoring)"));this.explicit_begin=f;this.explicit_end=b;this.explicit_dur=k;(a=d&&"timeContainer"in d.attributes?d.attributes.timeContainer.value:null)&&"par"!==a?"seq"===a?e="seq":(K(e,"Illegal value of timeContainer (assuming 'par')"),e="par"):e="par";this.timeContainer=e};R.prototype.initFromNode=
function(a,b,m,c){k.prototype.initFromNode.call(this,a,null,b,c);C.prototype.initFromNode.call(this,a,null,b,c);d.prototype.initFromNode.call(this,a,null,b,c);f.prototype.initFromNode.call(this,a,null,b,c);e.prototype.initFromNode.call(this,a,null,b,c);this.lang=m};P.prototype.initFromNode=function(a,b,m,c,h){k.prototype.initFromNode.call(this,a,b,m,h);C.prototype.initFromNode.call(this,a,b,m,h);d.prototype.initFromNode.call(this,a,b,m,h);f.prototype.initFromNode.call(this,a,b,m,h);e.prototype.initFromNode.call(this,
a,b,m,h);this.lang=c};z.prototype.initFromNode=function(a,b,m,c,h){k.prototype.initFromNode.call(this,a,b,m,h);C.prototype.initFromNode.call(this,a,b,m,h);d.prototype.initFromNode.call(this,a,b,m,h);f.prototype.initFromNode.call(this,a,b,m,h);e.prototype.initFromNode.call(this,a,b,m,h);this.lang=c};D.prototype.initFromNode=function(a,b,m,c,h,n){k.prototype.initFromNode.call(this,a,b,m,n);C.prototype.initFromNode.call(this,a,b,m,n);d.prototype.initFromNode.call(this,a,b,m,n);f.prototype.initFromNode.call(this,
a,b,m,n);e.prototype.initFromNode.call(this,a,b,m,n);this.space=h;this.lang=c};r.prototype.initFromText=function(a,f,d,e,k,b){C.prototype.initFromNode.call(this,a,f,null,b);this.text=d;this.space=k;this.lang=e};w.prototype.initFromNode=function(a,d,e,k,b){f.prototype.initFromNode.call(this,a,d,e,b);C.prototype.initFromNode.call(this,a,d,e,b);this.lang=k};N.prototype.createDefaultRegion=function(a,f){var d=new N;d.id="";k.prototype.initFromNode.call(d,a,null,{name:"region",attributes:{"tts:displayAlign":{name:"tts:displayAlign",
value:"after",prefix:"tts",local:"displayAlign",uri:"http://www.w3.org/ns/ttml#styling"},"tts:extent":{name:"tts:extent",value:"80% 20%",prefix:"tts",local:"extent",uri:"http://www.w3.org/ns/ttml#styling"},"tts:origin":{name:"tts:origin",value:"10% 70%",prefix:"tts",local:"origin",uri:"http://www.w3.org/ns/ttml#styling"},"tts:overflow":{name:"tts:overflow",value:"visible",prefix:"tts",local:"overflow",uri:"http://www.w3.org/ns/ttml#styling"}},ns:{"":"http://www.w3.org/ns/ttml",ebuttm:"urn:ebu:tt:metadata",
ebutts:"urn:ebu:tt:style",ittp:"http://www.w3.org/ns/ttml/profile/imsc1#parameter",itts:"http://www.w3.org/ns/ttml/profile/imsc1#styling",ttm:"http://www.w3.org/ns/ttml#metadata",ttp:"http://www.w3.org/ns/ttml#parameter",tts:"http://www.w3.org/ns/ttml#styling",xml:"http://www.w3.org/XML/1998/namespace"},prefix:"",local:"region",uri:"http://www.w3.org/ns/ttml",isSelfClosing:!0},f);d.sets=[];C.call(d,0,Number.POSITIVE_INFINITY,null);this.lang=a.xmllang;return d};N.prototype.initFromNode=function(a,
f,e,k){I.prototype.initFromNode.call(this,a,null,f,k);C.prototype.initFromNode.call(this,a,null,f,k);d.prototype.initFromNode.call(this,a,null,f,k);this.styleAttrs=J(f,k);this.styleRefs=y(f);this.lang=e};U.prototype.initFromNode=function(a,f,d,e){C.prototype.initFromNode.call(this,a,f,d,e);a=J(d,e);this.value=this.qname=null;for(var k in a)if(a.hasOwnProperty(k)){if(this.qname){K(e,"More than one style specified on set");break}this.qname=k;this.value=a[k]}}})("undefined"===typeof g?this.imscDoc={}:
g,"undefined"===typeof sax?c("sax"):sax,"undefined"===typeof imscNames?c("./names"):imscNames,"undefined"===typeof imscStyles?c("./styles"):imscStyles,"undefined"===typeof imscUtils?c("./utils"):imscUtils)},{"./names":5,"./styles":6,"./utils":7,sax:void 0}],2:[function(c,q,g){(function(b,c,h,g){function l(a){var f={};a=Object.entries(a);for(var d in a)if(a.hasOwnProperty(d)){var e=g.parseColor(a[d][0]),b=g.parseColor(a[d][1]);e&&b&&(f[e.toString()]=b)}return f}function u(f,k,d,e){if("region"===d.kind){var b=
document.createElement("div");b.style.position="absolute"}else if("body"===d.kind)b=document.createElement("div");else if("div"===d.kind)b=document.createElement("div");else if("image"===d.kind){if(b=document.createElement("img"),null!==f.imgResolver&&null!==d.src){var c=f.imgResolver(d.src,b);c&&(b.src=c);b.height=f.regionH;b.width=f.regionW}}else if("p"===d.kind)b=document.createElement("p");else if("span"===d.kind)if("container"===d.styleAttrs[h.byName.ruby.qname])b=document.createElement("ruby"),
f.ruby=!0;else if("base"===d.styleAttrs[h.byName.ruby.qname])b=document.createElement("rb");else if("text"===d.styleAttrs[h.byName.ruby.qname])b=document.createElement("rt");else if("baseContainer"===d.styleAttrs[h.byName.ruby.qname])b=document.createElement("rbc");else if("textContainer"===d.styleAttrs[h.byName.ruby.qname])b=document.createElement("rtc");else{if("delimiter"===d.styleAttrs[h.byName.ruby.qname])return;b=document.createElement("span")}else"br"===d.kind&&(b=document.createElement("br"));
if(b){!d.lang||"region"!==d.kind&&d.lang===e.lang||(b.lang=d.lang);k.appendChild(b);b.style.margin="0";if("region"===d.kind)if(k=d.styleAttrs[h.byName.writingMode.qname],"lrtb"===k||"lr"===k)f.ipd="lr",f.bpd="tb";else if("rltb"===k||"rl"===k)f.ipd="rl",f.bpd="tb";else if("tblr"===k)f.ipd="tb",f.bpd="lr";else{if("tbrl"===k||"tb"===k)f.ipd="tb",f.bpd="rl"}else"p"===d.kind&&"tb"===f.bpd&&(f.ipd="ltr"===d.styleAttrs[h.byName.direction.qname]?"lr":"rl");for(var g in B)B.hasOwnProperty(g)&&(k=B[g],e=d.styleAttrs[k.qname],
void 0!==e&&null!==k.map&&k.map(f,b,d,e));g=b;(k=d.styleAttrs[h.byName.linePadding.qname])&&!k.isZero()&&(e=k.multiply(k.toUsedLength(f.w,f.h),f.options.sizeAdjust),0<e&&(e=Math.ceil(e)+"px","tb"===f.bpd?(g.style.paddingLeft=e,g.style.paddingRight=e):(g.style.paddingTop=e,g.style.paddingBottom=e),f.removePaddingElement=g,f.lp=k));(k=d.styleAttrs[h.byName.multiRowAlign.qname])&&"auto"!==k&&(g=document.createElement("span"),g.style.display="inline-block",g.style.textAlign=k,b.appendChild(g),f.mra=k);
(k=d.styleAttrs[h.byName.rubyReserve.qname])&&"none"!==k[0]&&(f.rubyReserve=k);d.styleAttrs[h.byName.fillLineGap.qname]&&(f.flg=!0);if("span"===d.kind&&d.text)if((k=d.styleAttrs[h.byName.textEmphasis.qname])&&"none"!==k.style&&(f.textEmphasis=!0),h.byName.textCombine.qname in d.styleAttrs&&"all"===d.styleAttrs[h.byName.textCombine.qname])b.textContent=d.text,k&&n(f,b,d,k);else for(e="",c=0;c<d.text.length;c++){e+=d.text.charAt(c);var p=d.text.charCodeAt(c);if(55296>p||56319<p||c===d.text.length-1)p=
document.createElement("span"),p.textContent=e,k&&n(f,p,d,k),b.appendChild(p),e="",p._isd_element=d}for(var l in d.contents)d.contents.hasOwnProperty(l)&&u(f,g,d.contents[l],d);l=[];if((f.lp||f.mra||f.flg||f.ruby||f.textEmphasis||f.rubyReserve)&&"p"===d.kind){E(f,g,l,null);if(f.rubyReserve){for(k=0;k<l.length;k++){e=document.createElement("ruby");c=document.createElement("rb");c.textContent="\u200b";e.appendChild(c);var r=f.rubyReserve[1].toUsedLength(f.w,f.h)+"px";"both"===f.rubyReserve[0]||"outside"===
f.rubyReserve[0]&&1==l.length?(c=document.createElement("rtc"),c.style[A]=L?"after":"under",c.textContent="\u200b",c.style.fontSize=r,p=document.createElement("rtc"),p.style[A]=L?"before":"over",p.textContent="\u200b",p.style.fontSize=r,e.appendChild(c),e.appendChild(p)):(c=document.createElement("rtc"),c.textContent="\u200b",c.style.fontSize=r,c.style[A]="after"===f.rubyReserve[0]||"outside"===f.rubyReserve[0]&&0<k?L?"after":"tb"===f.bpd||"rl"===f.bpd?"under":"over":L?"before":"tb"===f.bpd||"rl"===
f.bpd?"over":"under",e.appendChild(c));c=null;for(p=0;p<l[k].rbc.length;p++)if("ruby"===l[k].rbc[p].localName){c=l[k].rbc[p];for(p=0;p<c.style.length;p++)e.style.setProperty(c.style.item(p),c.style.getPropertyValue(c.style.item(p)));break}c=c||l[k].elements[0].node;c.parentElement.insertBefore(e,c)}f.rubyReserve=null}if(f.ruby||f.rubyReserve){for(k=0;k<l.length;k++)for(e=0;e<l[k].rbc.length;e++)l[k].rbc[e].style[A]||(l[k].rbc[e].style[A]=L?0===k?"before":"after":"tb"===f.bpd?0===k?"over":"under":
"rl"===f.bpd?0===k?"over":"under":0===k?"under":"over");f.ruby=null}if(f.textEmphasis){for(k=0;k<l.length;k++)for(e=0;e<l[k].te.length;e++)l[k].te[e].style[I]&&"none"!==l[k].te[e].style[I]||(l[k].te[e].style[I]="tb"===f.bpd?0===k?"left over":"left under":"rl"===f.bpd?0===k?"right under":"left under":0===k?"left under":"right under");f.textEmphasis=null}if(f.mra){for(k=0;k<l.length-1;k++)c=l[k].elements.length,0!==c&&!1===l[k].br&&(e=document.createElement("br"),c=l[k].elements[c-1].node,c.parentElement.insertBefore(e,
c.nextSibling));f.mra=null}if(f.lp){k=f.lp.multiply(f.lp.toUsedLength(f.w,f.h),f.options.sizeAdjust);for(e=0;e<l.length;e++){c=l[e].elements[l[e].start_elem];p=l[e].elements[l[e].end_elem];r=Math.ceil(k)+"px";var w="-"+Math.ceil(k)+"px";0!==l[e].elements.length&&("lr"===f.ipd?c.node.style.paddingLeft=r:"rl"===f.ipd?(c.node.style.borderRightColor=c.bgcolor||"#00000000",c.node.style.borderRightStyle="solid",c.node.style.borderRightWidth=r,c.node.style.marginRight=w):"tb"===f.ipd&&(c.node.style.borderTopColor=
c.bgcolor||"#00000000",c.node.style.borderTopStyle="solid",c.node.style.borderTopWidth=r,c.node.style.marginTop=w),"lr"===f.ipd?p.node.style.paddingRight=r:"rl"===f.ipd?(p.node.style.borderLeftColor=p.bgcolor||"#00000000",p.node.style.borderLeftStyle="solid",p.node.style.borderLeftWidth=r,p.node.style.marginLeft=w):"tb"===f.ipd&&(p.node.style.borderBottomColor=p.bgcolor||"#00000000",p.node.style.borderBottomStyle="solid",p.node.style.borderBottomWidth=r,p.node.style.marginBottom=w))}"tb"===f.bpd?
(f.removePaddingElement.style.paddingLeft=0,f.removePaddingElement.style.paddingRight=0):(f.removePaddingElement.style.paddingTop=0,f.removePaddingElement.style.paddingBottom=0);f.lp=null}if(f.flg){e=m(g.getBoundingClientRect(),f);k=e.before;e=e.after;c=g;p=Math.sign(e-k);for(r=0;r<=l.length;r++){w=0;var q=0===r?k:r===l.length?e:Math.abs(l[r].end-l[r].start)>Math.abs(l[r-1].end-l[r-1].start)?l[r].before:l[r-1].after+w;var x;if(0<r){for(x=0;x<l[r-1].elements.length;x++)if(null!==l[r-1].elements[x].bgcolor){var t=
l[r-1].elements[x];0>p*(t.after-q)&&(t=Math.abs(q-t.after),t>w&&(w=t))}var y=c.getElementsByTagName("span")[r];if(l[r]&&y.childElementCount!=l[r].elements.length)for(x=0;x<l[r-1].elements.length;x++)y=l[r-1].elements[x],t=w+"px solid "+y.bgcolor,"lr"===f.bpd?y.node.style.borderRight=t:"rl"===f.bpd?y.node.style.borderLeft=t:"tb"===f.bpd&&(y.node.style.borderBottom=t);else""==y.style.borderBottom&&("lr"===f.bpd?y.style.paddingRight=w+"px":"rl"===f.bpd?y.style.paddingLeft=w+"px":"tb"===f.bpd&&(y.style.paddingBottom=
w+"px"))}if(r<l.length){for(x=w=0;x<l[r].elements.length;x++)t=l[r].elements[x],null!==t.bgcolor&&0<p*(t.before-q)&&(t=Math.abs(t.before-q),t>w&&(w=t));y=c.getElementsByTagName("span")[r];if(y.childElementCount==l[r].elements.length)"lr"===f.bpd?y.style.paddingLeft=w+"px":"rl"===f.bpd?y.style.paddingRight=w+"px":"tb"===f.bpd&&(y.style.paddingTop=w+"px");else for(x=0;x<l[r].elements.length;x++)y=l[r].elements[x],t=w+"px solid "+y.bgcolor,"lr"===f.bpd?y.node.style.borderLeft=t:"rl"===f.bpd?y.node.style.borderRight=
t:"tb"===f.bpd&&(y.node.style.borderTop=t)}}f.flg=null}for(k=0;k<l.length;k++)for(e=l[k],c=1;c<e.elements.length;){p=e.elements[c-1].node;r=e.elements[c].node;if("SPAN"===p.tagName&&"SPAN"===r.tagName&&p._isd_element===r._isd_element){p.textContent+=r.textContent;for(w=0;w<r.style.length;w++)if(q=r.style[w],0<=q.indexOf("border")||0<=q.indexOf("padding"))p.style[q]=r.style[q];r.parentElement.removeChild(r);p=!0}else p=!1;p?e.elements.splice(c,1):c++}}"region"===d.kind&&"tb"===f.bpd&&f.enableRollUp&&
0<d.contents.length&&"after"===d.styleAttrs[h.byName.displayAlign.qname]&&(E(f,g,l,null),d=new a(""===d.id?"_":d.id,l),f.currentISDState[d.id]=d,f.previousISDState&&d.id in f.previousISDState&&0<f.previousISDState[d.id].plist.length&&1<d.plist.length&&d.plist[d.plist.length-2].text===f.previousISDState[d.id].plist[f.previousISDState[d.id].plist.length-1].text&&(f=b.firstElementChild,d=d.plist[d.plist.length-1].after-d.plist[d.plist.length-1].before,f.style.bottom="-"+d+"px",f.style.transition="transform 0.4s",
f.style.position="relative",f.style.transform="translateY(-"+d+"px)"))}else if(f=f.errorHandler,d="Error processing ISD element kind: "+d.kind,f&&f.error&&f.error(d))throw d;}function a(a,b){this.id=a;this.plist=b}function m(a,b){var d={before:null,after:null,start:null,end:null};"tb"===b.bpd?(d.before=a.top,d.after=a.bottom,"lr"===b.ipd?(d.start=a.left,d.end=a.right):(d.start=a.right,d.end=a.left)):"lr"===b.bpd?(d.before=a.left,d.after=a.right,d.start=a.top,d.end=a.bottom):"rl"===b.bpd&&(d.before=
a.right,d.after=a.left,d.start=a.top,d.end=a.bottom);return d}function E(a,b,d,e){if("rt"!==b.localName&&"rtc"!==b.localName)if(e=b.style.backgroundColor||e,0===b.childElementCount)if("span"===b.localName||"rb"===b.localName){var f=b.getBoundingClientRect();a=m(f,a);if(!(f=0===d.length)){f=a.before;var k=a.after,c=d[d.length-1].before,h=d[d.length-1].after;f=!(k<h&&f>c||h<=k&&c>=f)}f?d.push({before:a.before,after:a.after,start:a.start,end:a.end,start_elem:0,end_elem:0,elements:[],rbc:[],te:[],text:"",
br:!1}):(f=Math.sign(a.after-a.before),k=Math.sign(a.end-a.start),0>f*(a.before-d[d.length-1].before)&&(d[d.length-1].before=a.before),0<f*(a.after-d[d.length-1].after)&&(d[d.length-1].after=a.after),0>k*(a.start-d[d.length-1].start)&&(d[d.length-1].start=a.start,d[d.length-1].start_elem=d[d.length-1].elements.length),0<k*(a.end-d[d.length-1].end)&&(d[d.length-1].end=a.end,d[d.length-1].end_elem=d[d.length-1].elements.length));d[d.length-1].text+=b.textContent;d[d.length-1].elements.push({node:b,
bgcolor:e,before:a.before,after:a.after})}else"br"===b.localName&&0!==d.length&&(d[d.length-1].br=!0);else for(b=b.firstChild;b;)b.nodeType===Node.ELEMENT_NODE&&(E(a,b,d,e),"ruby"===b.localName||"rtc"===b.localName?0<d.length&&d[d.length-1].rbc.push(b):"span"===b.localName&&b.style[x]&&"none"!==b.style[x]&&0<d.length&&d[d.length-1].te.push(b)),b=b.nextSibling}function n(a,b,d,e){"none"!==e.style&&(b.style[x]="auto"===e.style?"filled":e.style+" "+e.symbol,"before"===e.position||"after"===e.position)&&
(b.style[I]="tb"===a.bpd?"before"===e.position?"left over":"left under":"rl"===a.bpd?"before"===e.position?"right under":"left under":"before"===e.position?"left under":"right under")}function p(a,b){this.qname=a;this.map=b}b.render=function(a,b,d,e,c,m,h,n,p,g){e=e||b.clientHeight;var f=c||b.clientWidth;null!==a.aspectRatio&&(c=e*a.aspectRatio,c>f?e=Math.round(f/a.aspectRatio):f=c);c=document.createElement("div");c.style.position="relative";c.style.width=f+"px";c.style.height=e+"px";c.style.margin=
"auto";c.style.top=0;c.style.bottom=0;c.style.left=0;c.style.right=0;c.style.zIndex=0;d={h:e,w:f,regionH:null,regionW:null,imgResolver:d,displayForcedOnlyMode:m||!1,isd:a,errorHandler:h,previousISDState:n,enableRollUp:p||!1,currentISDState:{},flg:null,lp:null,mra:null,ipd:null,bpd:null,ruby:null,textEmphasis:null,rubyReserve:null,options:Object.assign({},g)||{}};d.options.colorAdjust&&(d.options.colorAdjust=l(d.options.colorAdjust));m=["region","body","div","p","span"];for(var k in m)m.hasOwnProperty(k)&&
(h=m[k]+"BackgroundColorAdjust",d.options[h]&&(d.options[h]=l(d.options[h])));b.appendChild(c);for(var E in a.contents)a.contents.hasOwnProperty(E)&&u(d,c,a.contents[E],a);return d.currentISDState};var B=[new p("http://www.w3.org/ns/ttml#styling backgroundColor",function(a,b,d,e){(d=(d=a.options[d.kind+"BackgroundColorAdjust"])&&d[e.toString()])&&(e=d);d=e[3];0!==d&&(void 0!=a.options.backgroundOpacityScale&&(d*=a.options.backgroundOpacityScale),b.style.backgroundColor="rgba("+e[0].toString()+","+
e[1].toString()+","+e[2].toString()+","+(d/255).toString()+")")}),new p("http://www.w3.org/ns/ttml#styling color",function(a,b,d,e){d=a.options.colorOpacityScale||1;a=a.options.colorAdjust;void 0!=a&&(a=a[e.toString()])&&(e=a);b.style.color="rgba("+e[0].toString()+","+e[1].toString()+","+e[2].toString()+","+(d*e[3]/255).toString()+")"}),new p("http://www.w3.org/ns/ttml#styling direction",function(a,b,d,e){b.style.direction=e}),new p("http://www.w3.org/ns/ttml#styling display",function(a,b,d,e){}),
new p("http://www.w3.org/ns/ttml#styling displayAlign",function(a,b,d,e){b.style.display="flex";b.style.flexDirection="column";"before"===e?b.style.justifyContent="flex-start":"center"===e?b.style.justifyContent="center":"after"===e&&(b.style.justifyContent="flex-end")}),new p("http://www.w3.org/ns/ttml#styling extent",function(a,b,d,e){a.regionH=e.h.toUsedLength(a.w,a.h);a.regionW=e.w.toUsedLength(a.w,a.h);var f=e=0;if(d=d.styleAttrs["http://www.w3.org/ns/ttml#styling padding"])e=d[0].toUsedLength(a.w,
a.h)+d[2].toUsedLength(a.w,a.h),f=d[1].toUsedLength(a.w,a.h)+d[3].toUsedLength(a.w,a.h);b.style.height=a.regionH-e+"px";b.style.width=a.regionW-f+"px"}),new p("http://www.w3.org/ns/ttml#styling fontFamily",function(a,b,d,e){d=[];a.options.fontFamily&&(e=a.options.fontFamily.split(","));for(var f in e)e[f].hasOwnProperty(f)&&(e[f]=e[f].trim(),"monospaceSerif"===e[f]?(d.push("Courier New"),d.push('"Liberation Mono"'),d.push("Courier"),d.push("monospace")):"proportionalSansSerif"===e[f]||"default"===
e[f]?(d.push("Arial"),d.push("Helvetica"),d.push('"Liberation Sans"'),d.push("sans-serif")):"monospace"===e[f]?d.push("monospace"):"sansSerif"===e[f]?d.push("sans-serif"):"serif"===e[f]?d.push("serif"):"monospaceSansSerif"===e[f]?(d.push("Consolas"),d.push("monospace")):"proportionalSerif"===e[f]?d.push("serif"):d.push(e[f]));if(0<d.length){a=[d[0]];for(e=1;e<d.length;e++)-1==a.indexOf(d[e])&&a.push(d[e]);d=a}b.style.fontFamily=d.join(",")}),new p("http://www.w3.org/ns/ttml#styling shear",function(a,
b,d,e){0!==e&&(d=-.9*e,b.style.transform="tb"===a.bpd?"skewX("+d+"deg)":"skewY("+d+"deg)")}),new p("http://www.w3.org/ns/ttml#styling fontSize",function(a,b,d,e){b.style.fontSize=e.multiply(e.toUsedLength(a.w,a.h),a.options.sizeAdjust)+"px"}),new p("http://www.w3.org/ns/ttml#styling fontStyle",function(a,b,d,e){b.style.fontStyle=e}),new p("http://www.w3.org/ns/ttml#styling fontWeight",function(a,b,d,e){b.style.fontWeight=e}),new p("http://www.w3.org/ns/ttml#styling lineHeight",function(a,b,d,e){b.style.lineHeight=
"normal"===e?"normal":e.multiply(e.multiply(e.toUsedLength(a.w,a.h),a.options.sizeAdjust),a.options.lineHeightAdjust)+"px"}),new p("http://www.w3.org/ns/ttml#styling opacity",function(a,b,d,e){d=e;void 0!=a.options.regionOpacityScale&&(d*=a.options.regionOpacityScale);b.style.opacity=d}),new p("http://www.w3.org/ns/ttml#styling origin",function(a,b,d,e){b.style.top=e.h.toUsedLength(a.w,a.h)+"px";b.style.left=e.w.toUsedLength(a.w,a.h)+"px"}),new p("http://www.w3.org/ns/ttml#styling overflow",function(a,
b,d,e){b.style.overflow=e}),new p("http://www.w3.org/ns/ttml#styling padding",function(a,b,d,e){d=[];d[0]=e[0].toUsedLength(a.w,a.h)+"px";d[1]=e[3].toUsedLength(a.w,a.h)+"px";d[2]=e[2].toUsedLength(a.w,a.h)+"px";d[3]=e[1].toUsedLength(a.w,a.h)+"px";b.style.padding=d.join(" ")}),new p("http://www.w3.org/ns/ttml#styling position",function(a,b,d,e){b.style.top=e.h.toUsedLength(a.w,a.h)+"px";b.style.left=e.w.toUsedLength(a.w,a.h)+"px"}),new p("http://www.w3.org/ns/ttml#styling rubyAlign",function(a,b,
d,e){b.style.rubyAlign="spaceAround"===e?"space-around":"center"}),new p("http://www.w3.org/ns/ttml#styling rubyPosition",function(a,b,d,e){if("before"===e||"after"===e)b.parentElement.style[A]=L?e:"tb"===a.bpd?"before"===e?"over":"under":"rl"===a.bpd?"before"===e?"over":"under":"before"===e?"under":"over"}),new p("http://www.w3.org/ns/ttml#styling showBackground",null),new p("http://www.w3.org/ns/ttml#styling textAlign",function(a,b,d,e){b.style.textAlign="start"===e?"rl"===a.ipd?"right":"left":
"end"===e?"rl"===a.ipd?"left":"right":e}),new p("http://www.w3.org/ns/ttml#styling textDecoration",function(a,b,d,e){b.style.textDecoration=e.join(" ").replace("lineThrough","line-through")}),new p("http://www.w3.org/ns/ttml#styling textOutline",function(a,b,d,e){}),new p("http://www.w3.org/ns/ttml#styling textShadow",function(a,b,d,e){d=d.styleAttrs[h.byName.textOutline.qname];var f=a.options.textOutline;if(f)if("none"===f)d=f;else{var c={};f=f.split(" ");if(0!==f.length&&2>=f.length){var m=g.parseColor(f[0]);
c.color=m;null!==m&&f.shift();1===f.length&&(f=g.parseLength(f[0]))&&(c.thickness=f,d=c)}}if("none"===e&&"none"===d)b.style.textShadow="";else{c=[];"none"!==d&&(d="rgba("+d.color[0].toString()+","+d.color[1].toString()+","+d.color[2].toString()+","+(d.color[3]/255).toString()+")",c.push("1px 1px 1px "+d),c.push("-1px 1px 1px "+d),c.push("1px -1px 1px "+d),c.push("-1px -1px 1px "+d));if("none"!==e)for(var k in e)e.hasOwnProperty(k)&&c.push(e[k].x_off.toUsedLength(a.w,a.h)+"px "+e[k].y_off.toUsedLength(a.w,
a.h)+"px "+e[k].b_radius.toUsedLength(a.w,a.h)+"px rgba("+e[k].color[0].toString()+","+e[k].color[1].toString()+","+e[k].color[2].toString()+","+(e[k].color[3]/255).toString()+")");b.style.textShadow=c.join(",")}}),new p("http://www.w3.org/ns/ttml#styling textCombine",function(a,b,d,e){b.style.textCombineUpright=e}),new p("http://www.w3.org/ns/ttml#styling textEmphasis",function(a,b,d,e){}),new p("http://www.w3.org/ns/ttml#styling unicodeBidi",function(a,b,d,e){b.style.unicodeBidi="bidiOverride"===
e?"bidi-override":e}),new p("http://www.w3.org/ns/ttml#styling visibility",function(a,b,d,e){b.style.visibility=e}),new p("http://www.w3.org/ns/ttml#styling wrapOption",function(a,b,d,e){b.style.whiteSpace="wrap"===e?"preserve"===d.space?"pre-wrap":"normal":"preserve"===d.space?"pre":"noWrap"}),new p("http://www.w3.org/ns/ttml#styling writingMode",function(a,b,d,e){if("lrtb"===e||"lr"===e)b.style.writingMode="horizontal-tb";else if("rltb"===e||"rl"===e)b.style.writingMode="horizontal-tb";else if("tblr"===
e)b.style.writingMode="vertical-lr";else if("tbrl"===e||"tb"===e)b.style.writingMode="vertical-rl"}),new p("http://www.w3.org/ns/ttml#styling zIndex",function(a,b,d,e){b.style.zIndex=e}),new p("http://www.w3.org/ns/ttml/profile/imsc1#styling forcedDisplay",function(a,b,d,e){a.displayForcedOnlyMode&&!1===e&&(b.style.visibility="hidden")})],q;for(q in B)B.hasOwnProperty(q);var L="webkitRubyPosition"in window.getComputedStyle(document.documentElement),A=L?"webkitRubyPosition":"rubyPosition",x="webkitTextEmphasisStyle"in
window.getComputedStyle(document.documentElement)?"webkitTextEmphasisStyle":"textEmphasisStyle",I="webkitTextEmphasisPosition"in window.getComputedStyle(document.documentElement)?"webkitTextEmphasisPosition":"textEmphasisPosition"})("undefined"===typeof g?this.imscHTML={}:g,"undefined"===typeof imscNames?c("./names"):imscNames,"undefined"===typeof imscStyles?c("./styles"):imscStyles,"undefined"===typeof imscUtils?c("./utils"):imscUtils)},{"./names":5,"./styles":6,"./utils":7}],3:[function(c,q,g){(function(b,
c,h,g){function l(b,c,E,q,x,I,f,k,d){if(c<f.begin||c>=f.end)return null;I="regionID"in f&&""!==f.regionID?f.regionID:I;if(null!==x&&I!==E.id&&(!("contents"in f)||"contents"in f&&0===f.contents.length||""!==I))return null;var e=new n(f);for(B in f.sets)!f.sets.hasOwnProperty(B)||c<f.sets[B].begin||c>=f.sets[B].end||(e.styleAttrs[f.sets[B].qname]=f.sets[B].value);var B={};for(var t in e.styleAttrs)if(e.styleAttrs.hasOwnProperty(t)&&(B[t]=!0,"region"===e.kind&&t===h.byName.writingMode.qname&&!(h.byName.direction.qname in
e.styleAttrs))){var A=e.styleAttrs[t];if("lrtb"===A||"lr"===A)e.styleAttrs[h.byName.direction.qname]="ltr";else if("rltb"===A||"rl"===A)e.styleAttrs[h.byName.direction.qname]="rtl"}if(null!==x)for(var z in h.all)if(h.all.hasOwnProperty(z))if(t=h.all[z],t.qname===h.byName.textDecoration.qname){A=x.styleAttrs[t.qname];var D=e.styleAttrs[t.qname],r=[];void 0===D?r=A:-1===D.indexOf("none")?((-1===D.indexOf("noUnderline")&&-1!==A.indexOf("underline")||-1!==D.indexOf("underline"))&&r.push("underline"),
(-1===D.indexOf("noLineThrough")&&-1!==A.indexOf("lineThrough")||-1!==D.indexOf("lineThrough"))&&r.push("lineThrough"),(-1===D.indexOf("noOverline")&&-1!==A.indexOf("overline")||-1!==D.indexOf("overline"))&&r.push("overline")):r.push("none");e.styleAttrs[t.qname]=r}else t.qname!==h.byName.fontSize.qname||t.qname in e.styleAttrs||"span"!==e.kind||"textContainer"!==e.styleAttrs[h.byName.ruby.qname]?t.qname!==h.byName.fontSize.qname||t.qname in e.styleAttrs||"span"!==e.kind||"text"!==e.styleAttrs[h.byName.ruby.qname]?
t.inherit&&t.qname in x.styleAttrs&&!(t.qname in e.styleAttrs)&&(e.styleAttrs[t.qname]=x.styleAttrs[t.qname]):(A=x.styleAttrs[h.byName.fontSize.qname],e.styleAttrs[t.qname]="textContainer"===x.styleAttrs[h.byName.ruby.qname]?A:new g.ComputedLength(.5*A.rw,.5*A.rh)):(A=x.styleAttrs[h.byName.fontSize.qname],e.styleAttrs[t.qname]=new g.ComputedLength(.5*A.rw,.5*A.rh));for(var w in h.all)if(h.all.hasOwnProperty(w)&&(z=h.all[w],!(z.qname in e.styleAttrs||z.qname===h.byName.position.qname&&h.byName.origin.qname in
e.styleAttrs||z.qname===h.byName.origin.qname&&h.byName.position.qname in e.styleAttrs)&&(t=b.head.styling.initials[z.qname]||z.initial,null!==t&&("region"===e.kind||!1===z.inherit&&null!==t))))if(t=z.parse(t),null!==t)e.styleAttrs[z.qname]=t,B[z.qname]=!0;else if(z="Invalid initial value for '"+z.qname+"' on element '"+e.kind,k&&k.error&&k.error(z))throw z;for(var L in h.all)if(h.all.hasOwnProperty(L)&&(w=h.all[L],w.qname in B&&null!==w.compute))if(z=w.compute(b,x,e,e.styleAttrs[w.qname],d),null!==
z)e.styleAttrs[w.qname]=z;else if(e.styleAttrs[w.qname]=w.compute(b,x,e,w.parse(w.initial),d),w="Style '"+w.qname+"' on element '"+e.kind+"' cannot be computed",k&&k.error&&k.error(w))throw w;if("none"===e.styleAttrs[h.byName.display.qname])return null;if(null===x)var G=null===q?[]:[q];else"contents"in f&&(G=f.contents);for(var J in G)G.hasOwnProperty(J)&&(x=l(b,c,E,q,e,I,G[J],k,d),null!==x&&e.contents.push(x.element));for(var y in e.styleAttrs)e.styleAttrs.hasOwnProperty(y)&&(b=!1,"span"===e.kind&&
(c=e.styleAttrs[h.byName.ruby.qname],(b=("container"===c||"textContainer"===c||"baseContainer"===c)&&-1!==p.indexOf(y))||(b="container"!==c&&y===h.byName.rubyAlign.qname),b||(b=!("textContainer"===c||"text"===c)&&y===h.byName.rubyPosition.qname)),b||(b=-1===h.byQName[y].applies.indexOf(e.kind)),b&&delete e.styleAttrs[y]);y=e.styleAttrs[h.byName.ruby.qname];if("p"===e.kind||"span"===e.kind&&("textContainer"===y||"text"===y))y=[],a(e,y),u(y),m(e);return"div"===e.kind&&h.byName.backgroundImage.qname in
e.styleAttrs||"br"===e.kind||"image"===e.kind||"contents"in e&&0<e.contents.length||"span"===e.kind&&null!==e.text||"region"===e.kind&&"always"===e.styleAttrs[h.byName.showBackground.qname]?{region_id:I,element:e}:null}function u(a){function b(a){return"br"===a.kind||/[\r\n\t ]$/.test(a.text)}function c(a){return"br"===a.kind||"preserve"===a.space&&/^[\r\n]/.test(a.text)}for(var m,h=0;h<a.length;)if(m=a[h],"br"===m.kind||"preserve"===m.space)h++;else{var n=m.text.replace(/[\t\r\n ]+/g," ");/^[ ]/.test(n)&&
(0===h||b(a[h-1]))&&(n=n.substring(1));m.text=n;0===n.length?a.splice(h,1):h++}for(h=0;h<a.length;h++)m=a[h],"br"===m.kind||"preserve"===m.space?h++:/[ ]$/.test(m.text)&&(h===a.length-1||c(a[h+1]))&&(m.text=m.text.slice(0,-1))}function a(b,c){for(var m in b.contents)if(b.contents.hasOwnProperty(m)){var n=b.contents[m],l=n.styleAttrs[h.byName.ruby.qname];if("span"!==n.kind||"textContainer"!==l&&"text"!==l)"contents"in n?a(n,c):("span"===n.kind&&0!==n.text.length||"br"===n.kind)&&c.push(n)}}function m(a){if("br"===
a.kind)return!1;if("text"in a)return 0===a.text.length;if("contents"in a){for(var b=a.contents.length;b--;)m(a.contents[b])&&a.contents.splice(b,1);return 0===a.contents.length}}function E(a){this.contents=[];this.aspectRatio=a.aspectRatio;this.lang=a.lang}function n(a){this.kind=a.kind||"region";this.lang=a.lang;a.id&&(this.id=a.id);this.styleAttrs={};for(var b in a.styleAttrs)a.styleAttrs.hasOwnProperty(b)&&(this.styleAttrs[b]=a.styleAttrs[b]);"src"in a&&(this.src=a.src);"type"in a&&(this.type=
a.type);if("text"in a)this.text=a.text;else if("region"===this.kind||"contents"in a)this.contents=[];"space"in a&&(this.space=a.space)}b.generateISD=function(a,b,c){function m(a,b){function d(b){return!(a<b.begin||a>=b.end)}if(b.contents){var e={},c;for(c in b)b.hasOwnProperty(c)&&(e[c]=b[c]);e.contents=[];b.contents.filter(d).forEach(function(b){b=m(a,b);b.regionID&&k.add(b.regionID);null!==b&&e.contents.push(b)});return e}return b}var h=new E(a),n={},f={},k=new Set;f=m(b,a.body);0===k.size&&a.head.layout.regions.hasOwnProperty("")&&
k.add("");k.forEach(function(d){d=l(a,b,a.head.layout.regions[d],f,null,"",a.head.layout.regions[d],c,n);null!==d&&h.contents.push(d.element)});return h};var p=[h.byName.color.qname,h.byName.textCombine.qname,h.byName.textDecoration.qname,h.byName.textEmphasis.qname,h.byName.textOutline.qname,h.byName.textShadow.qname]})("undefined"===typeof g?this.imscISD={}:g,"undefined"===typeof imscNames?c("./names"):imscNames,"undefined"===typeof imscStyles?c("./styles"):imscStyles,"undefined"===typeof imscUtils?
c("./utils"):imscUtils)},{"./names":5,"./styles":6,"./utils":7}],4:[function(c,q,g){g.generateISD=c("./isd").generateISD;g.fromXML=c("./doc").fromXML;g.renderHTML=c("./html").render},{"./doc":1,"./html":2,"./isd":3}],5:[function(c,q,g){c="undefined"===typeof g?this.imscNames={}:g;c.ns_tt="http://www.w3.org/ns/ttml";c.ns_tts="http://www.w3.org/ns/ttml#styling";c.ns_ttp="http://www.w3.org/ns/ttml#parameter";c.ns_xml="http://www.w3.org/XML/1998/namespace";c.ns_itts="http://www.w3.org/ns/ttml/profile/imsc1#styling";
c.ns_ittp="http://www.w3.org/ns/ttml/profile/imsc1#parameter";c.ns_smpte="http://www.smpte-ra.org/schemas/2052-1/2010/smpte-tt";c.ns_ebutts="urn:ebu:tt:style";c.ttaf_map={"http://www.w3.org/2006/10/ttaf1":c.ns_tt,"http://www.w3.org/2006/10/ttaf1#style":c.ns_tts,"http://www.w3.org/2006/10/ttaf1#parameter":c.ns_ttp}},{}],6:[function(c,q,g){(function(b,c,h){function g(a,b,c,h,g,l,q,u){this.name=b;this.ns=a;this.qname=a+" "+b;this.inherit=g;this.animatable=l;this.initial=c;this.applies=h;this.parse=q;
this.compute=u}b.all=[new g(c.ns_tts,"backgroundColor","transparent",["body","div","p","region","span"],!1,!0,h.parseColor,null),new g(c.ns_tts,"color","white",["span"],!0,!0,h.parseColor,null),new g(c.ns_tts,"direction","ltr",["p","span"],!0,!0,function(a){return a},null),new g(c.ns_tts,"display","auto",["body","div","p","region","span"],!1,!0,function(a){return a},null),new g(c.ns_tts,"displayAlign","before",["region"],!1,!0,function(a){return a},null),new g(c.ns_tts,"extent","auto",["tt","region"],
!1,!0,function(a){if("auto"===a)return a;var b=a.split(" ");if(2!==b.length)return null;a=h.parseLength(b[0]);return(b=h.parseLength(b[1]))&&a?{h:b,w:a}:null},function(a,b,c,g,p){if("auto"===g)b=new h.ComputedLength(0,1);else if(b=h.toComputedLength(g.h.value,g.h.unit,null,a.dimensions.h,null,a.pxLength.h),null===b)return null;if("auto"===g)a=new h.ComputedLength(1,0);else if(a=h.toComputedLength(g.w.value,g.w.unit,null,a.dimensions.w,null,a.pxLength.w),null===a)return null;return{h:b,w:a}}),new g(c.ns_tts,
"fontFamily","default",["span","p"],!0,!0,function(a){a=a.split(",");for(var b=[],c=0;c<a.length;c++)"'"!==a[c].charAt(0)&&'"'!==a[c].charAt(0)?"default"===a[c]?b.push("monospaceSerif"):b.push(a[c]):b.push(a[c]);return b},null),new g(c.ns_tts,"shear","0%",["p"],!0,!0,h.parseLength,function(a,b,c,h){if("%"===h.unit)a=100<Math.abs(h.value)?100*Math.sign(h.value):h.value;else return null;return a}),new g(c.ns_tts,"fontSize","1c",["span","p"],!0,!0,h.parseLength,function(a,c,g,n,p){return h.toComputedLength(n.value,
n.unit,null!==c?c.styleAttrs[b.byName.fontSize.qname]:a.cellLength.h,null!==c?c.styleAttrs[b.byName.fontSize.qname]:a.cellLength.h,a.cellLength.h,a.pxLength.h)}),new g(c.ns_tts,"fontStyle","normal",["span","p"],!0,!0,function(a){return a},null),new g(c.ns_tts,"fontWeight","normal",["span","p"],!0,!0,function(a){return a},null),new g(c.ns_tts,"lineHeight","normal",["p"],!0,!0,function(a){return"normal"===a?a:h.parseLength(a)},function(a,c,g,n,p){if("normal"===n)a=n;else if(a=h.toComputedLength(n.value,
n.unit,g.styleAttrs[b.byName.fontSize.qname],g.styleAttrs[b.byName.fontSize.qname],a.cellLength.h,a.pxLength.h),null===a)return null;return a}),new g(c.ns_tts,"opacity",1,["region"],!1,!0,parseFloat,null),new g(c.ns_tts,"origin","auto",["region"],!1,!0,function(a){if("auto"===a)return a;var b=a.split(" ");if(2!==b.length)return null;a=h.parseLength(b[0]);return(b=h.parseLength(b[1]))&&a?{h:b,w:a}:null},function(a,b,c,g,p){if("auto"===g)b=new h.ComputedLength(0,0);else if(b=h.toComputedLength(g.h.value,
g.h.unit,null,a.dimensions.h,null,a.pxLength.h),null===b)return null;if("auto"===g)a=new h.ComputedLength(0,0);else if(a=h.toComputedLength(g.w.value,g.w.unit,null,a.dimensions.w,null,a.pxLength.w),null===a)return null;return{h:b,w:a}}),new g(c.ns_tts,"overflow","hidden",["region"],!1,!0,function(a){return a},null),new g(c.ns_tts,"padding","0px",["region"],!1,!0,function(a){a=a.split(" ");if(4<a.length)return null;for(var b=[],c=0;c<a.length;c++){var g=h.parseLength(a[c]);if(!g)return null;b.push(g)}return b},
function(a,c,g,n,p){if(1===n.length)c=[n[0],n[0],n[0],n[0]];else if(2===n.length)c=[n[0],n[1],n[0],n[1]];else if(3===n.length)c=[n[0],n[1],n[2],n[1]];else if(4===n.length)c=[n[0],n[1],n[2],n[3]];else return null;n=g.styleAttrs[b.byName.writingMode.qname];if("lrtb"===n||"lr"===n)c=[c[0],c[3],c[2],c[1]];else if("rltb"===n||"rl"===n)c=[c[0],c[1],c[2],c[3]];else if("tblr"===n)c=[c[3],c[0],c[1],c[2]];else if("tbrl"===n||"tb"===n)c=[c[3],c[2],c[1],c[0]];else return null;n=[];for(p=0;p<c.length;p++)if(0===
c[p].value)n[p]=new h.ComputedLength(0,0);else if(n[p]=h.toComputedLength(c[p].value,c[p].unit,g.styleAttrs[b.byName.fontSize.qname],"0"===p||"2"===p?g.styleAttrs[b.byName.extent.qname].h:g.styleAttrs[b.byName.extent.qname].w,"0"===p||"2"===p?a.cellLength.h:a.cellLength.w,"0"===p||"2"===p?a.pxLength.h:a.pxLength.w),null===n[p])return null;return n}),new g(c.ns_tts,"position","top left",["region"],!1,!0,function(a){return h.parsePosition(a)},function(a,c,g,n){c=h.toComputedLength(n.v.offset.value,
n.v.offset.unit,null,new h.ComputedLength(-g.styleAttrs[b.byName.extent.qname].h.rw,a.dimensions.h.rh-g.styleAttrs[b.byName.extent.qname].h.rh),null,a.pxLength.h);if(null===c)return null;"bottom"===n.v.edge&&(c=new h.ComputedLength(-c.rw-g.styleAttrs[b.byName.extent.qname].h.rw,a.dimensions.h.rh-c.rh-g.styleAttrs[b.byName.extent.qname].h.rh));var m=h.toComputedLength(n.h.offset.value,n.h.offset.unit,null,new h.ComputedLength(a.dimensions.w.rw-g.styleAttrs[b.byName.extent.qname].w.rw,-g.styleAttrs[b.byName.extent.qname].w.rh),
null,a.pxLength.w);if(null===c)return null;"right"===n.h.edge&&(m=new h.ComputedLength(a.dimensions.w.rw-m.rw-g.styleAttrs[b.byName.extent.qname].w.rw,-m.rh-g.styleAttrs[b.byName.extent.qname].w.rh));return{h:c,w:m}}),new g(c.ns_tts,"ruby","none",["span"],!1,!0,function(a){return a},null),new g(c.ns_tts,"rubyAlign","center",["span"],!0,!0,function(a){return"center"!==a&&"spaceAround"!==a?null:a},null),new g(c.ns_tts,"rubyPosition","outside",["span"],!0,!0,function(a){return a},null),new g(c.ns_tts,
"rubyReserve","none",["p"],!0,!0,function(a){var b=a.split(" ");a=[null,null];if(0===b.length||2<b.length||"none"!==b[0]&&"both"!==b[0]&&"after"!==b[0]&&"before"!==b[0]&&"outside"!==b[0])return null;a[0]=b[0];if(2===b.length&&"none"!==b[0])if(b=h.parseLength(b[1]))a[1]=b;else return null;return a},function(a,c,g,n,p){if("none"===n[0])return n;a=null===n[1]?new h.ComputedLength(.5*g.styleAttrs[b.byName.fontSize.qname].rw,.5*g.styleAttrs[b.byName.fontSize.qname].rh):h.toComputedLength(n[1].value,n[1].unit,
g.styleAttrs[b.byName.fontSize.qname],g.styleAttrs[b.byName.fontSize.qname],a.cellLength.h,a.pxLength.h);return null===a?null:[n[0],a]}),new g(c.ns_tts,"showBackground","whenActive",["region"],!1,!0,function(a){return a},null),new g(c.ns_tts,"textAlign","start",["p"],!0,!0,function(a){return a},function(a,b,c,g,h){return"left"===g?"start":"right"===g?"end":g}),new g(c.ns_tts,"textCombine","none",["span"],!0,!0,function(a){return"none"===a||"all"===a?a:null},null),new g(c.ns_tts,"textDecoration","none",
["span"],!0,!0,function(a){return a.split(" ")},null),new g(c.ns_tts,"textEmphasis","none",["span"],!0,!0,function(a){a=a.split(" ");for(var b={style:null,symbol:null,color:null,position:null},c=0;c<a.length;c++)if("none"===a[c]||"auto"===a[c])b.style=a[c];else if("filled"===a[c]||"open"===a[c])b.style=a[c];else if("circle"===a[c]||"dot"===a[c]||"sesame"===a[c])b.symbol=a[c];else if("current"===a[c])b.color=a[c];else if("outside"===a[c]||"before"===a[c]||"after"===a[c])b.position=a[c];else if(b.color=
h.parseColor(a[c]),null===b.color)return null;null==b.style&&null==b.symbol?b.style="auto":(b.symbol=b.symbol||"circle",b.style=b.style||"filled");b.position=b.position||"outside";b.color=b.color||"current";return b},null),new g(c.ns_tts,"textOutline","none",["span"],!0,!0,function(a){if("none"===a)return a;var b={};a=a.split(" ");if(0===a.length||2<a.length)return null;var c=h.parseColor(a[0]);b.color=c;null!==c&&a.shift();if(1!==a.length)return null;a=h.parseLength(a[0]);if(!a)return null;b.thickness=
a;return b},function(a,c,g,n,p){if("none"===n)return n;c={};c.color=null===n.color?g.styleAttrs[b.byName.color.qname]:n.color;c.thickness=h.toComputedLength(n.thickness.value,n.thickness.unit,g.styleAttrs[b.byName.fontSize.qname],g.styleAttrs[b.byName.fontSize.qname],a.cellLength.h,a.pxLength.h);return null===c.thickness?null:c}),new g(c.ns_tts,"textShadow","none",["span"],!0,!0,h.parseTextShadow,function(a,c,g,n){if("none"===n)return n;c=[];for(var m in n)if(m.hasOwnProperty(n)){var l={};l.x_off=
h.toComputedLength(n[m][0].value,n[m][0].unit,null,g.styleAttrs[b.byName.fontSize.qname],null,a.pxLength.w);if(null===l.x_off)return null;l.y_off=h.toComputedLength(n[m][1].value,n[m][1].unit,null,g.styleAttrs[b.byName.fontSize.qname],null,a.pxLength.h);if(null===l.y_off)return null;if(null===n[m][2])l.b_radius=0;else if(l.b_radius=h.toComputedLength(n[m][2].value,n[m][2].unit,null,g.styleAttrs[b.byName.fontSize.qname],null,a.pxLength.h),null===l.b_radius)return null;l.color=null===n[m][3]?g.styleAttrs[b.byName.color.qname]:
n[m][3];c.push(l)}return c}),new g(c.ns_tts,"unicodeBidi","normal",["span","p"],!1,!0,function(a){return a},null),new g(c.ns_tts,"visibility","visible",["body","div","p","region","span"],!0,!0,function(a){return a},null),new g(c.ns_tts,"wrapOption","wrap",["span"],!0,!0,function(a){return a},null),new g(c.ns_tts,"writingMode","lrtb",["region"],!1,!0,function(a){return a},null),new g(c.ns_tts,"zIndex","auto",["region"],!1,!0,function(a){"auto"!==a&&(a=parseInt(a),isNaN(a)&&(a=null));return a},null),
new g(c.ns_ebutts,"linePadding","0c",["p"],!0,!1,h.parseLength,function(a,b,c,g,l){return h.toComputedLength(g.value,g.unit,null,null,a.cellLength.w,null)}),new g(c.ns_ebutts,"multiRowAlign","auto",["p"],!0,!1,function(a){return a},null),new g(c.ns_smpte,"backgroundImage",null,["div"],!1,!1,function(a){return a},null),new g(c.ns_itts,"forcedDisplay","false",["body","div","p","region","span"],!0,!0,function(a){return"true"===a?!0:!1},null),new g(c.ns_itts,"fillLineGap","true",["p"],!0,!0,function(a){return"true"===
a?!0:!1},null)];b.byQName={};for(var l in b.all)b.all.hasOwnProperty(l)&&(b.byQName[b.all[l].qname]=b.all[l]);b.byName={};for(var q in b.all)b.all.hasOwnProperty(q)&&(b.byName[b.all[q].name]=b.all[q])})("undefined"===typeof g?this.imscStyles={}:g,"undefined"===typeof imscNames?c("./names"):imscNames,"undefined"===typeof imscUtils?c("./utils"):imscUtils)},{"./names":5,"./utils":7}],7:[function(c,q,g){(function(b){var c=/#([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})?/,g=/rgb\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/,
q=/rgba\(\s*(\d+),\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/,J={transparent:[0,0,0,0],black:[0,0,0,255],silver:[192,192,192,255],gray:[128,128,128,255],white:[255,255,255,255],maroon:[128,0,0,255],red:[255,0,0,255],purple:[128,0,128,255],fuchsia:[255,0,255,255],magenta:[255,0,255,255],green:[0,128,0,255],lime:[0,255,0,255],olive:[128,128,0,255],yellow:[255,255,0,255],navy:[0,0,128,255],blue:[0,0,255,255],teal:[0,128,128,255],aqua:[0,255,255,255],cyan:[0,255,255,255]};b.parseColor=function(a){var b,h=
null,n=J[a.toLowerCase()];void 0!==n?h=n:null!==(b=c.exec(a))?h=[parseInt(b[1],16),parseInt(b[2],16),parseInt(b[3],16),void 0!==b[4]?parseInt(b[4],16):255]:null!==(b=g.exec(a))?h=[parseInt(b[1]),parseInt(b[2]),parseInt(b[3]),255]:null!==(b=q.exec(a))&&(h=[parseInt(b[1]),parseInt(b[2]),parseInt(b[3]),parseInt(b[4])]);return h};var G=/^((?:\+|\-)?\d*(?:\.\d+)?)(px|em|c|%|rh|rw)$/;b.parseLength=function(a){var b,c=null;null!==(b=G.exec(a))&&(c={value:parseFloat(b[1]),unit:b[2]});return c};b.parseTextShadow=
function(a){a=a.split(",");for(var c=[],g=0;g<a.length;g++){var h=a[g].split(" ");if(1===h.length&&"none"===h[0])return"none";if(1<h.length&&5>h.length){var l=[null,null,null,null],q=b.parseLength(h.shift());if(null===q)return null;l[0]=q;q=b.parseLength(h.shift());if(null===q)return null;l[1]=q;if(0!==h.length&&(q=b.parseLength(h[0]),null!==q&&(l[2]=q,h.shift()),0!==h.length)){h=b.parseColor(h[0]);if(null===h)return null;l[3]=h}c.push(l)}}return c};b.parsePosition=function(a){a=a.split(" ");var c=
function(a){return"center"===a||"left"===a||"top"===a||"bottom"===a||"right"===a};if(4<a.length)return null;for(var g in a)if(a.hasOwnProperty(g)&&!c(a[g])){var h=b.parseLength(a[g]);if(null===h)return null;a[g]=h}g={h:{edge:"left",offset:{value:50,unit:"%"}},v:{edge:"top",offset:{value:50,unit:"%"}}};for(h=0;h<a.length;){var l=a[h++];if(c(l)){var q={value:0,unit:"%"};2!==a.length&&h<a.length&&!c(a[h])&&(q=a[h++]);"right"===l?(g.h.edge=l,g.h.offset=q):"bottom"===l?(g.v.edge=l,g.v.offset=q):"left"===
l?g.h.offset=q:"top"===l&&(g.v.offset=q)}else if(1===a.length||2===a.length)1===h?g.h.offset=l:g.v.offset=l;else return null}return g};b.ComputedLength=function(a,b){this.rw=a;this.rh=b};b.ComputedLength.prototype.toUsedLength=function(a,b){return a*this.rw+b*this.rh};b.ComputedLength.prototype.multiply=function(a,b){return b?a*b:a};b.ComputedLength.prototype.isZero=function(){return 0===this.rw&&0===this.rh};b.toComputedLength=function(a,c,g,h,l,q){return"%"===c&&h?new b.ComputedLength(h.rw*a/100,
h.rh*a/100):"em"===c&&g?new b.ComputedLength(g.rw*a,g.rh*a):"c"===c&&l?new b.ComputedLength(a*l.rw,a*l.rh):"px"===c&&q?new b.ComputedLength(a*q.rw,a*q.rh):"rh"===c?new b.ComputedLength(0,a/100):"rw"===c?new b.ComputedLength(a/100,0):null}})("undefined"===typeof g?this.imscUtils={}:g)},{}]},{},[4])(4)});
